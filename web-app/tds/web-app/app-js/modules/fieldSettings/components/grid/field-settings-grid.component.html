<ng-template #filterControl>
    <div class="col-xs-2 col-md-2 col-lg-2">
        <select class="form-control" (change)="onFilter()" name="fieldType" id="type" [(ngModel)]="gridState.filter.fieldType">
            <option *ngFor="let t of availableyFieldType" [ngValue]="t">{{t}}</option>
        </select>
    </div>
    <div class="col-xs-3 col-md-3 col-lg-2">
        <div class="form-group has-feedback" style="margin-bottom:0px;">
            <input type="text" class="form-control searchFilterInput" (keyup.enter)="onFilter()" name="search" id="search" [(ngModel)]="gridState.filter.search"
                placeholder="{{'FIELD_SETTINGS.ENTER_FIELD_NAME_FILTER' | translate}}" value="">
            <span style="cursor:pointer;color:#000;pointer-events:all" (click)="onClearTextFilter()" class="fa fa-times form-control-feedback"
                aria-hidden="true"></span>
        </div>
    </div>
    <div class="col-xs-2 col-md-2 col-lg-1">
        <button type="button" class="btn btn-default" id="btnFilter" (click)="onFilter()"><i class="fa fa-fw fa-search"></i> {{'GLOBAL.FILTER' | translate}}</button>
    </div>
</ng-template>
<kendo-grid #fieldSettingGrid="kendoGrid" [filter]="state.filter" [data]="gridData" [sortable]="sortable" [sort]="state.sort"
    (dataStateChange)="dataStateChange($event)">
    <ng-template kendoGridToolbarTemplate [position]="'top'" *ngIf="isEditing; else defaultToolbar">
        <div class="col-xs-4 col-md-3 col-lg-2">
            <button type="button" class="btn" [ngClass]="{'btn-default':!gridState.dirty, 'btn-success':gridState.valid && gridState.dirty, 'btn-danger':!gridState.valid && gridState.dirty}"
                id="btnSaveAll" [disabled]="!gridState.editable || !gridState.dirty || !gridState.valid" (click)="onSaveAll()"><i class="fa fa-fw fa-floppy-o"></i> {{'GLOBAL.SAVE_ALL' | translate}}</button>
            <button type="button" class="btn btn-default" id="btnCancel" (click)="onCancel()"><i class="fa fa-fw fa-times"></i> {{'GLOBAL.CANCEL' | translate}}</button>
        </div>
        <div *ngIf="isFilterDisabled; else filterControl"></div>
        <div class="col-xs-3 col-md-3 col-lg-5">
            <button type="button" class="btn btn-default float-right" id="btnAddCustom" (click)="onAddCustom()"><i class="fa fa-fw fa-plus-circle"></i> {{'FIELD_SETTINGS.CREATE_CUSTOM' | translate}}</button>
        </div>
    </ng-template>
    <ng-template kendoGridToolbarTemplate [position]="'top'" #defaultToolbar>
        <div class="col-xs-4 col-md-3 col-lg-2">
            <button type="button" class="btn btn-default" id="btnEdit" [disabled]="!gridState.editable" (click)="onEdit()"><i class="fa fa-fw fa-list-ul"></i> {{'GLOBAL.EDIT' | translate}}</button>
        </div>
        <div *ngIf="isFilterDisabled; else filterControl"></div>
    </ng-template>
    <kendo-grid-column title="Action" *ngIf='isEditing' [width]="70">
        <ng-template kendoGridCellTemplate let-dataItem>
            <button class="btn btn-default" *ngIf="dataItem.udf" (click)="onDelete(dataItem)"><span class="fa fa-fw fa-trash"></span></button>
        </ng-template>
    </kendo-grid-column>
    <kendo-grid-column field="field" title="Field">
        <ng-template kendoGridCellTemplate *ngIf="isEditing;" let-dataItem>
            <input type="text" *ngIf="dataItem.udf" disabled class="form-control" [(ngModel)]="dataItem.field" name="field">
            <span *ngIf="!dataItem.udf">{{dataItem.field}}</span>
        </ng-template>
    </kendo-grid-column>
    <kendo-grid-column field="order" title="Order" [width]="100">
        <ng-template kendoGridCellTemplate *ngIf="isEditing; else orderTemp" let-dataItem>
            <input type="number" min="0" *ngIf="dataItem.udf" class="form-control" [ngModel]="dataItem.order" name="order"
                   (input)="validateOrderValue($event.target, dataItem)">
            <div *ngIf="!dataItem.udf" style="width:45px" class="text-center">{{dataItem.order}}</div>
        </ng-template>
        <ng-template kendoGridCellTemplate class="text-center" let-dataItem #orderTemp>
            <div class="text-center" style="width:45px"> {{ dataItem.order }} </div>
        </ng-template>
    </kendo-grid-column>
    <kendo-grid-column field="label" title="Label" [width]="150">
        <ng-template kendoGridCellTemplate *ngIf="isEditing" let-dataItem>
            <input type="text" *ngIf="dataItem.udf" class="form-control" [(ngModel)]="dataItem.label" id="{{dataItem.field}}" name="{{dataItem.field}}">
            <span *ngIf="!dataItem.udf">{{dataItem.label}}</span>
        </ng-template>
    </kendo-grid-column>
    <kendo-grid-column field="shared" title="Shared" [width]="65" [class]="{'text-center':!isEditing}">
        <ng-template kendoGridCellTemplate *ngIf="isEditing; else sharedTemp" let-dataItem>
            <div class="checkbox text-center">
                <label><input type="checkbox" (change)="onShare(dataItem)" [disabled]="!dataItem.udf" [(ngModel)]="dataItem.shared" name="shared"></label>
            </div>
        </ng-template>
        <ng-template kendoGridCellTemplate class="text-center" let-dataItem #sharedTemp>
            {{dataItem.shared | tdsUIBoolean}}
        </ng-template>
    </kendo-grid-column>
    <kendo-grid-column field="imp" title="Importance" [width]="100">
        <ng-template kendoGridHeaderTemplate let-column let-columnIndex="columnIndex">
            Importance
            <popup-legends></popup-legends>
        </ng-template>
        <ng-template kendoGridCellTemplate let-dataItem>
            <field-settings-imp [edit]="isEditing" [(model)]="dataItem.imp"></field-settings-imp>
        </ng-template>
    </kendo-grid-column>
    <kendo-grid-column field="constraints.required" title="Required" [width]="75" [class]="{'text-center':!isEditing}">
        <ng-template kendoGridCellTemplate *ngIf="isEditing; else requiredTemp" let-dataItem>
            <div class="checkbox text-center">
                <label><input type="checkbox" (change)="onRequired(dataItem)" [disabled]="!dataItem.udf" [(ngModel)]="dataItem.constraints.required" name="required"></label>
            </div>
        </ng-template>
        <ng-template class="text-center" kendoGridCellTemplate let-dataItem #requiredTemp>
            {{(dataItem.constraints? dataItem.constraints.required:false) | tdsUIBoolean}}
        </ng-template>
    </kendo-grid-column>
    <kendo-grid-column field="show" title="Display" [width]="65" [class]="{'text-center':!isEditing}">
        <ng-template kendoGridCellTemplate *ngIf="isEditing; else displayTemp" let-dataItem>
            <div class="checkbox text-center">
                <label><input type="checkbox" [disabled]="!dataItem.udf" [(ngModel)]="dataItem.show" name="required"></label>
            </div>
        </ng-template>
        <ng-template class="text-center" kendoGridCellTemplate let-dataItem #displayTemp>
            {{dataItem.show | tdsUIBoolean}}
        </ng-template>
    </kendo-grid-column>
    <kendo-grid-column field="default" title="Default Value">
        <ng-template kendoGridCellTemplate let-dataItem *ngIf="isEditing">
            <input *ngIf="(dataItem.udf) && (dataItem.control!='Select List' && dataItem.control!='YesNo')" type="text" class="form-control"
                [(ngModel)]="dataItem.default" name="default">
            <span *ngIf="!dataItem.udf">{{dataItem.default}}</span>
            <select *ngIf="dataItem.control=='Select List' || dataItem.control=='YesNo'" class="form-control" name="default" [(ngModel)]="dataItem.default">
                <option value="">Select...</option>
                <option *ngFor="let c of dataItem.constraints.values" [ngValue]="c">{{c}}</option>
            </select>
        </ng-template>
    </kendo-grid-column>
    <kendo-grid-column field="control" title="Control" [width]="150">
        <ng-template kendoGridCellTemplate *ngIf="isEditing; else controlTemp" let-dataItem>
            <div *ngIf="dataItem.udf">
                <select class="form-control" style="float:left;width:100px" (change)="onControlChange(dataItem,selectList,minMax)" name="control"
                    id="control" [(ngModel)]="dataItem.control">
                    <option value="">Select...</option>
                    <option *ngFor="let c of availableControls" [ngValue]="c.value">{{c.text}}</option>
                </select>
                <selectlist-configuration-popup #selectList="selectlistConfig" [domain]="data.domain" [field]="dataItem"></selectlist-configuration-popup>
                <min-max-configuration-popup #minMax="minmaxConfig" [domain]="data.domain" [field]="dataItem"></min-max-configuration-popup>
            </div>
            <span *ngIf="!dataItem.udf">{{dataItem.control}}</span>
        </ng-template>
        <ng-template kendoGridCellTemplate #controlTemp let-dataItem>
            {{dataItem.control=='Select List'?'List':dataItem.control}}
        </ng-template>
    </kendo-grid-column>
    <kendo-grid-column field="tip" title="Tooltip Help">
        <ng-template kendoGridCellTemplate *ngIf="isEditing" let-dataItem>
            <textarea class="form-control" [(ngModel)]="dataItem.tip" name="tip" rows="2">
            </textarea>
        </ng-template>
    </kendo-grid-column>
</kendo-grid>