(window.webpackJsonp=window.webpackJsonp||[]).push([[1],{382:function(e,t,s){"use strict";s.r(t);var i=s(1),o=s(0),a=s(10),n=s(15),r=s(200),l=s(1109),c=s(1114),d=s(1127),u=s(1132),p=s(1133),h=s(1115),m=s(65),f=s(269),g=s(375),v=s(372),S=s(35),y=function(){function e(e,t){this.assetExplorerService=e,this.router=t}return e.prototype.resolve=function(e){var t=this,s=e.params.id;return s?this.assetExplorerService.getReport(s).map(function(e){return e}).catch(function(e){return console.error("ReportResolveService:","An Error Occurred trying to fetch Single Report "+s),t.router.navigate(["/security/error"]),S.Observable.of(!1)}):S.Observable.of({isFavorite:!1,isOwner:!0,isShared:!1,isSystem:!1,schema:{columns:[],domains:[]}})},e=i.b([Object(o.B)(),i.d("design:paramtypes",[v.a,m.c])],e)}(),b=function(){function e(e,t){this.assetExplorerService=e,this.router=t}return e.prototype.resolve=function(e){var t=this;return this.assetExplorerService.getReports().map(function(e){return e}).catch(function(e){return console.error("ReportsResolveService:","An Error Occurred trying to fetch all Reports"),t.router.navigate(["/security/error"]),S.Observable.of(!1)})},e=i.b([Object(o.B)(),i.d("design:paramtypes",[v.a,m.c])],e)}(),T=s(374),E=function(){function e(e,t){this.customDomainService=e,this.router=t}return e.prototype.resolve=function(e){var t=this;return this.customDomainService.getCommonFieldSpecs().map(function(e){var t=e.findIndex(function(e){return"COMMON"===e.domain.toUpperCase()});-1!==t&&(e=e.splice(t,1).concat(e));return e.forEach(function(e){e.fields=e.fields.sort(function(e,t){return e.label>t.label?1:t.label>e.label?-1:0}),e.fields.forEach(function(t){t.domain=e.domain.toLowerCase()})}),e}).catch(function(e){return console.error("FieldsResolveService:","An Error Occurred trying to fetch Field List"),t.router.navigate(["/security/error"]),S.Observable.of(!1)})},e=i.b([Object(o.B)(),i.d("design:paramtypes",[T.a,m.c])],e)}(),A=s(914),C=s(270),k=s(201),w=s(77),I=s(67),D=s(84),O=s(55),L=s(75),R=s(381),x=s(28),P=s(54),F=s(189),N=[];function M(e){N.push(e)}var _,j=function(){return N=[],M({property:"isFavorite",label:"ASSET_EXPLORER.INDEX.FAVORITE",sort:{isSorting:!1,isAscending:!1},type:"boolean",width:100}),M({property:"name",label:"ASSET_EXPLORER.INDEX.NAME",sort:{isSorting:!1,isAscending:!1},type:"string",width:100}),M({property:"createdBy",label:"ASSET_EXPLORER.INDEX.CREATED_BY",sort:{isSorting:!1,isAscending:!1},type:"string",width:100}),M({property:"createdOn",label:"ASSET_EXPLORER.INDEX.CREATED_ON",sort:{isSorting:!1,isAscending:!0},type:"date",format:null,width:100}),M({property:"updatedOn",label:"ASSET_EXPLORER.INDEX.UPDATED_ON",sort:{isSorting:!1,isAscending:!0},type:"date",format:null,width:100}),M({property:"isShared",label:"ASSET_EXPLORER.INDEX.SHARED",sort:{isSorting:!1,isAscending:!1},type:"boolean",width:100}),M({property:"isSystem",label:"ASSET_EXPLORER.INDEX.SYSTEM",sort:{isSorting:!1,isAscending:!1},type:"boolean",width:100}),N},V=function(e){e||(e="createdOn");var t={sort:{isSorting:!1,isAscending:!1}};return N=N.map(function(s){var i=s.property===e?{sort:{isSorting:!0,isAscending:!s.sort.isAscending}}:t;return Object.assign({},s,i)})},U=function(e){return N=N.map(function(t){return"date"===t.type?i.a({},t,{format:e}):t})},B=function(){return N.find(function(e){return e.sort.isSorting})||function(e){return N.find(function(t){return t.property===e})}("createdOn")},G=function(){function e(e,t,s,i,o,a,n,r){this.route=e,this.router=t,this.permissionService=s,this.assetExpService=i,this.prompt=o,this.notifier=a,this.dictionary=n,this.preferenceService=r,this.reportGroupModels=Array(),this.viewType=k.c,this.report=this.route.snapshot.data.reports}return e.prototype.ngOnInit=function(){var e=this;this.gridColumns=j();var t=P.b.CURRENT_DATE_FORMAT+","+P.b.VIEW_MANAGER_DEFAULT_SORT;this.preferenceService.getPreferences(t).subscribe(function(t){e.setupDefaultSettings(t)})},e.prototype.setupDefaultSettings=function(e){var t=e[P.b.CURRENT_DATE_FORMAT];this.gridColumns=U(t),this.reportGroupModels=this.report;var s=this.dictionary.get(x.q);this.selectFolder(s||this.reportGroupModels.find(function(e){return e.open})),this.gridColumns=V(e[P.b.VIEW_MANAGER_DEFAULT_SORT]),this.selectedFolder.items=F.a.sort(this.selectedFolder.items,B())},e.prototype.selectFolder=function(e){this.dictionary.set(x.q,e),this.reportGroupModels.forEach(function(e){return e.open=!1}),this.selectedFolder=this.reportGroupModels.filter(function(t){return t.name===e.name})[0],this.selectedFolder&&(this.selectedFolder.open=!0),this.selectedFolder.items=F.a.sort(this.selectedFolder.items,B())},e.prototype.onClearTextFilter=function(){this.searchText=""},e.prototype.onCreateReport=function(){this.isCreateAvailable()&&this.router.navigate(["asset","views","create"])},e.prototype.onEditReport=function(e){this.isEditAvailable(e)&&this.router.navigate(["asset","views",e.id,"edit"])},e.prototype.onShowReport=function(e){this.router.navigate(["asset","views",e.id,"show"])},e.prototype.onDeleteReport=function(e){var t=this;this.isDeleteAvailable(e)&&this.prompt.open("Confirmation Required","Are you sure you want to delete this view?","Yes","No").then(function(s){s&&t.assetExpService.deleteReport(e.id).subscribe(function(e){t.notifier.broadcast({name:L.b.SUCCESS,message:e}),t.loadData()},function(e){return console.log(e)})})},e.prototype.loadData=function(){var e=this;this.assetExpService.getReports().subscribe(function(t){e.reportGroupModels=t,e.selectedFolder=e.reportGroupModels.find(function(e){return e.open}),e.selectedFolder.items=F.a.sort(e.selectedFolder.items,B())})},e.prototype.changeSort=function(e){this.gridColumns=V(e),this.preferenceService.setPreference(P.b.VIEW_MANAGER_DEFAULT_SORT,e).subscribe(function(){return console.log("Saving sort preference")},function(e){return console.log(e.message||e)}),this.selectedFolder.items=F.a.sort(this.selectedFolder.items,B())},e.prototype.isCreateAvailable=function(){return this.permissionService.hasPermission(D.a.AssetExplorerCreate)},e.prototype.isEditAvailable=function(e){return e.isSystem?this.permissionService.hasPermission(D.a.AssetExplorerSystemEdit)||this.permissionService.hasPermission(D.a.AssetExplorerSystemSaveAs):this.permissionService.hasPermission(D.a.AssetExplorerEdit)||this.permissionService.hasPermission(D.a.AssetExplorerSaveAs)},e.prototype.isDeleteAvailable=function(e){return e.isSystem?this.permissionService.hasPermission(D.a.AssetExplorerSystemDelete):e.isOwner&&this.permissionService.hasPermission(D.a.AssetExplorerDelete)},e.prototype.toggleFavorite=function(e){var t=this;e.isFavorite?this.assetExpService.deleteFavorite(e.id).subscribe(function(s){e.isFavorite=!1,t.loadData()}):this.assetExpService.hasMaximumFavorites(this.reportGroupModels.filter(function(e){return"Favorites"===e.name})[0].items.length+1)?this.notifier.broadcast({name:L.b.DANGER,message:"Maximum number of favorite data views reached."}):this.assetExpService.saveFavorite(e.id).subscribe(function(s){e.isFavorite=!0,t.loadData()})},e=i.b([Object(o.n)({selector:"asset-explorer-index",templateUrl:"../tds/web-app/app-js/modules/assetExplorer/components/index/asset-explorer-index.component.html"}),i.d("design:paramtypes",[m.a,m.c,w.a,v.a,I.b,O.a,R.a,P.c])],e)}(),H=s(38),Y=s(904),q=s(933),X=function(){function e(e,t,s){var i=this;this.router=e,this.service=t,this.permissionService=s,this.open=!1,this.nameAsUrl=!0,this.showCreate=!0,this.isDisabled=!1,this.onSelectView=new o.w,this.searchFilterSelector="",this.defaultItem={name:"Saved Views",default:!0},this.selectedItem="",t.getReports().subscribe(function(e){i.data=e,i.reports=e.slice()})}return e.prototype.ngAfterViewInit=function(){this.open&&this.dropdown.toggle(!0)},e.prototype.onAction=function(e){e.prevented=!0},e.prototype.onToggle=function(){var e=this;setTimeout(function(){e.dropdown.toggle(!e.dropdown.isOpen),setTimeout(function(){e.dropdown.isOpen&&e.viewSelectorFilter&&e.viewSelectorFilter.nativeElement.focus()},300)})},e.prototype.onSearch=function(){var e=new RegExp(this.searchFilterSelector,"i");this.data=this.reports.map(function(t){var s=i.a({},t);return s.items=s.items.filter(function(t){return e.test(t.name)}),s})},e.prototype.getFolderStyle=function(e){return{"fa-star text-yellow":e.type===k.c.FAVORITES,"fa-folder":e.type!==k.c.FAVORITES}},e.prototype.onFolderClick=function(e){e.open=!e.open},e.prototype.onCreateNew=function(e){this.isCreateAvailable(e)&&this.router.navigate(["asset","views","create"])},e.prototype.isCreateVisible=function(e){return this.showCreate&&e.type!==k.c.ALL&&e.type!==k.c.FAVORITES&&e.type!==k.c.RECENT&&this.isCreateAvailable(e)},e.prototype.isCreateAvailable=function(e){return e.type===k.c.SYSTEM_VIEWS?this.permissionService.hasPermission(D.a.AssetExplorerSystemCreate):this.permissionService.hasPermission(D.a.AssetExplorerCreate)},e.prototype.loadData=function(){var e=this;this.service.getReports().subscribe(function(t){e.data=t})},e.prototype.onFocusOut=function(e){this.dropdown.isOpen&&(this.selectedItem=this.defaultItem.name,this.onToggle())},i.b([Object(o.E)(),i.d("design:type",Object)],e.prototype,"open",void 0),i.b([Object(o.E)(),i.d("design:type",Object)],e.prototype,"nameAsUrl",void 0),i.b([Object(o.E)(),i.d("design:type",Object)],e.prototype,"showCreate",void 0),i.b([Object(o.E)(),i.d("design:type",Object)],e.prototype,"isDisabled",void 0),i.b([Object(o.Q)(),i.d("design:type",Object)],e.prototype,"onSelectView",void 0),i.b([Object(o.lb)("kendoDropDown"),i.d("design:type",q.a)],e.prototype,"dropdown",void 0),i.b([Object(o.lb)("viewSelectorFilter"),i.d("design:type",o.u)],e.prototype,"viewSelectorFilter",void 0),e=i.b([Object(o.n)({selector:"asset-explorer-view-selector",exportAs:"assetExplorerViewSelector",templateUrl:"../tds/web-app/app-js/modules/assetExplorer/components/view-selector/asset-explorer-view-selector.component.html",encapsulation:o.ob.None,styles:["ul.k-list .k-item.k-state-selected, ul.k-list .k-item.k-state-selected:hover {\n            color: #656565;\n            background-color: #ededed;\n        }"]}),i.d("design:paramtypes",[m.c,v.a,w.a])],e)}(),Q=function(){function e(e,t,s,o,a,n){this.favorites=t,this.assetExpService=s,this.activeDialog=o,this.permissionService=a,this.notifier=n,this.isUnique=!0,this.model=i.a({},e),this.model.id&&(this.model.name="Copy of "+this.model.name,this.model.id=null,this.model.isSystem=!1,this.model.isFavorite=!1),this.model.isSystem&&(this.model.isShared=!1)}return e.prototype.cancelCloseDialog=function(){this.activeDialog.dismiss()},e.prototype.confirmCloseDialog=function(){var e=this;this.assetExpService.saveReport(this.model).subscribe(function(t){return t&&e.activeDialog.close(t)},function(t){return e.activeDialog.dismiss(t)})},e.prototype.isValid=function(){return this.model.name&&""!==this.model.name.trim()&&this.isUnique},e.prototype.isSystemCreatePermitted=function(){return this.permissionService.hasPermission(D.a.AssetExplorerSystemCreate)},e.prototype.onIsSystemChange=function(){this.model.isSystem&&this.model.isShared&&(this.model.isShared=!1)},e.prototype.onFavorite=function(){var e=this;if(this.model.isFavorite){if(this.model.isFavorite=!1,this.model.id){var t=this.favorites.items.findIndex(function(t){return t.id===e.model.id});-1!==t&&this.favorites.items.splice(t,1)}}else this.assetExpService.hasMaximumFavorites(this.favorites.items.length+1)?this.notifier.broadcast({name:L.b.DANGER,message:"Maximum number of favorite data views reached."}):this.model.isFavorite=!0},e.prototype.onNameChanged=function(){this.validateUniquenessDataViewByName(this.model.name)},e.prototype.validateUniquenessDataViewByName=function(e){var t=this;void 0===e&&(e=""),e.trim()?this.assetExpService.validateUniquenessDataViewByName(e).subscribe(function(e){return t.isUnique=e},function(e){return console.log(e.message)}):this.isUnique=!1},e=i.b([Object(o.n)({selector:"asset-explorer-view-save",templateUrl:"../tds/web-app/app-js/modules/assetExplorer/components/view-save/asset-explorer-view-save.component.html"}),i.d("design:paramtypes",[k.b,k.a,v.a,H.a,w.a,O.a])],e)}(),W=s(1102),J=function(){return function(){}}(),K=s(24),Z=function(){function e(e,t,s){var o=this;this.assetExportModel=e,this.activeDialog=t,this.assetExpService=s,this.fileName="asset_explorer",this.exportFileName="",this.dataToExport=[],this.allProperties=!1;var a=i.a({},this.assetExportModel.assetQueryParams.filters.columns);this.columns=Object.keys(a).map(function(e){return{name:o.getPropertyColumnField(a[e].domain,"_",a[e].property),title:a[e].label,width:a[e].width,locked:a[e].locked,cell:{background:o.getImportanceColor(a[e])}}}),this.getFileName()}return e.prototype.getImportanceColor=function(e){var t=this.assetExportModel.domains.find(function(t){return t.domain.toLocaleLowerCase()===e.domain.toLocaleLowerCase()}).fields.find(function(t){return t.label.toLocaleLowerCase()===e.label.toLocaleLowerCase()});return Y.d[t.imp].color},e.prototype.getExportData=function(){var e=this;this.assetExportModel.queryId?this.assetExpService.query(this.assetExportModel.queryId,this.assetExportModel.assetQueryParams).subscribe(function(t){e.exportFileName=e.fileName+"-"+K.a.getTimestamp(),e.onExportDataResponse(t.assets)},function(e){return console.log(e)}):this.assetExpService.previewQuery(this.assetExportModel.assetQueryParams).subscribe(function(t){e.exportFileName=e.fileName+"-"+K.a.getTimestamp(),e.onExportDataResponse(t.assets)},function(e){return console.log(e)})},e.prototype.getFileName=function(){var e=this;this.assetExpService.getFileName(this.assetExportModel.viewName).subscribe(function(t){e.fileName=t},function(e){return console.log(e)})},e.prototype.getPropertyColumnField=function(e,t,s){return e.toLocaleLowerCase()+t+s},e.prototype.onExportDataResponse=function(e){var t=this;this.dataToExport=e,setTimeout(function(){t.excelexport.save(),t.activeDialog.close()},500)},e.prototype.cancelCloseDialog=function(){this.activeDialog.dismiss()},i.b([Object(o.lb)("excelexport"),i.d("design:type",W.a)],e.prototype,"excelexport",void 0),e=i.b([Object(o.n)({selector:"asset-explorer-view-export",templateUrl:"../tds/web-app/app-js/modules/assetExplorer/components/view-export/asset-explorer-view-export.component.html",styles:["\n        .has-error, .has-error:focus {\n            border: 1px #f00 solid;\n        }\n\t"]}),i.d("design:paramtypes",[J,H.a,v.a])],e)}(),z=s(379),$=s(36),ee=function(){function e(e,t,s,o,a,n,r,l){this.route=e,this.router=t,this.assetExplorerService=s,this.dialogService=o,this.permissionService=a,this.notifier=n,this.prompt=r,this.dictionary=l,this.gridState={skip:0,take:x.l,sort:[]},this.assetClasses=["APPLICATION","DEVICE","DATABASE","STORAGE"],this.filterModel={assets:{COMMON:!0,APPLICATION:!1,DATABASE:!1,DEVICE:!1,STORAGE:!1},asset:"all",selected:"all",search:""},this.collapsed=!1,this.collapsedColumnsPreview=!1,this.columnIndex=0,this.rowIndex=0,this.domains=[],this.filteredData=[],this.fields=[],this.allFields=[],this.position=[],this.currentTab=0,this.previewButtonClicked=!1,this.metadata={},this.metadata.tagList=this.route.snapshot.data.tagList,this.allFields=this.route.snapshot.data.fields,this.fields=this.route.snapshot.data.fields,this.domains=this.route.snapshot.data.fields,this.model=i.a({},this.route.snapshot.data.report),this.dataSignature=JSON.stringify(this.model),this.draggableColumns=[],this.model.id&&(this.updateFilterbyModel(),this.currentTab=1,this.draggableColumns=this.model.schema.columns.slice())}return e.prototype.ngOnInit=function(){this.justPlanning=!1,this.model.id&&(this.notifier.broadcast({name:"notificationHeaderTitleChange",title:this.model.name}),this.previewButtonClicked=!0,this.onPreview())},e.prototype.updateFilterbyModel=function(){var e=this;this.model.schema.domains.forEach(function(t){return e.filterModel.assets[t.toUpperCase()]=!0}),this.applyFilters();var t=this.model.schema.columns.map(function(e){return e.domain+"."+e.property});this.fields.filter(function(e){return-1!==t.indexOf(e.domain+"."+e.field)}).forEach(function(e){return e.selected=!0})},e.prototype.updateModelbyFilter=function(){var e=this;this.model.schema.domains=this.selectedAssetClasses().map(function(e){return e.toLowerCase()}),this.isAssetSelected()?(this.model.schema.columns=this.model.schema.columns.filter(function(t){return-1!==e.model.schema.domains.indexOf(t.domain)}),this.draggableColumns=this.model.schema.columns.slice()):(this.model.schema.domains=[],this.model.schema.columns=[],this.draggableColumns=this.model.schema.columns.slice(),this.clearSorting()),this.fields.filter(function(t){return t.selected&&-1===e.model.schema.domains.indexOf(t.domain.toLowerCase())}).forEach(function(e){return delete e.selected}),this.applyFilters(),this.data=null,this.previewButtonClicked=!1},e.prototype.applyFilters=function(){var e=this;this.applyAssetSelectFilter(),this.applyAssetClassFilter(),this.applyFieldFilter(),this.applySelectedFilter(),this.fields=this.mapFieldList(),this.columnIndex=0,this.rowIndex=0,this.position=this.fields.map(function(t){return e.fieldStyle(t.isTitle)}),setTimeout(function(){jQuery('[data-toggle="popover"]').popover()},200)},e.prototype.applyAssetSelectFilter=function(){var e=this.selectedAssetClasses();this.filteredData=this.domains.filter(function(t){return-1!==e.indexOf(t.domain.toUpperCase())}).map(function(e){return i.a({},e)})},e.prototype.applyAssetClassFilter=function(){var e=this;"all"!==this.filterModel.asset&&(this.filteredData=this.filteredData.filter(function(t){return t.domain.toUpperCase()===e.filterModel.asset.toUpperCase()}))},e.prototype.applyFieldFilter=function(){if(""!==this.filterModel.search){var e=new RegExp(this.filterModel.search,"i");this.filteredData.forEach(function(t){t.fields=t.fields.filter(function(t){return e.test(t.label)||e.test(t.field)})})}},e.prototype.applySelectedFilter=function(){var e=this;"all"!==this.filterModel.selected&&this.filteredData.forEach(function(t){t.fields=t.fields.filter(function(t){return"true"===e.filterModel.selected?t.selected:!t.selected})})},e.prototype.mapFieldList=function(){return this.filteredData.reduce(function(e,t){if(t.fields.length>0){var s=new Y.e;s.domain=t.domain.toLowerCase(),s.isTitle=!0,e.push(s)}return e.concat(t.fields)},[])},e.prototype.selectedAssetClasses=function(){var e=this;return Object.keys(this.filterModel.assets).filter(function(t){return e.filterModel.assets[t]})},e.prototype.fieldStyle=function(e){!e||0===this.columnIndex&&0===this.rowIndex?this.rowIndex>=15&&(this.columnIndex+=1,this.rowIndex=1):(this.columnIndex+=1,this.rowIndex=0);var t={height:"25px",width:"160px",top:25*this.rowIndex+"px",left:160*this.columnIndex+"px",position:"absolute",margin:"0px","padding-left":"10px","padding-bottom":"5px"};return this.rowIndex+=1,t},e.prototype.openSaveDialog=function(){var e=this,t=this.select.data.filter(function(e){return"Favorites"===e.name})[0];this.dialogService.open(Q,[{provide:k.b,useValue:this.model},{provide:k.a,useValue:t}]).then(function(t){e.model=t,e.dataSignature=JSON.stringify(e.model),setTimeout(function(){e.router.navigate(["asset","views",e.model.id,"edit"])})}).catch(function(e){console.log("error")})},e.prototype.isAssetSelected=function(){return this.model&&this.model.schema&&this.model.schema.domains.filter(function(e){return"common"!==e}).length>0},e.prototype.isColumnSelected=function(){return this.model.schema.columns.length>0},e.prototype.isValid=function(){return this.isAssetSelected()&&this.isColumnSelected()&&this.hasAtLeastOneNonLockedColumnOrEmpty()},e.prototype.isDirty=function(){return this.dataSignature!==JSON.stringify(this.model)},e.prototype.isSaveAvailable=function(){return this.assetExplorerService.isSaveAvailable(this.model)},e.prototype.isSaveAsAvailable=function(){return this.model.id?this.model.isSystem?this.permissionService.hasPermission(D.a.AssetExplorerSystemSaveAs):this.permissionService.hasPermission(D.a.AssetExplorerSaveAs):this.isSaveAvailable()},e.prototype.isSystemSaveAvailable=function(e){return e?this.permissionService.hasPermission(D.a.AssetExplorerSystemEdit):this.permissionService.hasPermission(D.a.AssetExplorerSystemSaveAs)},e.prototype.isCurrentTab=function(e){return this.currentTab===e},e.prototype.setCurrentTab=function(e){this.currentTab=e},e.prototype.getAssetIcon=function(e){var t=this.assetClasses.find(function(t){return t===e});return t||(t="other"),t.toLocaleLowerCase()+"_menu"},e.prototype.onSaveAs=function(){this.isSaveAsAvailable()&&this.openSaveDialog()},e.prototype.onCancel=function(){this.model&&this.model.id?this.router.navigate(["asset","views",this.model.id,"show"]):this.router.navigate(["asset","views"])},e.prototype.onSave=function(){var e=this;this.isSaveAvailable()&&(this.model.id?this.assetExplorerService.saveReport(this.model).subscribe(function(t){e.dataSignature=JSON.stringify(e.model),e.select.loadData()}):this.openSaveDialog())},e.prototype.onExport=function(){var e={assetQueryParams:this.getQueryParams(),domains:this.domains,viewName:this.model.name};this.dialogService.open(Z,[{provide:J,useValue:e}]).then(function(e){console.log(e)}).catch(function(e){console.log("error")})},e.prototype.onFieldSelection=function(e){if(e.selected)this.model.schema.columns.push({domain:e.domain.toLowerCase(),property:e.field,width:z.a,locked:!1,edit:!1,label:e.label,filter:""}),1===this.model.schema.columns.length&&(this.model.schema.sort={domain:e.domain.toLowerCase(),property:e.field,order:"a"},this.gridState=Object.assign({},this.gridState,{sort:[{field:e.domain.toLowerCase()+"_"+e.field,dir:"asc"}]}));else{var t=this.model.schema.columns.findIndex(function(t){return t.domain===e.domain.toLowerCase()&&t.property===e.field});-1!==t&&this.model.schema.columns.splice(t,1),this.gridState.sort.length>0&&this.gridState.sort[0].field===e.domain.toLowerCase()+"_"+e.field&&this.model.schema.columns.length>0&&(this.gridState.sort=[{field:this.model.schema.columns[0].domain.toLowerCase()+"_"+this.model.schema.columns[0],dir:"asc"}],this.model.schema.sort.domain=this.model.schema.columns[0].domain,this.model.schema.sort.property=this.model.schema.columns[0].property),this.model.schema.columns.length||this.clearSorting()}this.draggableColumns=this.model.schema.columns.slice(),this.data=null,this.model.schema=Object($.a)(this.model.schema),this.previewButtonClicked=!1},e.prototype.modifyFavoriteSignature=function(e){var t=JSON.parse(this.dataSignature);t.isFavorite=e,this.dataSignature=JSON.stringify(t)},e.prototype.onFavorite=function(){var e=this;this.model.isFavorite?this.model.id?this.assetExplorerService.deleteFavorite(this.model.id).subscribe(function(t){e.model.isFavorite=!1,e.modifyFavoriteSignature(e.model.isFavorite),e.select.loadData()}):this.model.isFavorite=!1:this.assetExplorerService.hasMaximumFavorites(this.select.data.filter(function(e){return"Favorites"===e.name})[0].items.length+1)?this.notifier.broadcast({name:L.b.DANGER,message:"Maximum number of favorite data views reached."}):this.model.id?this.assetExplorerService.saveFavorite(this.model.id).subscribe(function(t){e.model.isFavorite=!0,e.modifyFavoriteSignature(e.model.isFavorite),e.select.loadData()}):this.model.isFavorite=!0},e.prototype.onPreview=function(){var e=this;if(this.isValid()&&this.previewButtonClicked){var t=this.getQueryParams();this.assetExplorerService.previewQuery(t).subscribe(function(t){e.data=t,jQuery('[data-toggle="popover"]').popover()},function(e){return console.log(e)})}else this.data=null},e.prototype.freezeColumn=function(e){e.locked=!e.locked,this.onLockedColumn(e)},e.prototype.onLockedColumn=function(e){var t=this.model.schema.columns.findIndex(function(t){return t.domain===e.domain&&t.property===e.property});this.model.schema.columns.splice(t,1);var s=this.model.schema.columns.filter(function(e){return e.locked}).length;this.model.schema.columns.splice(s,0,e),this.draggableColumns=this.model.schema.columns.slice()},e.prototype.getQueryParams=function(){var e={offset:this.gridState.skip,limit:this.gridState.take,sortDomain:this.model.schema.sort.domain,sortProperty:this.model.schema.sort.property,sortOrder:this.model.schema.sort.order,filters:{domains:this.model.schema.domains,columns:this.model.schema.columns}};return this.justPlanning&&(e.justPlanning=this.justPlanning),e},e.prototype.onClearTextFilter=function(){this.filterModel.search="",this.applyFilters()},e.prototype.onToggleConfig=function(){var e=this;this.collapsed=!this.collapsed,setTimeout(function(){e.notifier.broadcast({name:"grid.header.position.change"})},1200)},e.prototype.onToggleSelectedColumnsPreview=function(){this.collapsedColumnsPreview=!this.collapsedColumnsPreview},e.prototype.onDragEnd=function(){this.model.schema.columns=this.draggableColumns.slice()},e.prototype.clearSorting=function(){this.gridState.sort=[],delete this.model.schema.sort},e.prototype.onJustPlanningChange=function(e){this.justPlanning=e},e.prototype.onGridStateChange=function(e){this.gridState=e},e.prototype.hasAtLeastOneNonLockedColumnOrEmpty=function(){var e=this.model.schema&&this.model.schema.columns||[];if(0===e.length)return!0;var t=e.filter(function(e){return!e.locked});return Boolean(t.length)},i.b([Object(o.lb)("select"),i.d("design:type",X)],e.prototype,"select",void 0),e=i.b([Object(o.n)({selector:"asset-explorer-View-config",templateUrl:"../tds/web-app/app-js/modules/assetExplorer/components/view-config/asset-explorer-view-config.component.html"}),i.d("design:paramtypes",[m.a,m.c,v.a,H.b,w.a,O.a,I.b,R.a])],e)}(),te=function(){function e(e,t,s,i,o,a){this.route=e,this.router=t,this.dialogService=s,this.permissionService=i,this.assetExplorerService=o,this.notifier=a,this.fields=[],this.model=new k.b,this.domains=[],this.metadata={},this.gridState={skip:0,take:x.l,sort:[]},this.metadata.tagList=this.route.snapshot.data.tagList,this.fields=this.route.snapshot.data.fields,this.domains=this.route.snapshot.data.fields,this.model=this.route.snapshot.data.report,this.dataSignature=JSON.stringify(this.model)}return e.prototype.ngOnInit=function(){this.reloadStrategy(),this.initialiseComponent()},e.prototype.ngOnDestroy=function(){this.navigationSubscription&&this.navigationSubscription.unsubscribe()},e.prototype.reloadStrategy=function(){var e=this;this.navigationSubscription=this.router.events.subscribe(function(t){t.snapshot&&t.snapshot.data&&t.snapshot.data.fields&&(e.lastSnapshot=t.snapshot),t instanceof m.b&&(console.log(t),e.currentId&&e.currentId!==e.lastSnapshot.params.id&&(e.metadata.tagList=e.lastSnapshot.data.tagList,e.fields=e.lastSnapshot.data.fields,e.domains=e.lastSnapshot.data.fields,e.model=e.lastSnapshot.data.report,e.dataSignature=JSON.stringify(e.model),e.initialiseComponent()))})},e.prototype.initialiseComponent=function(){this.justPlanning=!1,this.currentId=this.model.id,this.notifier.broadcast({name:"notificationHeaderTitleChange",title:this.model.name}),this.gridState=Object.assign({},this.gridState,{sort:[{field:this.model.schema.sort.domain+"_"+this.model.schema.sort.property,dir:"a"===this.model.schema.sort.order?"asc":"desc"}]})},e.prototype.onQuery=function(){var e=this,t={offset:this.gridState.skip,limit:this.gridState.take,sortDomain:this.model.schema.sort.domain,sortProperty:this.model.schema.sort.property,sortOrder:this.model.schema.sort.order,filters:{domains:this.model.schema.domains,columns:this.model.schema.columns}};this.justPlanning&&(t.justPlanning=!0),this.assetExplorerService.query(this.model.id,t).subscribe(function(t){e.data=t,jQuery('[data-toggle="popover"]').popover()},function(e){return console.log(e)})},e.prototype.onEdit=function(){this.isEditAvailable()&&this.router.navigate(["asset","views",this.model.id,"edit"])},e.prototype.onSave=function(){var e=this;this.isSaveAvailable()&&this.assetExplorerService.saveReport(this.model).subscribe(function(t){e.dataSignature=JSON.stringify(e.model)})},e.prototype.onSaveAs=function(){var e=this,t=this.select.data.filter(function(e){return"Favorites"===e.name})[0];this.isSaveAsAvailable()&&this.dialogService.open(Q,[{provide:k.b,useValue:this.model},{provide:k.a,useValue:t}]).then(function(t){e.model=t,e.dataSignature=JSON.stringify(e.model),setTimeout(function(){e.router.navigate(["asset","views",e.model.id,"edit"])})}).catch(function(e){console.log("error")})},e.prototype.isDirty=function(){return this.dataSignature!==JSON.stringify(this.model)},e.prototype.onExport=function(){var e={assetQueryParams:this.getQueryParamsForExport(),domains:this.domains,queryId:this.model.id,viewName:this.model.name};this.dialogService.open(Z,[{provide:J,useValue:e}]).then(function(e){console.log(e)}).catch(function(e){console.log("error:",e)})},e.prototype.onFavorite=function(){var e=this;this.model.isFavorite?this.assetExplorerService.deleteFavorite(this.model.id).subscribe(function(t){e.model.isFavorite=!1,e.select.loadData()}):this.assetExplorerService.hasMaximumFavorites(this.select.data.filter(function(e){return"Favorites"===e.name})[0].items.length+1)?this.notifier.broadcast({name:L.b.DANGER,message:"Maximum number of favorite data views reached."}):this.assetExplorerService.saveFavorite(this.model.id).subscribe(function(t){e.model.isFavorite=!0,e.select.loadData()})},e.prototype.getQueryParamsForExport=function(){var e={offset:this.data?0:this.gridState.skip,limit:this.data?this.data.pagination.total:this.gridState.take,forExport:!0,sortDomain:this.model.schema.sort.domain,sortProperty:this.model.schema.sort.property,sortOrder:this.model.schema.sort.order,filters:{domains:this.model.schema.domains,columns:this.model.schema.columns}};return this.justPlanning&&(e.justPlanning=this.justPlanning),e},e.prototype.isSaveAvailable=function(){return this.assetExplorerService.isSaveAvailable(this.model)},e.prototype.isSaveAsAvailable=function(){return this.model.isSystem?this.permissionService.hasPermission(D.a.AssetExplorerSystemSaveAs):this.permissionService.hasPermission(D.a.AssetExplorerSaveAs)},e.prototype.isSystemSaveAvailable=function(e){return e?this.permissionService.hasPermission(D.a.AssetExplorerSystemEdit):this.permissionService.hasPermission(D.a.AssetExplorerSystemSaveAs)},e.prototype.isEditAvailable=function(){return this.model.isSystem?this.permissionService.hasPermission(D.a.AssetExplorerSystemEdit):this.permissionService.hasPermission(D.a.AssetExplorerEdit)},e.prototype.onJustPlanningChange=function(e){this.justPlanning=e},e.prototype.onGridStateChange=function(e){this.gridState=e},e.prototype.save=function(){this.model.isOwner?this.onSave():this.onSaveAs()},e.prototype.getSaveButtonId=function(){return this.model.isOwner?"btnSave":"btnSaveAs"},i.b([Object(o.lb)("select"),i.d("design:type",X)],e.prototype,"select",void 0),e=i.b([Object(o.n)({selector:"asset-explorer-view-show",templateUrl:"../tds/web-app/app-js/modules/assetExplorer/components/view-show/asset-explorer-view-show.component.html"}),i.d("design:paramtypes",[m.a,m.c,H.b,w.a,v.a,O.a])],e)}(),se=function(){function e(){}return e.REPORT_SELECTOR={url:"views"},e.REPORT_CREATE={url:"views/create"},e.REPORT_EDIT={url:"views/:id/edit"},e.REPORT_SHOW={url:"views/:id/show"},e}(),ie=[{path:"",pathMatch:"full",redirectTo:se.REPORT_SELECTOR.url},{path:se.REPORT_SELECTOR.url,data:{page:{title:"ASSET_EXPLORER.ASSET_EXPLORER",instruction:"",menu:["ASSETS.ASSETS","ASSET_EXPLORER.ASSET_EXPLORER"],topMenu:{parent:"menu-parent-assets",child:"menu-parent-assets-asset-manager",subMenu:!0}},requiresAuth:!0},component:G,resolve:{reports:b},canActivate:[C.a,f.a,g.a],runGuardsAndResolvers:"always"},{path:se.REPORT_CREATE.url,data:{page:{title:"ASSET_EXPLORER.ASSET_EXPLORER",instruction:"",menu:["ASSETS.ASSETS",{text:"ASSET_EXPLORER.ASSET_EXPLORER",navigateTo:"asset/"+se.REPORT_SELECTOR.url},"ASSET_EXPLORER.CREATE"]},requiresAuth:!0,requiresPermission:"AssetExplorerCreate",hasPendingChanges:!1},component:ee,resolve:{tagList:A.a,report:y,reports:b,fields:E},canActivate:[C.a,f.a,g.a],runGuardsAndResolvers:"always"},{path:se.REPORT_EDIT.url,data:{page:{title:"ASSET_EXPLORER.ASSET_EXPLORER",instruction:"",menu:["ASSETS.ASSETS",{text:"ASSET_EXPLORER.ASSET_EXPLORER",navigateTo:"asset/"+se.REPORT_SELECTOR.url},"ASSET_EXPLORER.EDIT"]},requiresAuth:!0,requiresPermission:"AssetExplorerEdit",hasPendingChanges:!1},component:ee,resolve:{tagList:A.a,report:y,reports:b,fields:E},canActivate:[C.a,f.a,g.a],runGuardsAndResolvers:"always"},{path:se.REPORT_SHOW.url,data:{page:{title:"ASSET_EXPLORER.ASSET_EXPLORER",instruction:"",menu:["ASSETS.ASSETS",{text:"ASSET_EXPLORER.ASSET_EXPLORER",navigateTo:"asset/"+se.REPORT_SELECTOR.url},"ASSET_EXPLORER.SHOW"],topMenu:{parent:"menu-parent-assets",child:"menu-parent-assets-asset-explorer",subMenu:!0}},requiresAuth:!0},component:te,resolve:{tagList:A.a,report:y,reports:b,fields:E},canActivate:[C.a,f.a,g.a],runGuardsAndResolvers:"always"}],oe=function(){function e(){}return e=i.b([Object(o.J)({exports:[m.d],imports:[m.d.forChild(ie)]})],e)}(),ae=s(46),ne=(s(148),s(147),function(){function e(e){this.http=e,this.assetExplorerUrl="../assetEntity/listComments"}return e.prototype.searchComments=function(e,t){return this.http.get(this.assetExplorerUrl+"/"+e+"?commentType="+t).map(function(e){return e.json()}).catch(function(e){return e.json()})},e=i.b([Object(o.B)(),i.d("design:paramtypes",[ae.a])],e)}()),re=s(906),le=s(373),ce=s(376),de=s(920),ue=s(916),pe=s(370),he=s(59),me=s(60),fe=s(378),ge=s(310),ve=s(4),Se=s(288),ye=s(907);!function(e){e.APPLICATION="APPLICATION",e.DATABASE="DATABASE",e.DEVICE="DEVICE",e.STORAGE="STORAGE"}(_||(_={}));var be=s(922);var Te=s(305),Ee=s(209),Ae=s(286),Ce="Please Select";var ke=s(85),we=function(e){function t(t,s,i,o,a,n){var r=e.call(this,t,s,i)||this;return r.http=o,r.tagService=a,r.asset=n,r}return i.c(t,e),t.prototype.ngAfterViewInit=function(){var e=this;this.prepareMetadata().then(function(t){ve.Observable.zip(e.http.get("../ws/asset/createTemplate/"+e.asset),e.http.get("../ws/asset/defaultCreateModel/"+e.asset)).subscribe(function(s){var a=s[0].text(),n=s[1].json(),r={};Object.keys(n.asset||{}).filter(function(e){return e.startsWith("custom")}).forEach(function(e){n.asset[e]&&(r[e]=n.asset[e])}),n.asset=r,!n.moveBundleList&&n.dependencyMap&&n.dependencyMap.moveBundleList&&(n.moveBundleList=n.dependencyMap.moveBundleList),setTimeout(function(){switch(e.asset){case"APPLICATION":e.registerAndCreate(function(e,t,s){return function(a){function n(e,t,i,o,n,r,l,c,d){var u=a.call(this,e,t,i,o,n,r,l,s,c)||this;return u.prompt=d,u.defaultItem={fullName:Ce,personId:null},u.addPersonItem={fullName:"Add person",personId:-1},u.moveBundleList=[],u.yesNoList=["Y","N"],u.personList=null,u.persons={sme:null,sme2:null,appOwner:null},u}return i.c(n,a),n.prototype.ngOnInit=function(){this.initModel(),this.focusControlByName("assetName"),this.model.asset.validation=this.defaultValidation},n.prototype.initModel=function(){this.model.asset.retireDate="",this.model.asset.maintExpDate="",this.model.asset.moveBundle=this.model.dependencyMap.moveBundleList[0],this.moveBundleList=this.model.dependencyMap.moveBundleList,this.model.asset.planStatus=this.model.planStatusOptions[0],this.model.asset.assetClass={name:_.APPLICATION},this.model.asset.sme={id:null},this.model.asset.sme2={id:null},this.model.asset.appOwner={id:null},this.model.asset.shutdownBy={id:null},this.model.asset.startupBy={id:null},this.model.asset.testingBy={id:null},this.model.asset.startupProc="",this.model.asset.testProc="",this.model.asset.latency="",this.model.asset.environment="",this.model.asset.criticality="",this.model.asset.scale={name:{value:"",text:""}},this.persons.sme={personId:null},this.persons.sme2={personId:null},this.persons.appOwner={personId:null}},n.prototype.shufflePerson=function(e,t){var s=this.model.asset&&this.model.asset[e]&&this.model.asset[e].id||null,i=this.model.asset&&this.model.asset[t]&&this.model.asset[t].id||null;if(s&&i){var o=s;this.model.asset[e].id=i,this.model.asset[t].id=o,this.updatePersonReferences()}},n.prototype.onCreate=function(){var e=this,t=$.a(this.model);t&&t.asset.moveBundle&&(t.asset.moveBundleId=t.asset.moveBundle.id),t.asset.scale=t.asset.scale&&t.asset.scale.name&&t.asset.scale.name.value||"",t.asset.shutdownBy=t.asset.shutdownBy&&t.asset.shutdownBy.id||"",t.asset.startupBy=t.asset.startupBy&&t.asset.startupBy.id||"",t.asset.testingBy=t.asset.testingBy&&t.asset.testingBy.id||"",t.asset.environment=t.asset.environment===this.defaultSelectOption?"":t.asset.environment,t.asset.criticality=t.asset.criticality===this.defaultSelectOption?"":t.asset.criticality,Object.keys(t.asset).filter(function(e){return e.startsWith("custom")}).forEach(function(e){t.asset[e]=t.asset[e]&&t.asset[e].value?t.asset[e].value:t.asset[e]}),this.assetExplorerService.createAsset(t).subscribe(function(t){e.notifierService.broadcast({name:"reloadCurrentAssetList"}),t.id&&!isNaN(t.id)&&t.id>0&&e.createTags(t.id)})},n.prototype.onAddPerson=function(e,t,s,i,o,a){var n=this;if(e.personId===this.addPersonItem.personId){var r=new Ee.a;r.asset=t,r.fieldName=s,r.companies=i||[],r.teams=o,r.staffType=a||[],this.dialogService.extra(Te.a,[H.b,{provide:Ee.a,useValue:r},Ae.a],!1,!0).then(function(e){n.personList.push({personId:e.id,fullName:e.name}),n.model.asset[s].id=e.id,n.updatePersonReferences()}).catch(function(e){n.persons[s]={personId:n.model.asset[s].id}})}else this.model.asset[s].id=e.personId},n.prototype.getPersonList=function(e){return this.personList||(this.personList=e,this.personList.unshift(this.addPersonItem)),this.personList},n.prototype.updatePersonReferences=function(){this.persons.sme={personId:this.model.asset.sme.id},this.persons.sme2={personId:this.model.asset.sme2.id},this.persons.appOwner={personId:this.model.asset.appOwner.id}},n=i.b([Object(o.n)({selector:"tds-application-create",template:e,providers:[{provide:"model",useValue:t}]}),i.e(0,Object(o.A)("model")),i.d("design:paramtypes",[Object,H.a,P.c,v.a,H.b,O.a,le.a,I.b,I.b])],n)}(ye.a)}(a,n,t),e.view);break;case"DATABASE":e.registerAndCreate(function(e,t,s){return function(a){function n(e,t,i,o,n,r,l,c){return a.call(this,e,t,i,o,n,r,l,s,c)||this}return i.c(n,a),n.prototype.ngOnInit=function(){this.model.asset.retireDate=null,this.model.asset.maintExpDate=null,this.model.asset.moveBundle=this.model.dependencyMap.moveBundleList[0],this.model.asset.planStatus=this.model.planStatusOptions[0],this.model.asset.environment="",this.model.asset.scale=null,this.model.asset.validation=this.defaultValidation,this.focusControlByName("assetName")},n.prototype.onCreate=function(){var e=this,t=$.a(this.model);t.asset.scale=t.asset.scale&&t.asset.scale.value?t.asset.scale.value:t.asset.scale,t.asset.moveBundleId=t.asset.moveBundle.id,t.asset.assetClass={name:_.DATABASE},this.model.asset.assetClass=t.asset.assetClass,t.asset.environment=t.asset.environment===this.defaultSelectOption?"":t.asset.environment,this.assetExplorerService.createAsset(t).subscribe(function(t){e.notifierService.broadcast({name:"reloadCurrentAssetList"}),t.id&&!isNaN(t.id)&&t.id>0&&e.createTags(t.id)})},n=i.b([Object(o.n)({selector:"tds-database-create",template:e,providers:[{provide:"model",useValue:t}]}),i.e(0,Object(o.A)("model")),i.d("design:paramtypes",[Object,H.a,P.c,v.a,H.b,O.a,le.a,I.b])],n)}(ye.a)}(a,n,t),e.view);break;case"DEVICE":e.registerAndCreate(function(e,t,s){return function(a){function n(e,t,i,o,n,r,l,c){return a.call(this,e,t,i,o,n,r,l,s,c)||this}return i.c(n,a),n.prototype.ngOnInit=function(){this.initModel(),this.toggleAssetTypeFields(),this.focusControlByName("assetName")},n.prototype.initModel=function(){this.model.sourceRoomSelect=[this.defaultRoom].concat(this.model.sourceRoomSelect),this.model.targetRoomSelect=[this.defaultRoom].concat(this.model.targetRoomSelect),this.model.rackSourceOptions=[this.defaultRoom].concat(this.model.rackSourceOptions),this.model.rackTargetOptions=[this.defaultRoom].concat(this.model.rackTargetOptions),this.model.bladeSourceOptions=[this.defaultRoom].concat(this.model.bladeSourceOptions),this.model.bladeTargetOptions=[this.defaultRoom].concat(this.model.bladeTargetOptions),this.model.asset.assetTypeSelectValue={id:null},this.model.asset.manufacturerSelectValue={id:null},this.model.asset.modelSelectValue={id:null},this.model.asset.moveBundle=this.model.dependencyMap.moveBundleList[0],this.model.asset.planStatus=this.defaultPlanStatus,this.model.asset.validation=this.defaultValidation,this.model.asset.environment="",this.model.asset.priority="",this.model.asset.roomSource=this.defaultRoom,this.model.asset.roomTarget=this.defaultRoom,this.model.asset.rackSource=this.defaultRoom,this.model.asset.rackTarget=this.defaultRoom,this.model.sourceChassis=this.defaultRoom,this.model.targetChassis=this.defaultRoom,this.model.asset.scale=null},n.prototype.onCreate=function(){var e=this,t=$.a(this.model);this.prepareModelRequestToSave(t),t.asset.moveBundleId=t.asset.moveBundle.id,t.asset.assetClass={name:_.DEVICE},this.model.asset.assetClass=t.asset.assetClass,this.assetExplorerService.createAsset(t).subscribe(function(t){e.notifierService.broadcast({name:"reloadCurrentAssetList"}),t.id&&!isNaN(t.id)&&t.id>0&&e.createTags(t.id)})},n=i.b([Object(o.n)({selector:"tds-device-create",template:e,providers:[{provide:"model",useValue:t}]}),i.e(0,Object(o.A)("model")),i.d("design:paramtypes",[Object,H.a,P.c,v.a,H.b,O.a,le.a,I.b])],n)}(be.a)}(a,n,t),e.view);break;case"STORAGE":e.registerAndCreate(function(e,t,s){return function(a){function n(e,t,i,o,n,r,l,c){return a.call(this,e,t,i,o,n,r,l,s,c)||this}return i.c(n,a),n.prototype.ngOnInit=function(){this.initModel(),this.focusControlByName("assetName")},n.prototype.initModel=function(){var e=this;this.model.asset.moveBundle=this.model.dependencyMap.moveBundleList[0],this.model.asset.planStatus=this.model.planStatusOptions.find(function(t){return t===e.defaultPlanStatus}),this.model.asset.validation=this.defaultValidation,this.model.asset.environment="",this.model.asset.scale=null},n.prototype.onCreate=function(){var e=this,t=$.a(this.model);t.asset.scale=t.asset.scale&&t.asset.scale.value?t.asset.scale.value:t.asset.scale,t.asset.moveBundleId=t.asset.moveBundle.id,t.asset.assetClass={name:_.STORAGE},this.model.asset.assetClass=t.asset.assetClass,this.assetExplorerService.createAsset(t).subscribe(function(t){e.notifierService.broadcast({name:"reloadCurrentAssetList"}),t.id&&!isNaN(t.id)&&t.id>0&&e.createTags(t.id)})},n=i.b([Object(o.n)({selector:"tds-storage-create",template:e,providers:[{provide:"model",useValue:t}]}),i.e(0,Object(o.A)("model")),i.d("design:paramtypes",[Object,H.a,P.c,v.a,H.b,O.a,le.a,I.b])],n)}(ye.a)}(a,n,t),e.view)}},700)})})},t.prototype.prepareMetadata=function(){var e={},t=[];return t.push(this.getTagList(e)),new Promise(function(s,i){Promise.all(t).then(function(){s(e)})})},t.prototype.getTagList=function(e){var t=this;return new Promise(function(s,i){t.tagService.getTags().subscribe(function(i){i.status===ke.a.API_SUCCESS?e.tagList=i.data:(e.tagList=[],t.handleError(i.errors?i.errors[0]:"Error on get tag list call")),s(e)},function(i){s(e),t.handleError(i)})})},t.prototype.handleError=function(e){console.log(e)},i.b([Object(o.lb)("view",{read:o.nb}),i.d("design:type",o.nb)],t.prototype,"view",void 0),t=i.b([Object(o.n)({selector:"tds-asset-all-create",template:"<div #view></div>"}),i.e(5,Object(o.A)("ASSET")),i.d("design:paramtypes",[o.D,o.l,o.M,ae.a,le.a,String])],t)}(Se.a),Ie=s(908),De=function(){function e(e,t,s){this.assetModalModel=e,this.activeDialog=t,this.currentUserId=s}return e.prototype.cancelCloseDialog=function(){this.activeDialog.dismiss()},e=i.b([Object(o.n)({selector:"tds-task-comment-dialog",templateUrl:"../tds/web-app/app-js/modules/assetExplorer/components/task-comment/dialog/task-comment-dialog.component.html"}),i.e(2,Object(o.A)("currentUserId")),i.d("design:paramtypes",[Ie.a,H.a,Number])],e)}(),Oe=function(){return function(){}}(),Le=s(272),Re=function(e){function t(t,s,i,o,a){var n=e.call(this,"#single-comment-component")||this;return n.singleCommentModel=t,n.userPreferenceService=s,n.taskManagerService=i,n.assetExplorerService=o,n.promptService=a,n.modalType=x.s,n}return i.c(t,e),t.prototype.ngOnInit=function(){this.dateFormatTime=this.userPreferenceService.getUserDateTimeFormat(),this.loadCommentCategories()},t.prototype.loadCommentCategories=function(){var e=this;this.taskManagerService.getCommentCategories().subscribe(function(t){e.commentCategories=t,e.singleCommentModel.category&&null!==e.singleCommentModel.category||(e.singleCommentModel.category=e.commentCategories[0]),e.dataSignature=JSON.stringify(e.getModelFields())})},t.prototype.isDirty=function(){return this.dataSignature!==JSON.stringify(this.getModelFields())},t.prototype.onEdit=function(){this.singleCommentModel.modal.title="Edit Comment",this.singleCommentModel.modal.type=x.s.EDIT},t.prototype.onSave=function(){var e=this;this.taskManagerService.saveComment(this.singleCommentModel).subscribe(function(t){e.close()})},t.prototype.getModelFields=function(){var e=this.singleCommentModel;return{id:e.id,archive:e.archive,comment:e.comment,category:e.category,assetClass:e.assetClass,asset:e.asset}},t.prototype.onDelete=function(){var e=this;this.promptService.open("Confirmation Required","Confirm deletion of this record. There is no undo for this action?","Confirm","Cancel").then(function(t){t&&e.taskManagerService.deleteTaskComment(e.singleCommentModel.id).subscribe(function(t){e.close()})}).catch(function(e){return console.log(e)})},t.prototype.cancelCloseDialog=function(){var e=this;this.isDirty()?this.promptService.open("Confirmation Required","You have changes that have not been saved. Do you want to continue and lose those changes?","Confirm","Cancel").then(function(t){t&&e.dismiss()}).catch(function(e){return console.log(e)}):this.dismiss()},t=i.b([Object(o.n)({selector:"single-comment",templateUrl:"../tds/web-app/app-js/modules/assetExplorer/components/single-comment/single-comment.component.html",styles:[]}),i.d("design:paramtypes",[Oe,P.c,Le.a,v.a,I.b])],t)}(H.c),xe=s(912),Pe=s(911),Fe=s(271),Ne=function(){return function(){this.columns=[{label:"Category",property:"category",type:"text",width:70},{label:"Task #",property:"taskNumber",type:"text",width:60},{label:"Task",property:"desc",type:"text",width:200}]}}(),Me=s(322),_e=s(596),je=s(106),Ve=function(){return function(){this.columns=[{label:"Date Created",property:"dateCreated",type:"text",width:70},{label:"Created By",property:"createdBy",type:"text",width:80},{label:"Notes",property:"note",type:"text",width:200}]}}(),Ue=["Yes","No"],Be=[1,2,3,4,5],Ge={HOLD:"Hold",PLANNED:"Planned",READY:"Ready",PENDING:"Pending",STARTED:"Started",COMPLETED:"Completed",TERMINATED:"Terminated"},He=function(){function e(e,t){this.STATUS=Ge,this.model={},this.userTimeZone=e,this.userCurrentDateFormat=t,this.userCurrentDateTimeFormat=t+" "+K.a.DEFAULT_FORMAT_TIME}return e.prototype.getModelForEdit=function(e){return this.model=e,this.dataSignatureDependencyTasks=JSON.stringify({predecessors:this.model.predecessorList,successors:this.model.successorList}),e},e.prototype.getInstructionsLink=function(e){var t="";return!e.instructionsLinkLabel&&e.instructionsLinkURL?t=e.instructionsLinkURL:e.instructionsLinkLabel&&e.instructionsLinkURL&&(t=e.instructionsLinkLabel+"|"+e.instructionsLinkURL),t},e.prototype.getModelForCreate=function(e){var t=Ue[0],s=Ue[1];return this.model={title:e.modal.title,workflow:"",workflowTransitionName:"",durationDelta:"",recipe:"",id:e.id,personCreateObj:"",note:"",duration:0,durationText:"",actualDuration:"",dateCreated:"",taskSpec:"",lastUpdated:"",taskSpecId:"",taskNumber:"",hardAssigned:s,sendNotification:t,durationScale:"M",durationParts:{days:0,hours:0,minutes:0},locked:!1,actualStart:"",actualFinish:"",dueDate:"",estimatedStart:"",estimatedFinish:"",instructionLink:"",instructionsLinkLabel:"",instructionsLinkURL:"",priority:3,assetName:"",comment:"",assetClass:{id:e.detail.assetClass,text:""},assetClasses:[{id:"",text:""}],status:this.STATUS.READY,statusList:[],personList:[],teamList:[],originalPredecessorList:[],originalSuccessorList:[],notesList:[],predecessorList:[],successorList:[],apiActionList:[{id:"",text:""}],categoriesList:[],eventList:[{id:"",text:""}],priorityList:Be,asset:{id:e.detail.assetEntity,text:e.detail.assetName},assignedTo:{id:parseInt(e.detail.currentUserId,10),text:""},assignedTeam:{id:"",text:""},event:{id:"",text:""},category:"general",apiAction:{id:"",text:""},deletedPredecessorList:[],deletedSuccessorList:[]},this.dataSignatureDependencyTasks=JSON.stringify({predecessors:this.model.predecessorList,successors:this.model.successorList}),this.model},e.prototype.getModelForDetails=function(e){var t=Object($.a)(e.detail),s=t.assetComment||{},i=s.durationScale&&s.durationScale.name||null,o=Ue[0],a=Ue[1],n=(t.categories||[]).slice();n.push("");var r=this.getInstructionsLink(t);return this.model={apiActionInvokedAt:s.apiActionInvokedAt,apiActionCompletedAt:s.apiActionCompletedAt,title:e.modal.title,workflow:t.workflow||"",workflowTransitionName:s.workflowTransition&&s.workflowTransition.name||"",durationDelta:t.durationDelta||"",recipe:t.recipe||null,id:s.id,personCreateObj:t.personCreateObj||"",note:"",duration:s.duration,durationText:K.a.formatDuration(s.duration,i),actualDuration:t.actualDuration||"",dateCreated:s.dateCreated,taskSpec:s.taskSpec,lastUpdated:s.lastUpdated,taskSpecId:t.taskSpecId||"",taskNumber:s.taskNumber,hardAssigned:Boolean(1===s.hardAssigned)?o:a,sendNotification:Boolean(s.sendNotification)?o:a,durationScale:i,durationParts:K.a.getDurationParts(s.duration,i),locked:s.durationLocked,actualStart:t.atStart?t.atStart:"",actualFinish:t.dtResolved?t.dtResolved:"",dueDate:s.dueDate?new Date(K.a.formatUserDateTime(this.userTimeZone,s.dueDate)):"",estimatedStart:s.estStart?new Date(K.a.formatUserDateTime(this.userTimeZone,s.estStart)):"",estimatedFinish:s.estFinish?new Date(K.a.formatUserDateTime(this.userTimeZone,s.estFinish)):"",instructionLink:r,instructionsLinkLabel:t.instructionsLinkLabel||"",instructionsLinkURL:t.instructionsLinkURL||"",priority:s.priority,assetName:t.assetName,comment:s.comment||"",assetClass:{id:t.assetClass,text:t.assetClasses&&t.assetClasses[t.assetClass]||""},assetClasses:Object.keys(t.assetClasses||{}).map(function(e){return{id:e,text:t.assetClasses[e]}}),status:s.status,statusList:[],personList:[],teamList:[],originalPredecessorList:t.predecessorList||[],originalSuccessorList:t.successorList||[],notesList:t.notes||[],predecessorList:this.extractDependencyTasks(t.predecessorList||[]),successorList:this.extractDependencyTasks(t.successorList||[]),apiActionList:(t.apiActionList||[]).map(function(e){return{id:e.id,text:e.name}}),categoriesList:n.sort(),eventList:(t.eventList||[]).map(function(e){return{id:e.id,text:e.name}}),priorityList:Be,asset:{id:t.assetId,text:t.assetName},assignedTo:{id:s.assignedTo&&s.assignedTo.id||null,text:t.assignedTo},assignedTeam:{id:s.role,text:t.roles},event:{id:s.moveEvent&&s.moveEvent.id||null,text:t.eventName},category:s.category,apiAction:{id:t.apiAction&&t.apiAction.id||"",text:t.apiAction&&t.apiAction.name||""},deletedPredecessorList:[],deletedSuccessorList:[]},this.dataSignatureDependencyTasks=JSON.stringify({predecessors:this.model.predecessorList,successors:this.model.successorList}),this.model},e.prototype.extractDependencyTasks=function(e){var t=this;return e.map(function(e){return t.makeTaskItem(e)})},e.prototype.getTaskAdded=function(e,t){return e.filter(function(e){return!Boolean(e.originalId)}).map(function(e,t){return"-"+(t+1)+"_"+e.id})},e.prototype.getTaskEdited=function(e,t){return e.filter(function(e){return Boolean(e.originalId)}).map(function(e,t){return e.originalId+"_"+(e.id===e.originalId?e.taskId:e.id)})},e.prototype.getTaskPrevious=function(e,t){return e.filter(function(e){return t.find(function(t){return t.taskId===e.id})}).map(function(e,t){return e.id+"_"+e.taskNumber})},e.prototype.getPayloadForUpdate=function(){Ue[0];var e=Ue[1],t=this.model,s=t.id,i=t.assetClass,o=t.predecessorList,a=t.successorList,n=t.originalPredecessorList,r=t.originalSuccessorList,l=t.asset,c=t.dueDate,d=t.durationParts,u=t.estimatedFinish,p=t.estimatedStart,h=t.taskNumber,m=t.note,f=t.locked,g=t.hardAssigned,v=t.sendNotification,S=t.instructionLink,y=t.event,b=t.category,T=t.apiAction,E=t.comment,A=t.priority,C=t.assignedTeam,k=t.status,w=t.assignedTo,I=t.durationScale,D=this.model.deletedPredecessorList.concat(this.model.deletedSuccessorList).join(",");return{assetClass:i.id,assetEntity:this.getEmptyStringIfNull(l&&l.id).toString(),assetType:i.text,assignedTo:this.getEmptyStringIfNull(w&&w.id).toString(),category:b,apiAction:this.getEmptyStringIfNull(T&&T.id),apiActionId:this.getEmptyStringIfNull(T&&T.id).toString()||"0",actionInvocable:"",actionMode:"",comment:E,commentFromId:"",commentId:this.getEmptyStringIfNull(s).toString(),commentType:"issue",deletePredId:"",dueDate:c?K.a.formatDate(c,this.userCurrentDateFormat):"",duration:K.a.convertDurationPartsToMinutes(d).toString(),durationScale:I,estFinish:u?K.a.formatDate(u,this.userCurrentDateTimeFormat):"",estStart:p?K.a.formatDate(p,this.userCurrentDateTimeFormat):"",forWhom:"",hardAssigned:g===e?"0":"1",sendNotification:v===e?"0":"1",isResolved:"0",instructionsLink:this.addProtocolToLabelURL(S),moveEvent:this.getEmptyStringIfNull(y&&y.id).toString(),mustVerify:"0",override:"0",predCount:"-1",predecessorCategory:"",prevAsset:"",priority:A.toString(),resolution:"",role:this.getEmptyStringIfNull(C&&C.id),status:k,manageDependency:"1",taskDependency:this.getTaskAdded(o,n).concat(this.getTaskEdited(o,n)),taskSuccessor:this.getTaskAdded(a,r).concat(this.getTaskEdited(a,r)),deletedPreds:D,workflowTransition:"",canEdit:!0,durationLocked:f?"1":"0",durationText:d.days+" days "+d.hours+" hrs "+d.minutes+" mins",taskNumber:h.toString(),note:m,id:s}},e.prototype.getPayloadForCreate=function(){Ue[0];var e=Ue[1],t=this.model,s=t.id,i=t.assetClass,o=t.predecessorList,a=t.successorList,n=t.originalPredecessorList,r=t.originalSuccessorList,l=t.asset,c=t.dueDate,d=t.durationParts,u=t.estimatedFinish,p=t.estimatedStart,h=(t.taskNumber,t.note,t.locked),m=t.hardAssigned,f=t.sendNotification,g=t.instructionLink,v=t.event,S=t.category,y=t.apiAction,b=t.comment,T=t.priority,E=t.assignedTeam,A=t.status,C=t.assignedTo,k=t.durationScale,w=this.model.deletedPredecessorList.concat(this.model.deletedSuccessorList).join(",");return{assetClass:i.id,assetEntity:this.getEmptyStringIfNull(l&&l.id).toString(),assetType:i.text,assignedTo:this.getEmptyStringIfNull(C&&C.id).toString(),category:S,apiAction:this.getEmptyStringIfNull(y&&y.id),apiActionId:this.getEmptyStringIfNull(y&&y.id).toString()||"0",actionInvocable:"",actionMode:"",comment:b,commentFromId:"",commentId:this.getEmptyStringIfNull(s).toString(),commentType:"issue",deletePredId:"",dueDate:c?K.a.formatDate(c,this.userCurrentDateFormat):"",duration:K.a.convertDurationPartsToMinutes(d).toString(),durationScale:k,estFinish:u?K.a.formatDate(u,this.userCurrentDateTimeFormat):"",estStart:p?K.a.formatDate(p,this.userCurrentDateTimeFormat):"",forWhom:"",hardAssigned:m===e?"0":"1",sendNotification:f===e?"0":"1",isResolved:"0",instructionsLink:this.addProtocolToLabelURL(g),moveEvent:this.getEmptyStringIfNull(v&&v.id).toString(),mustVerify:"0",override:"0",predCount:"-1",predecessorCategory:"",prevAsset:"",priority:T.toString(),resolution:"",role:this.getEmptyStringIfNull(E&&E.id),status:A,manageDependency:"1",taskDependency:this.getTaskAdded(o,n).concat(this.getTaskPrevious(o,n)),taskSuccessor:this.getTaskAdded(a,r).concat(this.getTaskPrevious(a,r)),deletedPreds:w,workflowTransition:"",canEdit:!0,durationLocked:h?"1":"0",id:""}},e.prototype.getEmptyStringIfNull=function(e){return null===e||void 0===e||!1===e?"":e},e.prototype.hasDependencyTasksChanges=function(){return this.dataSignatureDependencyTasks!==JSON.stringify({predecessors:this.model.predecessorList,successors:this.model.successorList})},e.prototype.hasDuplicatedPredecessors=function(){return this.hasDuplicates(this.model.predecessorList)},e.prototype.hasDuplicatedSuccessors=function(){return this.hasDuplicates(this.model.successorList)},e.prototype.hasDuplicates=function(e){return this.extractDistinctIds(e).length<e.length},e.prototype.extractDistinctIds=function(e){var t=[];return(e||[]).forEach(function(e){var s="id";e.taskId&&(s="taskId"),-1===t.indexOf(e[s])&&t.push(e[s])}),t},e.prototype.addProtocolToLabelURL=function(e){void 0===e&&(e="");var t=!1,s=e.split("|"),i=s[0],o=s[1];return o||(t=!0,o=i),!(o=o.toLowerCase())||o.startsWith("http://")||o.startsWith("https://")||(o="http://"+o),t?o:[i,o].join("|")},e.prototype.hasDoubleAssignment=function(){var e=this.extractDistinctIds(this.model.predecessorList).filter(function(e){return e}),t=this.extractDistinctIds(this.model.successorList).filter(function(e){return e});return e.some(function(e){return t.indexOf(e)>=0})||t.some(function(t){return e.indexOf(t)>=0})},e.prototype.hasEmptyIds=function(e){return e.filter(function(e){return""===e.id}).length>0},e.prototype.hasInvalidTasksDependencies=function(){var e=this.model,t=e.predecessorList,s=e.successorList;return this.hasDuplicates(t)||this.hasDuplicates(s)||this.hasEmptyIds(t)||this.hasEmptyIds(s)||this.hasDoubleAssignment()},e.prototype.toggleLocked=function(){this.model.locked=!this.model.locked},e.prototype.addPredecessor=function(e,t){var s=null;return this.model.predecessorList[e]&&(s=this.model.predecessorList[e].originalId),(t=this.makeTaskItem(t)).originalId=s,this.model.predecessorList[e]=t},e.prototype.addSuccessor=function(e,t){var s=null;return this.model.successorList[e]&&(s=this.model.successorList[e].originalId),(t=this.makeTaskItem(t)).originalId=s,this.model.successorList[e]=t},e.prototype.deleteSuccessor=function(e){var t=this.deleteTaskItem(e,this.model.successorList,this.model.deletedSuccessorList);return this.model.successorList=this.model.successorList.slice(),t},e.prototype.deletePredecessor=function(e){var t=this.deleteTaskItem(e,this.model.predecessorList,this.model.deletedPredecessorList);return this.model.predecessorList=this.model.predecessorList.slice(),t},e.prototype.getPredecessor=function(){return this.model.predecessorList},e.prototype.getSuccessor=function(){return this.model.successorList},e.prototype.deleteTaskItem=function(e,t,s){var i=t[e].id,o=Boolean(i);return o&&s.push(i),t.splice(e,1),o},e.prototype.makeTaskItem=function(e){var t=e.id,s=e.desc,i=void 0===s?"":s,o=e.taskId,a=void 0===o?"":o,n=e.taskNumber,r=e.category,l=e.status,c=e.text,d=void 0===c?"":c,u=this.removeTaskNumberFromDescription(i||d,n);return{id:t,originalId:t,taskId:a,category:r,status:l,taskNumber:n,desc:u,model:{id:a||t,text:u}}},e.prototype.removeTaskNumberFromDescription=function(e,t){return e.replace(new RegExp("^"+t+": "),"")},e.prototype.generateNotes=function(e){var t=new Array;return e.forEach(function(e){var s=e[0],i=e[1],o=e[2];t.push({dateCreated:s,createdBy:i,note:o})}),t},e.prototype.rowStatusColor=function(e){return"task-"+(e.dataItem&&e.dataItem.status||"").toLowerCase()},e}(),Ye={DEFAULT_TASK_HEIGHT:1118,DEFAULT_TASK_WIDTH:917},qe=function(e){function t(t,s,i,o,a,n,r){var l=e.call(this,"#task-component")||this;return l.taskDetailModel=t,l.taskManagerService=s,l.dialogService=i,l.promptService=o,l.userPreferenceService=a,l.permissionService=n,l.translatePipe=r,l.modalType=x.s,l.taskSuccessorPredecessorColumnsModel=new Ne,l.collapsedTaskDetail=!1,l.hasCookbookPermission=!1,l.model={},l.yesNoList=Ue.slice(),l.hasModelChanges=!1,l.hasDeleteTaskPermission=!1,l.hasEditTaskPermission=!1,l.taskNotesColumnsModel=new Ve,l.SHARED_TASK_SETTINGS=Ye,l.modalOptions={isResizable:!0,isCentered:!0},l.getTasksForComboBox=l.getTasksForComboBox.bind(l),l}return i.c(t,e),t.prototype.ngOnInit=function(){var e=this;this.userTimeZone=this.userPreferenceService.getUserTimeZone(),this.dateFormat=this.userPreferenceService.getDefaultDateFormatAsKendoFormat(),this.dateFormatTime=this.userPreferenceService.getUserDateTimeFormat(),this.isEventLocked=!1,this.modelHelper=new He(this.userTimeZone,this.userPreferenceService.getUserCurrentDateFormatOrDefault()),this.model=this.taskDetailModel.modal.type===x.s.CREATE?this.modelHelper.getModelForCreate(this.taskDetailModel):this.modelHelper.getModelForEdit(this.taskDetailModel),this.getAssetList=this.taskManagerService.getAssetListForComboBox.bind(this.taskManagerService),this.predecessorSuccessorColumns=this.taskSuccessorPredecessorColumnsModel.columns,this.isEventLocked=this.model.predecessorList.length>0||this.model.successorList.length>0;var t=[this.taskManagerService.getStatusList(this.model.id),this.taskManagerService.getAssignedTeam(this.model.id),this.taskManagerService.getStaffRoles(),this.userPreferenceService.getUserDatePreferenceAsKendoFormat(),this.taskManagerService.getActionList()];this.taskDetailModel.modal.type===x.s.CREATE&&(t.push(this.taskManagerService.getAssetClasses()),t.push(this.taskManagerService.getCategories()),t.push(this.taskManagerService.getEvents()),t.push(this.taskManagerService.getLastCreatedTaskSessionParams()),t.push(this.taskManagerService.getClassForAsset(this.model.id))),this.metaParam=this.getMetaParam(),S.Observable.forkJoin(t).subscribe(function(t){var s=t[0],i=t[1],o=t[2],a=t[3],n=t[4],r=t[5],l=t[6],c=t[7],d=t[8],u=t[9];e.model.statusList=s,e.model.personList=i.map(function(e){return{id:e.id,text:e.nameRole}}),e.model.teamList=o.map(function(e){return{id:e.id,text:e.description}}),e.dateFormat=a,e.model.apiActionList=n.map(function(e){return{id:e.id,text:e.name}}),r&&(e.model.assetClasses=r.map(function(e){return{id:e.key,text:e.label}})),l&&(e.model.categoriesList=[""].concat(l)),c&&(e.model.eventList=c.map(function(e){return{id:e.id.toString(),text:e.name}})),d&&d.preferences&&(e.model.event={id:d.preferences.TASK_CREATE_EVENT||"",text:""},e.model.category=d.preferences.TASK_CREATE_CATEGORY||"general",e.model.status=d.preferences.TASK_CREATE_STATUS||Ge.READY,e.metaParam=e.getMetaParam()),u&&(e.model.assetClass={id:u.assetClass,text:""}),jQuery('[data-toggle="popover"]').popover()}),this.dataGridTaskPredecessorsHelper=new Fe.a(this.model.predecessorList,null,null),this.dataGridTaskSuccessorsHelper=new Fe.a(this.model.successorList,null,null),this.dataGridTaskNotesHelper=new Fe.a(this.modelHelper.generateNotes(this.model.notesList),null,null),this.hasCookbookPermission=this.permissionService.hasPermission(D.a.CookbookView)||this.permissionService.hasPermission(D.a.CookbookEdit),this.hasDeleteTaskPermission=this.permissionService.hasPermission(D.a.TaskDelete),this.hasEditTaskPermission=this.permissionService.hasPermission(D.a.TaskEdit)},t.prototype.getAssetListForComboBox=function(e){return this.taskManagerService.getAssetListForComboBox(e)},t.prototype.onDependencyTaskChange=function(e,t,s,o){var a,n;if("predecessor"===t?(a=this.modelHelper.addPredecessor,n=this.modelHelper.getPredecessor):(a=this.modelHelper.addSuccessor,n=this.modelHelper.getSuccessor),e){var r=e.id,l=e.text;a.bind(this.modelHelper)(o,i.a({id:r,text:l},e.metaFields))}s.reloadData(n.bind(this.modelHelper)())},t.prototype.onAddTaskDependency=function(e,t){var s={id:"",desc:"",model:{id:"",text:""}};e.unshift(s),t.addDataItem(s)},t.prototype.getTasksForComboBox=function(e){return this.taskManagerService.getTasksForComboBox(e)},t.prototype.toggleLocked=function(){this.modelHelper.toggleLocked(),this.hasModelChanges=!0},t.prototype.onModelChange=function(e,t,s){if(e)return e.text=this.modelHelper.removeTaskNumberFromDescription(e.text,e.metaFields.taskNumber),void(this.hasModelChanges=!0);void 0===e&&("predecessor"===t&&(this.modelHelper.deletePredecessor(s),this.dataGridTaskPredecessorsHelper.reloadData(this.model.predecessorList),this.hasModelChanges=!0),"successor"===t&&(this.modelHelper.deleteSuccessor(s),this.dataGridTaskSuccessorsHelper.reloadData(this.model.successorList),this.hasModelChanges=!0),this.hasModelChanges=!0)},t.prototype.onAssetEntityChange=function(e){this.model.asset=e,this.hasModelChanges=!0},t.prototype.getFormattedDate=function(e){return new Date(K.a.formatUserDateTime(this.userTimeZone,e))},t.prototype.getDateTimeFormat=function(e){return void 0===e&&(e=null),e?this.dateFormat+" "+K.a.DEFAULT_FORMAT_TIME:this.dateFormat},t.prototype.openRangeDatesSelector=function(){var e=this,t={start:this.model.estimatedStart,end:this.model.estimatedFinish,locked:this.model.locked,dateFormat:this.dateFormat,timeFormat:K.a.DEFAULT_FORMAT_TIME,duration:this.model.durationParts};this.dialogService.extra(Me.a,[{provide:I.b,useValue:this.promptService},{provide:_e.a,useValue:Object($.a)(t)}],!1,!1).then(function(t){if(t){var s=t.start,i=t.end,o=t.duration,a=t.locked;e.model.estimatedStart=s,e.model.estimatedFinish=i,e.model.durationParts=o,e.model.locked=a,e.hasModelChanges=!0}}).catch(function(e){console.log("Dismissed Dialog")})},t.prototype.onSave=function(){var e=this;this.taskManagerService.updateTask(this.modelHelper.getPayloadForUpdate()).subscribe(function(t){return e.close(t)})},t.prototype.onCreate=function(){var e=this;this.taskManagerService.createTask(this.modelHelper.getPayloadForCreate()).subscribe(function(t){return e.close(t)})},t.prototype.onCollapseTaskDetail=function(){this.collapsedTaskDetail=!this.collapsedTaskDetail},t.prototype.cancelCloseDialog=function(){var e=this;this.isFormDirty()?this.promptService.open(this.translatePipe.transform("GLOBAL.CONFIRMATION_PROMPT.CONFIRMATION_REQUIRED"),this.translatePipe.transform("GLOBAL.CONFIRMATION_PROMPT.UNSAVED_CHANGES_MESSAGE"),this.translatePipe.transform("GLOBAL.CONFIRM"),this.translatePipe.transform("GLOBAL.CANCEL")).then(function(t){t&&e.dismiss()}):this.dismiss()},t.prototype.deleteTask=function(){var e=this;this.promptService.open(this.translatePipe.transform("GLOBAL.CONFIRMATION_PROMPT.CONFIRMATION_REQUIRED"),this.translatePipe.transform("TASK_MANAGER.DELETE_TASK"),this.translatePipe.transform("GLOBAL.CONFIRM"),this.translatePipe.transform("GLOBAL.CANCEL")).then(function(t){t&&e.close({id:e.taskDetailModel,isDeleted:!0})})},t.prototype.updateEstimatedFinish=function(e,t){var s=K.a.getDurationPartsAmongDates(this.model.estimatedStart,this.model.estimatedFinish);""===e&&(this.model.durationParts[t]=0);var i=this.model.durationParts[t]-s[t];this.model.estimatedFinish&&(this.model.estimatedFinish=K.a.increment(this.model.estimatedFinish,[{value:i,unit:t}]))},t.prototype.cleanEstimatedDates=function(){(this.model.estimatedStart||this.model.estimatedFinish)&&(this.model.estimatedFinish="",this.model.estimatedStart="",this.hasModelChanges=!0)},t.prototype.hasInvalidFields=function(){return!!this.modelHelper.hasDependencyTasksChanges()&&this.modelHelper.hasInvalidTasksDependencies()},t.prototype.isFormInvalid=function(){return!this.taskEditCreateForm.form.valid||this.hasInvalidFields()||!(this.taskEditCreateForm.form.dirty||this.hasModelChanges)},t.prototype.isFormDirty=function(){return this.modelHelper.hasDependencyTasksChanges()||this.taskEditCreateForm.dirty||this.hasModelChanges},t.prototype.validateLabelURL=function(e){var t=!1;e||(t=!0);var s=t||je.a.isValidLabelURL(e)?null:{incorrect:!0};this.taskEditCreateForm.form.controls.instructionLink.setErrors(s)},t.prototype.onAssetClassChange=function(){this.model.asset=null},t.prototype.getMetaParam=function(e){return void 0===e&&(e=""),{commentId:this.taskDetailModel.modal.type===x.s.CREATE?"":this.model.id,eventId:e||this.model.event.id}},t.prototype.onSelectedEvent=function(e){this.metaParam=this.getMetaParam(e.id)},t.prototype.innerTemplateTaskItem=function(e){return e.metaFields&&(e.text.startsWith(e.metaFields.taskNumber)||(e.text=e.metaFields.taskNumber+": "+e.text)),e.text},i.b([Object(o.lb)("taskEditCreateForm"),i.d("design:type",n.g)],t.prototype,"taskEditCreateForm",void 0),t}(H.c),Xe=s(69),Qe=function(){return function(){}}(),We=function(e){function t(t,s,i,o,a,n,r){return e.call(this,t,s,i,o,a,n,r)||this}return i.c(t,e),t=i.b([Object(o.n)({selector:"tds-task-create",templateUrl:"../tds/web-app/app-js/modules/taskManager/components/create/task-create.component.html",styles:[]}),i.d("design:paramtypes",[Qe,Le.a,H.b,I.b,P.c,w.a,Xe.a])],t)}(qe),Je=s(595),Ke=s(306),Ze=P.b.ASSET_JUST_PLANNING,ze=P.b.ASSET_LIST_SIZE,$e=function(){function e(e,t,s,i,a,n,r){this.preferenceService=e,this.bulkCheckboxService=t,this.notifier=s,this.dialog=i,this.permissionService=a,this.assetExplorerService=n,this.userService=r,this.modelChange=new o.w,this.justPlanningChange=new o.w,this.gridStateChange=new o.w,this.currentFields=[],this.justPlanning=!1,this.VIEW_COLUMN_MIN_WIDTH=z.a,this.gridMessage="ASSET_EXPLORER.GRID.INITIAL_VALUE",this.showMessage=!0,this.ASSET_ENTITY_MENU=ge.a,this.ASSET_ENTITY_DIALOG_TYPES=_,this.notAllowedCharRegex=/ALT|ARROW|F+|ESC|TAB|SHIFT|CONTROL|PAGE|HOME|PRINT|END|CAPS|AUDIO|MEDIA/i,this.maxDefault=x.l,this.maxOptions=x.m,this.fieldNotFound=Y.c,this.selectAll=!1,this.columnFiltersOldValues=[],this.tagList=[],this.bulkItems=[],this.bulkChangeType=he.c.Assets,this.fieldPipeMap={pipe:{},metadata:{}},this.userDateFormat=this.preferenceService.getUserDateFormatForMomentJS()}return Object.defineProperty(e.prototype,"viewId",{set:function(e){this._viewId=e,this.bulkCheckboxService.setCurrentState(me.a.unchecked),this.setActionCreateButton(e),this.gridStateChange.emit(i.a({},this.gridState,{skip:0})),this.modelChange.emit()},enumerable:!0,configurable:!0}),e.prototype.ngOnInit=function(){var e=this;this.gridData={data:[],total:0},this.userTimeZone=this.preferenceService.getUserTimeZone(),this.selectedAssetsForBulk=[],this.getPreferences().subscribe(function(t){e.updateGridState({take:parseInt(t[ze],10)||25}),e.bulkCheckboxService.setPageSize(e.gridState.take),e.justPlanning=!!t[Ze]&&"true"===t[Ze].toString(),e.justPlanningChange.emit(e.justPlanning),e.onReload()}),this.currentFields=this.fields.reduce(function(e,t){return e.concat(t.fields)},[]).map(function(t){if((t.control===Y.a.DateTime||t.control===Y.a.Date||t.control===Y.a.Number)&&(e.fieldPipeMap.pipe[t.domain+"_"+t.field]=t.control,t.control===Y.a.Number)){var s=t.constraints.format||"0";e.fieldPipeMap.metadata[t.domain+"_"+t.field]=s}return{key:t.domain+"_"+t.field,label:t.label}}),this.eventListeners(),this.getCurrentUser()},e.prototype.ngOnChanges=function(e){var t=e.data;t&&t.currentValue!==t.previousValue&&this.applyData(t.currentValue)},e.prototype.getPreferences=function(){return this.preferenceService.getPreferences(ze,Ze)},e.prototype.eventListeners=function(){var e=this;this.notifier.on("reloadCurrentAssetList",function(t){e.onReload()})},e.prototype.getPropertyLabel=function(e){var t=this.currentFields.find(function(t){return t.key===e.domain+"_"+e.property});return t?t.label:(e.notFound=!0,e.label)},e.prototype.rowCallbackClass=function(e){var t={};return t[e.dataItem.common_assetClass.toLowerCase()]=!0,t},e.prototype.onClearFilters=function(){this.model.columns.forEach(function(e){e.filter=""}),this.onFilter(),this.tagSelector&&this.tagSelector.reset()},e.prototype.hasFilterApplied=function(){return this.model.columns.filter(function(e){return e.filter}).length>0},e.prototype.clearText=function(e){if(this.bulkCheckboxService.handleFiltering(),e.filter){if(e.filter="",this.updateGridState({skip:0}),this.preventFilterSearch(e))return;this.onReload()}},e.prototype.onReload=function(){this.modelChange.emit()},e.prototype.onFilter=function(){this.updateGridState({skip:0}),this.onReload()},e.prototype.preventFilterSearch=function(e){var t=e.domain+"_"+e.property,s=this.columnFiltersOldValues[t];return this.columnFiltersOldValues[t]=e.filter,s===e.filter},e.prototype.onFilterKeyUp=function(e,t){var s=this;this.preventFilterSearch(t)||(e.code===x.p.ENTER?this.onFilter():this.notAllowedCharRegex.test(e.code)||(clearTimeout(this.typingTimeout),this.typingTimeout=setTimeout(function(){return s.onFilter()},x.D)))},e.prototype.onPaste=function(e){var t=this;this.preventFilterSearch(e)||(clearTimeout(this.typingTimeout),this.typingTimeout=setTimeout(function(){return t.onFilter()},x.D))},e.prototype.onFilterKeyDown=function(e){this.bulkCheckboxService.handleFiltering(),this.notAllowedCharRegex.test(e.code)||clearTimeout(this.typingTimeout)},e.prototype.applyData=function(e){var t=e||{},s=t.assets,i=void 0===s?null:s,o=t.pagination,a=void 0===o?null:o,n=a&&a.total||0;this.gridMessage="ASSET_EXPLORER.GRID.NO_RECORDS",this.bulkCheckboxService.initializeKeysBulkItems(i||[]),this.gridData={data:i||[],total:n},this.showMessage=0===n,this.notifier.broadcast({name:"grid.header.position.change"}),jQuery(".k-grid-content-locked").addClass("element-height-100-per-i")},e.prototype.clear=function(){this.showMessage=!0,this.gridMessage="ASSET_EXPLORER.GRID.SCHEMA_CHANGE",this.gridData=null,jQuery(".k-grid-content-locked").addClass("element-height-100-per-i"),this.updateGridState({skip:0,take:this.gridState.take,sort:[]})},e.prototype.dataStateChange=function(e){if(e.sort[0]){e.sort[0].dir||(e.sort[0].dir="a"===this.model.sort.order?"desc":"asc");var t=e.sort[0].field.split("_");this.model.sort.domain=t[0],this.model.sort.property=t[1],this.model.sort.order="asc"===e.sort[0].dir?"a":"d"}this.updateGridState(e),this.modelChange.emit()},e.prototype.createDependencyPromise=function(e,t){var s=this;setTimeout(function(){s.dialog.open(ue.a,[{provide:"ID",useValue:t},{provide:"ASSET",useValue:e}],x.e.LG).then(function(e){s.createDependencyPromise(e.assetClass,e.id)}).catch(function(e){console.log(e)})},500)},e.prototype.onShow=function(e){var t=this;this.dialog.open(ue.a,[{provide:"ID",useValue:e.common_id},{provide:"ASSET",useValue:e.common_assetClass}],x.e.LG,!1).then(function(e){e&&t.createDependencyPromise(e.assetClass,e.id),t.onReload()}).catch(function(e){console.log("Error:",e),t.onReload()})},e.prototype.onCreateAsset=function(e){var t=this;e&&this.dialog.open(we,[{provide:"ASSET",useValue:e}],x.e.LG,!1).then(function(e){e&&t.createDependencyPromise(e.assetClass,0)}).catch(function(e){console.log(e)})},e.prototype.onWidthChange=function(e){this.model.columns.filter(function(t){return e[0].column.field===t.domain+"_"+t.property}).forEach(function(t){t.width=e[0].newWidth})},e.prototype.onChangeBulkCheckbox=function(e){this.bulkCheckboxService.changeState(e)},e.prototype.checkItem=function(e,t){this.bulkCheckboxService.checkItem(e,t,this.gridData.data.length)},e.prototype.onBulkOperationResult=function(e){e&&e.success&&(this.bulkCheckboxService.uncheckItems(),this.onReload())},e.prototype.canCreateAssets=function(){return this.permissionService.hasPermission(D.a.AssetExplorerCreate)},e.prototype.showTask=function(e,t){this.highlightGridRow(t);var s={assetId:e.common_id,assetName:e.common_assetName,assetType:e.common_assetClass,modalType:"TASK"};this.dialog.open(De,[{provide:Ie.a,useValue:s},{provide:"currentUserId",useValue:this.currentUser.id}],x.e.LG,!0).then(function(e){e&&console.log("Show Task Result",e)}).catch(function(e){console.log(e)})},e.prototype.createTask=function(e,t){var s=this;this.highlightGridRow(t);var i={id:e.common_id,modal:{title:"Create Task",type:x.s.CREATE},detail:{assetClass:e.common_assetClass,assetEntity:e.common_id,assetName:e.common_assetName,currentUserId:this.currentUser.id}};this.dialog.extra(We,[{provide:Qe,useValue:i}],!1,!1).then(function(e){e&&s.onReload()}).catch(function(e){console.log("Cancel:",e)})},e.prototype.showComment=function(e,t){this.highlightGridRow(t);var s={assetId:e.common_id,assetName:e.common_assetName,assetType:e.common_assetClass,modalType:"COMMENT"};this.dialog.open(De,[{provide:Ie.a,useValue:s},{provide:"currentUserId",useValue:this.currentUser.id}],x.e.LG,!0).then(function(e){e&&console.log("Show Comment Result",e)}).catch(function(e){console.log(e)})},e.prototype.createComment=function(e,t){var s=this;this.highlightGridRow(t);var i={modal:{title:"Create Comment",type:x.s.CREATE},archive:!1,comment:"",category:"",assetClass:{text:e.common_assetClass},asset:{id:e.common_id,text:e.common_assetName}};this.dialog.extra(Re,[{provide:Oe,useValue:i}],!1,!1).then(function(e){console.log("RESULT SINGLE COMMENT",e),s.onReload()}).catch(function(e){console.log(e)})},e.prototype.showAssetEditView=function(e,t){var s=this;this.highlightGridRow(t);var i=[{provide:"ID",useValue:e.common_id},{provide:"ASSET",useValue:e.common_assetClass}];this.dialog.open(xe.a,i,x.e.LG).then(function(){return s.onReload()}).catch(function(e){return s.onReload()})},e.prototype.showAssetCloneView=function(e,t){var s=this;this.highlightGridRow(t);var i={assetType:e.common_assetClass,assetId:e.common_id};this.dialog.extra(Pe.a,[{provide:Ie.a,useValue:i}],!1,!1).then(function(t){if(t.clonedAsset&&t.showEditView){var i=[{provide:"ID",useValue:t.assetId},{provide:"ASSET",useValue:e.common_assetClass}];s.dialog.open(xe.a,i,x.e.XLG)}else if(!t.clonedAsset&&t.showView){var o={common_id:t.assetId,common_assetClass:e.common_assetClass};s.onShow(o)}}).catch(function(e){return console.log("error",e)})},e.prototype.setCreatebuttonState=function(e){this._viewId===this.ASSET_ENTITY_MENU.All_ASSETS&&(this.createButtonState=e)},e.prototype.setActionCreateButton=function(e){switch(e){case this.ASSET_ENTITY_MENU.All_APPLICATIONS:this.createButtonState=this.ASSET_ENTITY_DIALOG_TYPES.APPLICATION;break;case this.ASSET_ENTITY_MENU.All_DATABASES:this.createButtonState=this.ASSET_ENTITY_DIALOG_TYPES.DATABASE;break;case this.ASSET_ENTITY_MENU.All_DEVICE:case this.ASSET_ENTITY_MENU.All_STORAGE_PHYSICAL:case this.ASSET_ENTITY_MENU.All_SERVERS:this.createButtonState=this.ASSET_ENTITY_DIALOG_TYPES.DEVICE;break;case this.ASSET_ENTITY_MENU.All_STORAGE_VIRTUAL:this.createButtonState=this.ASSET_ENTITY_DIALOG_TYPES.STORAGE}},e.prototype.displayCreateButton=function(){return this._viewId===this.ASSET_ENTITY_MENU.All_ASSETS||this._viewId===this.ASSET_ENTITY_MENU.All_APPLICATIONS||this._viewId===this.ASSET_ENTITY_MENU.All_DATABASES||this._viewId===this.ASSET_ENTITY_MENU.All_DEVICE||this._viewId===this.ASSET_ENTITY_MENU.All_STORAGE_PHYSICAL||this._viewId===this.ASSET_ENTITY_MENU.All_SERVERS||this._viewId===this.ASSET_ENTITY_MENU.All_STORAGE_VIRTUAL},e.prototype.onClickTemplate=function(e){e.preventDefault()},e.prototype.cellClick=function(e){-1!==["common_assetName","common_id"].indexOf(e.column.field)&&this.onShow(e.dataItem)},e.prototype.highlightGridRow=function(e){jQuery("tr.k-state-selected").removeClass("k-state-selected"),jQuery("tr[data-kendo-grid-item-index="+e+"]").addClass("k-state-selected")},e.prototype.getCellClass=function(e){if(-1!==["common_assetName","common_id"].indexOf(e.domain+"_"+e.property)){var t="asset-detail-link";return"assetName"===e.property&&(t+=" asset-detail-name-column"),t}return""},e.prototype.onChangeJustPlanning=function(e){var t=this;void 0===e&&(e=!1),this.justPlanningChange.emit(e),this.preferenceService.setPreference(Ze,e.toString()).subscribe(function(){t.onReload()})},e.prototype.onTagFilterChange=function(e,t){e.filter="";var s=t.operator&&"ALL"===t.operator?"&":"|",i=t.tags.map(function(e){return e.id}).join(""+s);e.filter=i,this.onFilter()},e.prototype.onClickBulkButton=function(){var e=this;this.bulkCheckboxService.getBulkSelectedItems({viewId:this._viewId,model:this.model,justPlanning:this.justPlanning},this.getBulkAssetIdsFromView.bind(this)).subscribe(function(t){e.bulkItems=t.selectedAssetsIds.slice(),e.selectedAssetsForBulk=t.selectedAssets.slice(),e.tdsBulkChangeButton.bulkData({bulkItems:e.bulkItems,assetsSelectedForBulk:e.selectedAssetsForBulk})},function(e){return console.log("Error:",e)})},e.prototype.hasSelectedItems=function(){return this.bulkCheckboxService.hasSelectedItems()},e.prototype.getSelectedItemsCount=function(){var e=this.gridData&&this.gridData.total||0;return this.bulkCheckboxService.getSelectedItemsCount(e)},e.prototype.getCurrentUser=function(){var e=this;this.userService.getUserInfo().subscribe(function(t){e.currentUser=t},function(e){return console.log(e)})},e.prototype.updateGridState=function(e){var t=Object.assign({},this.gridState,e);this.gridStateChange.emit(t)},e.prototype.getBulkAssetIdsFromView=function(e){var t=e.viewId,s=e.model,i=e.justPlanning,o={forExport:!0,offset:0,limit:0,sortDomain:s.sort.domain,sortProperty:s.sort.property,sortOrder:s.sort.order,filters:{domains:s.domains,columns:s.columns}};return i&&(o.justPlanning=!0),this.assetExplorerService.query(t,o)},i.b([Object(o.E)(),i.d("design:type",Object)],e.prototype,"data",void 0),i.b([Object(o.E)(),i.d("design:type",z.b)],e.prototype,"model",void 0),i.b([Object(o.E)(),i.d("design:type",Object)],e.prototype,"gridState",void 0),i.b([Object(o.Q)(),i.d("design:type",Object)],e.prototype,"modelChange",void 0),i.b([Object(o.Q)(),i.d("design:type",Object)],e.prototype,"justPlanningChange",void 0),i.b([Object(o.Q)(),i.d("design:type",Object)],e.prototype,"gridStateChange",void 0),i.b([Object(o.E)(),i.d("design:type",Boolean)],e.prototype,"edit",void 0),i.b([Object(o.E)(),i.d("design:type",Object)],e.prototype,"metadata",void 0),i.b([Object(o.E)(),i.d("design:type",Object)],e.prototype,"fields",void 0),i.b([Object(o.lb)("tagSelector"),i.d("design:type",pe.a)],e.prototype,"tagSelector",void 0),i.b([Object(o.lb)("tdsBulkChangeButton"),i.d("design:type",Ke.a)],e.prototype,"tdsBulkChangeButton",void 0),i.b([Object(o.E)(),i.d("design:type",Number),i.d("design:paramtypes",[Number])],e.prototype,"viewId",null),e=i.b([Object(o.n)({selector:"asset-explorer-view-grid",exportAs:"assetExplorerViewGrid",changeDetection:o.j.OnPush,templateUrl:"../tds/web-app/app-js/modules/assetExplorer/components/view-grid/asset-explorer-view-grid.component.html"}),i.d("design:paramtypes",[P.c,fe.a,O.a,H.b,w.a,v.a,Je.a])],e)}(),et=function(){return function(){this.columns=[{label:"Action",property:"action",type:"action",width:82,locked:!0},{label:"Task #",property:"commentInstance.taskNumber",type:"text",width:70},{label:"Task",property:"commentInstance.comment",type:"text",width:200},{label:"Status",property:"commentInstance.status",type:"text",width:105},{label:"Category",property:"commentInstance.category",type:"text",width:105},{label:"Assigned To",property:"assignedTo",type:"text",width:105}]}}(),tt=function(){return function(){this.columns=[{label:"Action",property:"action",type:"action",width:60,locked:!0},{label:"Comment",property:"commentInstance.comment",type:"text",width:330},{label:"Category",property:"commentInstance.category",type:"text",width:100}]}}(),st=function(e){function t(t,s,i,o,a,n,r){return e.call(this,t,s,i,o,a,n,r)||this}return i.c(t,e),t=i.b([Object(o.n)({selector:"tds-task-edit",templateUrl:"../tds/web-app/app-js/modules/taskManager/components/edit/task-edit.component.html",styles:[]}),i.d("design:paramtypes",[Qe,Le.a,H.b,I.b,P.c,w.a,Xe.a])],t)}(qe),it=s(594),ot=function(e){function t(t,s,i,o,a,n,r,l){var c=e.call(this,"#task-detail-component")||this;return c.taskDetailModel=t,c.taskManagerService=s,c.dialogService=i,c.promptService=o,c.userPreferenceService=a,c.permissionService=n,c.translatePipe=r,c.windowService=l,c.modalType=x.s,c.taskSuccessorPredecessorColumnsModel=new Ne,c.taskNotesColumnsModel=new Ve,c.collapsedTaskDetail=!1,c.hasCookbookPermission=!1,c.hasEditTaskPermission=!1,c.hasDeleteTaskPermission=!1,c.model={},c.SHARED_TASK_SETTINGS=Ye,c.modalOptions={isResizable:!0,isCentered:!0},c}return i.c(t,e),t.prototype.ngOnInit=function(){this.hasChanges=!1,this.userTimeZone=this.userPreferenceService.getUserTimeZone(),this.currentUserId=parseInt(this.taskDetailModel.detail.currentUserId,10),this.loadTaskDetail(),this.hasCookbookPermission=this.permissionService.hasPermission(D.a.CookbookView)||this.permissionService.hasPermission(D.a.CookbookEdit),this.hasEditTaskPermission=this.permissionService.hasPermission(D.a.TaskEdit),this.hasDeleteTaskPermission=this.permissionService.hasPermission(D.a.TaskDelete)},t.prototype.getShowTaskActionsOptions=function(){var e={showDone:!1,showStart:!1,showAssignToMe:!1,showNeighborhood:!1,invoke:!1};if(!this.model)return e;var t=this.model.assignedTo&&this.model.assignedTo.id,s=this.model&&this.model.predecessorList||[],i=this.model&&this.model.successorList||[];return e.showDone=this.model.status&&[this.modelHelper.STATUS.READY,this.modelHelper.STATUS.STARTED].indexOf(this.model.status)>=0,e.showStart=this.model.status&&[this.modelHelper.STATUS.READY].indexOf(this.model.status)>=0,e.showAssignToMe=this.currentUserId!==t&&this.model.status&&[this.modelHelper.STATUS.READY,this.modelHelper.STATUS.PENDING,this.modelHelper.STATUS.STARTED].indexOf(this.model.status)>=0,e.showNeighborhood=s.concat(i).length>0,e.invoke=this.model.apiAction&&this.model.apiAction.id&&!this.model.apiActionInvokedAt&&this.model.status&&[this.modelHelper.STATUS.READY,this.modelHelper.STATUS.STARTED].indexOf(this.model.status)>=0,e},t.prototype.loadTaskDetail=function(){var e=this;this.taskManagerService.getTaskDetails(this.taskDetailModel.id).subscribe(function(t){t?(e.dateFormat=e.userPreferenceService.getUserDateFormat(),e.dateFormatTime=e.userPreferenceService.getUserDateTimeFormat(),e.taskDetailModel.detail=t,e.modelHelper=new He(e.userTimeZone,e.userPreferenceService.getUserCurrentDateFormatOrDefault()),e.model=e.modelHelper.getModelForDetails(e.taskDetailModel),e.model.instructionLink=e.modelHelper.getInstructionsLink(e.taskDetailModel.detail),e.dataGridTaskPredecessorsHelper=new Fe.a(e.model.predecessorList,null,null),e.dataGridTaskSuccessorsHelper=new Fe.a(e.model.successorList,null,null),e.dataGridTaskNotesHelper=new Fe.a(e.modelHelper.generateNotes(e.model.notesList),null,null),e.model.durationText=K.a.formatDuration(e.model.duration,e.model.durationScale),e.taskManagerService.getClassForAsset(e.model.asset.id).subscribe(function(t){if(t){var s=e.model.assetClasses.find(function(e){return e.id===t.assetClass});s&&(e.model.assetClass=s)}})):e.dismiss()})},t.prototype.openTaskDetail=function(e,t){this.close({commentInstance:{id:e.taskId}})},t.prototype.onCollapseTaskDetail=function(){this.collapsedTaskDetail=!this.collapsedTaskDetail},t.prototype.cancelCloseDialog=function(){this.dismiss(this.hasChanges)},t.prototype.deleteTask=function(){var e=this;this.promptService.open(this.translatePipe.transform("GLOBAL.CONFIRMATION_PROMPT.CONFIRMATION_REQUIRED"),this.translatePipe.transform("TASK_MANAGER.DELETE_TASK"),this.translatePipe.transform("GLOBAL.CONFIRM"),this.translatePipe.transform("GLOBAL.CANCEL")).then(function(t){t&&e.close({id:e.taskDetailModel,isDeleted:!0})})},t.prototype.editTaskDetail=function(){var e=this;this.model.modal={title:"Edit Task",type:x.s.EDIT},this.dialogService.extra(st,[{provide:Qe,useValue:Object($.a)(this.model)}],!1,!1).then(function(t){if(t){if(t.isDeleted)return void e.close({id:e.taskDetailModel,isDeleted:!0});e.hasChanges=!0,e.loadTaskDetail()}}).catch(function(t){e.dismiss(e.hasChanges)})},t.prototype.onStartTask=function(){var e=this,t={id:this.model.id.toString(),status:this.modelHelper.STATUS.STARTED,currentStatus:this.model.status};this.taskManagerService.updateTaskStatus(t).subscribe(function(t){e.hasChanges=!0,e.loadTaskDetail()})},t.prototype.onDoneTask=function(){var e=this,t={id:this.model.id.toString(),status:this.modelHelper.STATUS.COMPLETED,currentStatus:this.model.status};this.taskManagerService.updateTaskStatus(t).subscribe(function(t){e.hasChanges=!0,e.loadTaskDetail()})},t.prototype.onNeighborhood=function(){this.windowService.getWindow().open("../task/taskGraph?neighborhoodTaskId="+this.model.id,"_blank")},t.prototype.onAssignToMe=function(){var e=this,t={id:this.model.id.toString(),status:this.model.status};this.taskManagerService.assignToMe(t).subscribe(function(t){e.hasChanges=!0,e.loadTaskDetail()})},t.prototype.onInvoke=function(){var e=this;this.taskManagerService.invokeAction(this.model.id).subscribe(function(t){e.hasChanges=!0,e.loadTaskDetail()})},t=i.b([Object(o.n)({selector:"task-detail",templateUrl:"../tds/web-app/app-js/modules/taskManager/components/detail/task-detail.component.html",styles:[]}),i.d("design:paramtypes",[Qe,Le.a,H.b,I.b,P.c,w.a,Xe.a,it.a])],t)}(H.c),at=function(){function e(e,t,s,i,o){this.taskService=e,this.dialogService=t,this.promptService=s,this.taskManagerService=i,this.preferenceService=o,this.hasPublishPermission=!1,this.canEdit=!1,this.canEditTasks=!1,this.taskColumnModel=new et,this.commentColumnModel=new tt,this.modalType=x.s,this.viewUnpublished=!1,this.taskCommentsList=[],this.getPreferences()}return e.prototype.ngOnInit=function(){this.userTimeZone=this.preferenceService.getUserTimeZone(),this.showAllComments=!1,this.showAllTasks=!1,this.createDataGrids()},e.prototype.createDataGrids=function(){var e=this;this.taskService.searchComments(this.id,"").subscribe(function(t){e.taskCommentsList=t,e.dataGridTaskHelper=new Fe.a(e.getTaskWithFilter(),null,null),e.dataGridCommentHelper=new Fe.a(e.getCommentsWithFilter(),null,null)},function(e){return console.log(e)})},e.prototype.getTaskWithFilter=function(){var e=this;return this.taskCommentsList.filter(function(t){return e.viewUnpublished||t.commentInstance.isPublished}).filter(function(e){return"issue"===e.commentInstance.commentType||e.commentInstance.taskNumber}).filter(function(t){return e.showAllTasks||"Completed"!==t.commentInstance.status})},e.prototype.getCommentsWithFilter=function(){var e=this.taskCommentsList.filter(function(e){return"comment"===e.commentInstance.commentType&&null===e.commentInstance.dateResolved});return this.showAllComments&&(e=this.taskCommentsList.filter(function(e){return"comment"===e.commentInstance.commentType})),e},e.prototype.getAssignedTo=function(e){var t=e.role?"/"+e.role:"";return e.assignedTo+("comment"===e.commentInstance.commentType?"":t)},e.prototype.createComment=function(e){var t=this,s={modal:{title:"Create Comment",type:x.s.CREATE},archive:!1,comment:"",category:"",assetClass:{text:this.assetType},asset:{id:this.id,text:this.assetName}};this.dialogService.extra(Re,[{provide:Oe,useValue:s}],!1,!1).then(function(e){t.createDataGrids()}).catch(function(e){console.log("Dismissed Dialog")})},e.prototype.openTaskComment=function(e,t){e.commentInstance.taskNumber&&"null"!==e.commentInstance.taskNumber?this.openTaskDetail(e):this.openCommentDetail(e,t)},e.prototype.openCommentDetail=function(e,t){var s=this,i={id:e.commentInstance.id,modal:{title:t===x.s.EDIT?"Edit Comment":"Comment Detail",type:t},archive:null!==e.commentInstance.dateResolved,comment:e.commentInstance.comment,category:e.commentInstance.category,assetClass:{text:e.assetType},asset:{id:this.id,text:e.assetName},lastUpdated:e.commentInstance.lastUpdated,dateCreated:e.commentInstance.dateCreated};this.dialogService.extra(Re,[{provide:Oe,useValue:i}],!1,!1).then(function(e){s.createDataGrids()}).catch(function(e){console.log("Dismissed Dialog")})},e.prototype.openTaskCreate=function(){var e=this,t={id:this.id.toString(),modal:{title:"Create Task",type:x.s.CREATE},detail:{assetClass:this.assetType,assetEntity:this.id,assetName:this.assetName,currentUserId:this.currentUserId}};this.dialogService.extra(We,[{provide:Qe,useValue:t}],!1,!1).then(function(t){t&&e.createDataGrids()}).catch(function(e){console.log("Cancel:",e)})},e.prototype.openTaskDetail=function(e){var t=this,s={id:e.commentInstance.id,modal:{title:"Task Detail"},detail:{currentUserId:this.currentUserId}};this.dialogService.extra(ot,[{provide:Qe,useValue:s}],!1,!1).then(function(s){s&&(s.isDeleted?t.deleteTaskComment(e).then(function(){return t.createDataGrids()}):s.commentInstance&&t.openTaskDetail(s))}).catch(function(e){e&&t.createDataGrids()})},e.prototype.openTaskEdit=function(e){var t=this,s=new Qe;this.taskManagerService.getTaskDetails(e.commentInstance.id).subscribe(function(i){var o=new He(t.userTimeZone,t.preferenceService.getUserCurrentDateFormatOrDefault());s.detail=i,s.modal={title:"Task Edit",type:x.s.EDIT};var a=o.getModelForDetails(s);a.instructionLink=o.getInstructionsLink(s.detail),a.durationText=K.a.formatDuration(a.duration,a.durationScale),a.modal=s.modal,t.dialogService.extra(st,[{provide:Qe,useValue:Object($.a)(a)}],!1,!1).then(function(s){s&&(s.isDeleted?t.deleteTaskComment(e).then(function(){return t.createDataGrids()}):s.commentInstance&&t.openTaskDetail(s))}).catch(function(e){e&&t.createDataGrids()})})},e.prototype.reloadTasksGrid=function(){this.dataGridTaskHelper.reloadData(this.getTaskWithFilter())},e.prototype.reloadCommentsGrid=function(){this.dataGridCommentHelper.reloadData(this.getCommentsWithFilter())},e.prototype.onViewUnpublishedChange=function(){this.preferenceService.setPreference(P.b.VIEW_UNPUBLISHED,this.viewUnpublished.toString()).subscribe()},e.prototype.getPreferences=function(){var e=this;this.preferenceService.getPreferences(P.b.VIEW_UNPUBLISHED).subscribe(function(t){e.viewUnpublished=!!t[P.b.VIEW_UNPUBLISHED]&&"true"===t[P.b.VIEW_UNPUBLISHED].toString()})},e.prototype.onDelete=function(e){var t=this;this.promptService.open("Confirmation Required","Confirm deletion of this record. There is no undo for this action?","Confirm","Cancel").then(function(s){s&&t.deleteTaskComment(e)}).catch(function(e){return console.log(e)})},e.prototype.deleteTaskComment=function(e){var t=this;return new Promise(function(s,i){var o=e.commentInstance.id;t.taskManagerService.deleteTaskComment(o).subscribe(function(i){return t.dataGridTaskHelper.removeDataItem(e),t.dataGridCommentHelper.removeDataItem(e),t.dataGridTaskHelper.reloadData(t.dataGridTaskHelper.gridData.data),t.dataGridCommentHelper.reloadData(t.dataGridCommentHelper.gridData.data),t.taskCommentsList=t.taskCommentsList.filter(function(e){return e.commentInstance.id!==o}),s(!0)},function(e){return i(!1)})})},i.b([Object(o.E)("asset-id"),i.d("design:type",Number)],e.prototype,"id",void 0),i.b([Object(o.E)("has-publish-permission"),i.d("design:type",Object)],e.prototype,"hasPublishPermission",void 0),i.b([Object(o.E)("can-edit-comments"),i.d("design:type",Object)],e.prototype,"canEdit",void 0),i.b([Object(o.E)("can-edit-tasks"),i.d("design:type",Object)],e.prototype,"canEditTasks",void 0),i.b([Object(o.E)("asset-name"),i.d("design:type",String)],e.prototype,"assetName",void 0),i.b([Object(o.E)("asset-type"),i.d("design:type",String)],e.prototype,"assetType",void 0),i.b([Object(o.E)("show-task"),i.d("design:type",Boolean)],e.prototype,"showTask",void 0),i.b([Object(o.E)("show-comment"),i.d("design:type",Boolean)],e.prototype,"showComment",void 0),i.b([Object(o.E)("asset-class"),i.d("design:type",String)],e.prototype,"assetClass",void 0),i.b([Object(o.E)("user-id"),i.d("design:type",String)],e.prototype,"currentUserId",void 0),e=i.b([Object(o.n)({selector:"task-comment",templateUrl:"../tds/web-app/app-js/modules/assetExplorer/components/task-comment/task-comment.component.html",styles:[]}),i.d("design:paramtypes",[ne,H.b,I.b,Le.a,P.c])],e)}(),nt=s(918),rt=s(925),lt=s(926),ct=s(924),dt=function(){function e(){this.show=!1}return e.prototype.onToggle=function(){this.show=!this.show},i.b([Object(o.E)(),i.d("design:type",String)],e.prototype,"message",void 0),e=i.b([Object(o.n)({selector:"tds-popup-asset-message",template:'\n        <span style="cursor:pointer;" #popUpPolling (click)="onToggle()"><i class="fa  fa-fw fa-question-circle"></i></span>\n        <kendo-popup [anchor]="popUpPolling" [popupClass]="\'content popup\'" *ngIf="show">\n            <div>\n                <label>\n                    {{message}}\n                </label>\n            </div>\n        </kendo-popup>\n\t',styles:["\n\t\tdiv { width: 180px; padding: 10px; }\n    "]})],e)}(),ut=function(){function e(e){this.permissionService=e,this.start=new o.w,this.done=new o.w,this.invoke=new o.w,this.assignToMe=new o.w,this.neighborhood=new o.w,this.hasInvokePermission=!1,this.hasInvokePermission=this.permissionService.hasPermission(D.a.ActionInvoke)}return e.prototype.ngOnInit=function(){console.log("Init")},e.prototype.onStart=function(){this.start.emit()},e.prototype.onDone=function(){this.done.emit()},e.prototype.onNeighborhood=function(){this.neighborhood.emit()},e.prototype.onAssignToMe=function(){this.assignToMe.emit()},e.prototype.onInvoke=function(){this.invoke.emit()},i.b([Object(o.E)(),i.d("design:type",Object)],e.prototype,"options",void 0),i.b([Object(o.Q)(),i.d("design:type",o.w)],e.prototype,"start",void 0),i.b([Object(o.Q)(),i.d("design:type",o.w)],e.prototype,"done",void 0),i.b([Object(o.Q)(),i.d("design:type",o.w)],e.prototype,"invoke",void 0),i.b([Object(o.Q)(),i.d("design:type",o.w)],e.prototype,"assignToMe",void 0),i.b([Object(o.Q)(),i.d("design:type",o.w)],e.prototype,"neighborhood",void 0),e=i.b([Object(o.n)({selector:"tds-task-actions",templateUrl:"../tds/web-app/app-js/modules/taskManager/components/task-actions/task-actions.component.html"}),i.d("design:paramtypes",[w.a])],e)}();s.d(t,"AssetExplorerModule",function(){return pt});var pt=function(){function e(){}return e=i.b([Object(o.J)({imports:[a.b,r.a,n.c,l.a,c.a,d.a,u.a,p.a,h.a,oe],declarations:[X,G,ee,Q,Z,$e,te,ue.a,xe.a,we,at,nt.a,Re,ct.a,rt.a,lt.a,Pe.a,dt,De,We,st,ot,ut],providers:[f.a,E,y,b,A.a,T.a,v.a,ne,re.a,le.a,ce.a,de.a],exports:[ue.a,xe.a,we,nt.a,G,at],entryComponents:[Q,Z,ue.a,xe.a,we,nt.a,Re,rt.a,lt.a,ct.a,Pe.a,De,We,st,ot]})],e)}()},904:function(e,t,s){"use strict";s.d(t,"e",function(){return o}),s.d(t,"d",function(){return a}),s.d(t,"b",function(){return n}),s.d(t,"c",function(){return r});var i=s(28);s.d(t,"a",function(){return i.b});var o=function(){return function(){this.udf=!0,this.imp="N"}}(),a=(function(){}(),function(){function e(){}return e.Y={name:"yellow",color:"#FAFF9B"},e.G={name:"green",color:"#D4F8D4"},e.B={name:"blue",color:"#A9D6F2"},e.P={name:"pink",color:"#FFA5B4"},e.O={name:"orange",color:"#FFC65E"},e.N={name:"normal",color:"#DDDDDD"},e.U={name:"unimportant",color:"#F4F4F4"},e}()),n=["Y","G","P","B","O","N","U"],r="Field Not Found"},906:function(e,t,s){"use strict";s.d(t,"a",function(){return r});var i=s(1),o=s(0),a=s(46),n=s(63),r=function(){function e(e){this.http=e,this.assetUrl="../ws/asset"}return e.prototype.getDependencies=function(e,t){var s=new n.a({"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"}),i=new n.d({headers:s});return this.http.post(this.assetUrl+"/dependencies","assetAId="+e+"&assetBId="+t,i).map(function(e){var t=e.json();return t&&"success"===t.status&&t.data}).catch(function(e){return e.json()})},e=i.b([Object(o.B)(),i.d("design:paramtypes",[a.a])],e)}()},907:function(e,t,s){"use strict";s.d(t,"a",function(){return d});var i=s(1),o=s(0),a=s(15),n=s(28),r=s(916),l=s(36),c=s(921),d=function(){function e(e,t,s,i,o,a,n,r,l){this.model=e,this.activeDialog=t,this.preference=s,this.assetExplorerService=i,this.dialogService=o,this.notifierService=a,this.tagService=n,this.metadata=r,this.promptService=l,this.assetTagsDirty=!1,this.assetTagsModel={tags:[]},this.newAssetTagsSelection={tags:[]},this.tagList=[],this.isDependenciesValidForm=!0,this.defaultSelectOption="Please Select",this.defaultPlanStatus="Unassigned",this.defaultValidation="Unknown",this.isHighField=c.a.isHighField,this.initialModel=null,this.assetTagsModel={tags:r.assetTags},this.tagList=r.tagList,this.dateFormat=this.preference.preferences.CURR_DT_FORMAT,this.dateFormat&&null!==this.dateFormat&&(this.dateFormat=this.dateFormat.toLowerCase().replace(/m/g,"M"))}return e.prototype.ngOnInit=function(){jQuery('[data-toggle="popover"]').popover()},e.prototype.onInitDependenciesDone=function(e){this.initialModel=Object(l.a)(e)},e.prototype.onTagValueChange=function(e){this.newAssetTagsSelection.tags=e.tags,this.assetTagsDirty=!0},e.prototype.createTags=function(e){var t=this,s={tags:[]};this.newAssetTagsSelection.tags&&this.newAssetTagsSelection.tags.length>0&&(s=this.newAssetTagsSelection),this.tagService.createAssetTags(e,s.tags.map(function(e){return e.id})).subscribe(function(s){t.showAssetDetailView(t.model.asset.assetClass.name,e)},function(e){return console.error("Error while saving asset tags",e)})},e.prototype.saveAssetTags=function(){var e=this,t={tags:[]},s=i.a({},this.assetTagsModel);this.newAssetTagsSelection.tags.forEach(function(i){var o=e.assetTagsModel.tags.findIndex(function(e){return e.id===i.id});-1===o?t.tags.push(i):s.tags.splice(o,1)}),!this.assetTagsDirty||0===t.tags.length&&0===s.tags.length?this.showAssetDetailView(this.model.asset.assetClass.name,this.model.assetId):this.tagService.createAndDeleteAssetTags(this.model.assetId,t.tags.map(function(e){return e.id}),s.tags.map(function(e){return e.assetTagId})).subscribe(function(t){e.showAssetDetailView(e.model.asset.assetClass.name,e.model.assetId)},function(e){return console.log("error when saving asset tags",e)})},e.prototype.showAssetDetailView=function(e,t){this.dialogService.replace(r.a,[{provide:"ID",useValue:t},{provide:"ASSET",useValue:e}],n.e.LG)},e.prototype.cancelCloseDialog=function(){this.activeDialog.close()},e.prototype.onDependenciesValidationChange=function(e){this.isDependenciesValidForm=e},e.prototype.promptSaveChanges=function(){var e=this;this.promptService.open("Confirmation Required","You have changes that have not been saved. Do you want to continue and lose those changes?","Confirm","Cancel").then(function(t){t?e.cancelCloseDialog():e.focusAssetModal()})},e.prototype.onCancelEdit=function(){this.assetTagsDirty||!Object(l.c)(this.initialModel,this.model)?this.promptSaveChanges():this.cancelCloseDialog()},e.prototype.submitForm=function(e){this.form.onSubmit(e)||this.focusFirstInvalidFieldInput()},e.prototype.focusFirstInvalidFieldInput=function(){jQuery("form.asset-entry-form .tm-input-control.ng-invalid:first").focus()},e.prototype.deleteAsset=function(e){var t=this;this.promptService.open("Confirmation Required","You are about to delete the selected asset for which there is no undo. Are you sure? Click OK to delete otherwise press Cancel","OK","Cancel").then(function(s){s&&t.assetExplorerService.deleteAssets([e]).subscribe(function(e){e&&(t.notifierService.broadcast({name:"reloadCurrentAssetList"}),t.activeDialog.dismiss())},function(e){return console.log(e)})}).catch(function(e){return console.log(e)})},e.prototype.focusAssetModal=function(){setTimeout(function(){return jQuery(".modal-content").focus()},500)},e.prototype.focusControlByName=function(e){setTimeout(function(){jQuery("form.asset-entry-form .tm-input-control[name='"+e+"']:first").focus()},600)},i.b([Object(o.lb)("form"),i.d("design:type",a.g)],e.prototype,"form",void 0),e}()},908:function(e,t,s){"use strict";s.d(t,"a",function(){return i});var i=function(){return function(){}}()},911:function(e,t,s){"use strict";s.d(t,"a",function(){return p});var i=s(1),o=s(0),a=s(38),n=s(77),r=s(84),l=s(372),c=s(55),d=s(67),u=s(908),p=function(e){function t(t,s,i,o,a,n){var r=e.call(this,"#asset-clone-component")||this;return r.cloneModalModel=t,r.permissionService=s,r.assetExplorerService=i,r.notifierService=o,r.dialogService=a,r.prompt=n,r.ASSET_NAME_POPUP_MESSAGE="Cloned asset will have Environment = 'Select...' and the next available Asset Tag number for device class",r.modalOptions={isResizable:!0,isCentered:!0},r.uniqueAssetName=!1,r}return i.c(t,e),t.prototype.ngOnInit=function(){var e=this;console.log("AssetClone",this.cloneModalModel),this.assetExplorerService.getAsset(this.cloneModalModel.assetId).subscribe(function(t){e.asset=t,e.assetName=t.assetName},function(e){return console.log(e)})},t.prototype.cancelCloseDialog=function(){this.dismiss()},t.prototype.canCloneAssets=function(){return this.permissionService.hasPermission(r.a.AssetCreate)},t.prototype.isAssetUnique=function(){var e=this,t={id:this.cloneModalModel.assetId,name:this.assetName};this.assetExplorerService.checkAssetForUniqueName(t).subscribe(function(t){t&&"success"===t.status&&(e.uniqueAssetName=t.data.unique,e.existAsset=t.data.unique?null:t.data)},function(e){return console.log(e)})},t.prototype.cloneAssetValidations=function(e){var t=this;this.existAsset&&!this.existAsset.unique||!this.uniqueAssetName?this.prompt.open("Asset already exists","The Asset Name you want to create already exists, do you want to proceed?","Confirm","Cancel").then(function(s){s&&t.cloneAsset(e)}).catch(function(e){return console.log(e)}):this.cloneAsset(e)},t.prototype.cloneAsset=function(e){var t=this,s={assetId:this.cloneModalModel.assetId,cloneDependencies:this.includeDependencies.nativeElement.checked,name:this.assetName};this.assetExplorerService.cloneAsset(s).subscribe(function(s){s&&"success"===s.status?t.notifyClone(e,s.data.assetId):console.log("Cannot Clone Asset",s.errors.join())},function(e){return console.log(e)})},t.prototype.showAssetDetailView=function(){var e={clonedAsset:!1,showEditView:!1,assetId:this.existAsset.assetId,showView:!0};this.close(e)},t.prototype.notifyClone=function(e,t){this.notifierService.broadcast({name:"reloadCurrentAssetList"});var s={clonedAsset:!0,showEditView:!1,assetId:null};e&&(s.showEditView=!0,s.assetId=t),this.close(s)},i.b([Object(o.lb)("includeDependencies"),i.d("design:type",o.u)],t.prototype,"includeDependencies",void 0),t=i.b([Object(o.n)({selector:"tds-asset-clone-modal",templateUrl:"../tds/web-app/app-js/modules/assetExplorer/components/asset-clone/asset-clone.component.html"}),i.d("design:paramtypes",[u.a,n.a,l.a,c.a,a.b,d.b])],t)}(a.c)},912:function(e,t,s){"use strict";var i=s(1),o=s(0),a=s(35),n=s(46),r=s(288),l=s(38),c=s(54),d=s(372),u=s(55),p=s(36),h=s(373),m=s(85),f=s(907),g=s(67);var v=s(922);var S=s(305),y=s(209),b=s(286);s.d(t,"a",function(){return T});var T=function(e){function t(t,s,i,o,a,n,r){var l=e.call(this,t,s,i)||this;return l.http=o,l.tagService=a,l.modelId=n,l.asset=r,l}return i.c(t,e),t.prototype.ngAfterViewInit=function(){var e=this;this.prepareMetadata().then(function(t){a.Observable.zip(e.http.get("../ws/asset/editTemplate/"+e.modelId),e.http.get("../ws/asset/editModel/"+e.modelId)).subscribe(function(s){var a=s[0].text(),n=s[1].json();switch(e.asset){case"APPLICATION":e.registerAndCreate(function(e,t,s){return function(a){function n(e,t,i,o,n,r,l,c,d){var u=a.call(this,e,t,i,o,n,r,l,s,c)||this;return u.prompt=d,u.defaultItem={fullName:"Please Select",personId:null},u.addPersonItem={fullName:"Add person",personId:-1},u.yesNoList=["Y","N"],u.personList=null,u.persons={sme:null,sme2:null,appOwner:null},u}return i.c(n,a),n.prototype.ngOnInit=function(){this.initModel(),this.focusControlByName("assetName")},n.prototype.initModel=function(){this.model.asset=p.a(t.asset),this.model.asset.sme=this.model.asset.sme||{id:null},this.model.asset.sme2=this.model.asset.sme2||{id:null},this.model.asset.shutdownBy={id:this.model.asset.shutdownBy||null},this.model.asset.startupBy={id:this.model.asset.startupBy||null},this.model.asset.testingBy={id:this.model.asset.testingBy||null},this.model.asset.appOwner=this.model.asset.appOwner||{id:null},null===this.model.asset.scale&&(this.model.asset.scale={name:{value:"",text:""}}),this.updatePersonReferences()},n.prototype.shufflePerson=function(e,t){var s=this.model.asset&&this.model.asset[e]&&this.model.asset[e].id||null,i=this.model.asset&&this.model.asset[t]&&this.model.asset[t].id||null;this.model.asset[e].id=i,this.model.asset[t].id=s,this.updatePersonReferences()},n.prototype.onUpdate=function(){var e=this,t=p.a(this.model);t.asset.moveBundleId=t.asset.moveBundle.id,delete t.asset.moveBundle,t.asset.scale=t.asset.scale&&t.asset.scale.name&&t.asset.scale.name.value||"",t.asset.shutdownBy=t.asset.shutdownBy&&t.asset.shutdownBy.id||"",t.asset.startupBy=t.asset.startupBy&&t.asset.startupBy.id||"",t.asset.testingBy=t.asset.testingBy&&t.asset.testingBy.id||"",t.asset.environment=t.asset.environment===this.defaultSelectOption?"":t.asset.environment,t.asset.criticality=t.asset.criticality===this.defaultSelectOption?"":t.asset.criticality,this.model.customs.forEach(function(e){var s=t.asset[e.field.toString()];s&&s.value&&(t.asset[e.field.toString()]=s.value)}),this.assetExplorerService.saveAsset(t).subscribe(function(t){e.notifierService.broadcast({name:"reloadCurrentAssetList"}),t!==m.a.API_SUCCESS&&"Success!"!==t||e.saveAssetTags()})},n.prototype.onAddPerson=function(e,t,s,i,o,a){var n=this;if(e.personId===this.addPersonItem.personId){var r=new y.a;r.asset=t,r.fieldName=s,r.companies=i||[],r.teams=o,r.staffType=a||[],this.dialogService.extra(S.a,[l.b,{provide:y.a,useValue:r},b.a],!1,!0).then(function(e){n.personList.push({personId:e.id,fullName:e.name}),n.model.asset[s].id=e.id,n.updatePersonReferences()}).catch(function(e){n.persons[s]={personId:n.model.asset[s].id}})}else this.model.asset[s].id=e.personId},n.prototype.getPersonList=function(e){return this.personList||(this.personList=e,this.personList.unshift(this.addPersonItem)),this.personList},n.prototype.updatePersonReferences=function(){this.persons.sme={personId:this.model.asset.sme.id},this.persons.sme2={personId:this.model.asset.sme2.id},this.persons.appOwner={personId:this.model.asset.appOwner.id}},n.prototype.onDeleteAsset=function(){this.deleteAsset(this.model.asset.id)},n=i.b([Object(o.n)({selector:"tds-application-edit",template:e,providers:[{provide:"model",useValue:t}]}),i.e(0,Object(o.A)("model")),i.d("design:paramtypes",[Object,l.a,c.c,d.a,l.b,u.a,h.a,g.b,g.b])],n)}(f.a)}(a,n,t),e.view);break;case"DATABASE":e.registerAndCreate(function(e,t,s){return function(a){function n(e,t,i,o,n,r,l,c){return a.call(this,e,t,i,o,n,r,l,s,c)||this}return i.c(n,a),n.prototype.ngOnInit=function(){this.model.asset=p.a(t.asset),this.model.asset.scale&&this.model.asset.scale.name&&(this.model.asset.scale={value:this.model.asset.scale.name,text:""}),this.model.asset.environment=this.model.asset.environment||"",this.focusControlByName("assetName")},n.prototype.onUpdate=function(){var e=this,t=p.a(this.model);t.asset.scale=t.asset.scale&&t.asset.scale.value?t.asset.scale.value:t.asset.scale,this.model.customs.forEach(function(e){var s=t.asset[e.field.toString()];s&&s.value&&(t.asset[e.field.toString()]=s.value)}),t.asset.moveBundleId=t.asset.moveBundle.id,delete t.asset.moveBundle,t.asset.environment=t.asset.environment===this.defaultSelectOption?"":t.asset.environment,this.assetExplorerService.saveAsset(t).subscribe(function(t){e.notifierService.broadcast({name:"reloadCurrentAssetList"}),t!==m.a.API_SUCCESS&&"Success!"!==t||e.saveAssetTags()})},n.prototype.onDeleteAsset=function(){this.deleteAsset(this.model.asset.id)},n=i.b([Object(o.n)({selector:"tds-database-edit",template:e,providers:[{provide:"model",useValue:t}]}),i.e(0,Object(o.A)("model")),i.d("design:paramtypes",[Object,l.a,c.c,d.a,l.b,u.a,h.a,g.b])],n)}(f.a)}(a,n,t),e.view);break;case"DEVICE":e.registerAndCreate(function(e,t,s){return function(a){function n(e,t,i,o,n,r,l,c){return a.call(this,e,t,i,o,n,r,l,s,c)||this}return i.c(n,a),n.prototype.ngOnInit=function(){this.initModel(),this.toggleAssetTypeFields(),this.focusControlByName("assetName")},n.prototype.initModel=function(){this.model.asset=p.a(t.asset),this.model.sourceRoomSelect=[this.defaultRoom].concat(this.model.sourceRoomSelect),this.model.targetRoomSelect=[this.defaultRoom].concat(this.model.targetRoomSelect),this.model.asset.priority=(this.model.asset.priority||"").toString(),this.model.asset.scale&&this.model.asset.scale.name&&(this.model.asset.scale={value:this.model.asset.scale.name,text:""}),this.model.asset.assetTypeSelectValue={id:null},this.model.asset.assetType&&(this.model.asset.assetTypeSelectValue.id=this.model.asset.assetType,this.model.asset.assetTypeSelectValue.text=this.model.asset.assetType),this.model.asset.manufacturerSelectValue={id:null},this.model.asset.manufacturer&&(this.model.asset.manufacturerSelectValue.id=this.model.asset.manufacturer.id,this.model.asset.manufacturerSelectValue.text=this.model.manufacturerName),this.model.asset.modelSelectValue={id:null},this.model.asset.model&&(this.model.asset.modelSelectValue.id=this.model.asset.model.id,this.model.asset.modelSelectValue.text=this.model.modelName),this.model.sourceRackSelect&&(this.rackSourceOptions=[this.defaultRoom].concat(this.model.sourceRackSelect)),this.model.targetRackSelect&&(this.rackTargetOptions=[this.defaultRoom].concat(this.model.targetRackSelect)),this.model.sourceChassisSelect&&(this.bladeSourceOptions=[this.defaultRoom].concat(this.model.sourceChassisSelect)),this.model.targetChassisSelect&&(this.bladeTargetOptions=[this.defaultRoom,this.model.targetChassisSelect]),this.model.asset.roomSource=this.model.asset.roomSource||this.defaultRoom,this.model.asset.roomTarget=this.model.asset.roomTarget||this.defaultRoom,this.model.asset.rackSource=this.model.asset.rackSource||this.defaultRoom,this.model.asset.rackTarget=this.model.asset.rackTarget||this.defaultRoom,this.model.asset.sourceChassis=this.model.asset.sourceChassis||this.defaultRoom,this.model.asset.targetChassis=this.model.asset.targetChassis||this.defaultRoom,this.model.asset.scale=this.model.asset.scale||null},n.prototype.onUpdate=function(){var e=this,t=p.a(this.model);this.prepareModelRequestToSave(t),t.asset.moveBundleId=t.asset.moveBundle.id,delete t.asset.moveBundle,this.model.customs.forEach(function(e){var s=t.asset[e.field.toString()];s&&s.value&&(t.asset[e.field.toString()]=s.value)}),this.assetExplorerService.saveAsset(t).subscribe(function(t){e.notifierService.broadcast({name:"reloadCurrentAssetList"}),t!==m.a.API_SUCCESS&&"Success!"!==t||e.saveAssetTags()})},n.prototype.onDeleteAsset=function(){this.deleteAsset(this.model.asset.id)},n=i.b([Object(o.n)({selector:"tds-device-edit",template:e,providers:[{provide:"model",useValue:t}]}),i.e(0,Object(o.A)("model")),i.d("design:paramtypes",[Object,l.a,c.c,d.a,l.b,u.a,h.a,g.b])],n)}(v.a)}(a,n,t),e.view);break;case"STORAGE":e.registerAndCreate(function(e,t,s){return function(a){function n(e,t,i,o,n,r,l,c){return a.call(this,e,t,i,o,n,r,l,s,c)||this}return i.c(n,a),n.prototype.ngOnInit=function(){this.initModel(),this.focusControlByName("assetName")},n.prototype.initModel=function(){this.model.asset.scale&&this.model.asset.scale.name&&(this.model.asset.scale={value:this.model.asset.scale.name,text:""}),this.model.asset.environment=this.model.asset.environment||""},n.prototype.onUpdate=function(){var e=this,t=p.a(this.model);t.asset.scale=t.asset.scale&&t.asset.scale.value?t.asset.scale.value:t.asset.scale,this.model.customs.forEach(function(e){var s=t.asset[e.field.toString()];s&&s.value&&(t.asset[e.field.toString()]=s.value)}),t.asset.moveBundleId=t.asset.moveBundle.id,delete t.asset.moveBundle,this.assetExplorerService.saveAsset(t).subscribe(function(t){e.notifierService.broadcast({name:"reloadCurrentAssetList"}),t!==m.a.API_SUCCESS&&"Success!"!==t||e.saveAssetTags()})},n.prototype.onDeleteAsset=function(){this.deleteAsset(this.model.asset.id)},n=i.b([Object(o.n)({selector:"tds-storage-edit",template:e,providers:[{provide:"model",useValue:t}]}),i.e(0,Object(o.A)("model")),i.d("design:paramtypes",[Object,l.a,c.c,d.a,l.b,u.a,h.a,g.b])],n)}(f.a)}(a,n,t),e.view)}})})},t.prototype.prepareMetadata=function(){var e={},t=[];return t.push(this.getAssetTags(e)),t.push(this.getTagList(e)),new Promise(function(s,i){Promise.all(t).then(function(){s(e)})})},t.prototype.getAssetTags=function(e){var t=this;return new Promise(function(s,i){t.tagService.getAssetTags(t.modelId).subscribe(function(i){i.status===m.a.API_SUCCESS?e.assetTags=i.data:(e.assetTags=[],t.handleError(i.errors?i.errors[0]:"Error on tags by asset id call")),s(e)},function(i){s(e),t.handleError(i)})})},t.prototype.getTagList=function(e){var t=this;return new Promise(function(s,i){t.tagService.getTags().subscribe(function(i){i.status===m.a.API_SUCCESS?e.tagList=i.data:(e.tagList=[],t.handleError(i.errors?i.errors[0]:"Error on get tag list call")),s(e)},function(i){s(e),t.handleError(i)})})},t.prototype.handleError=function(e){console.log(e)},i.b([Object(o.lb)("view",{read:o.nb}),i.d("design:type",o.nb)],t.prototype,"view",void 0),t=i.b([Object(o.n)({selector:"tds-asset-all-edit",template:"<div #view></div>"}),i.e(5,Object(o.A)("ID")),i.e(6,Object(o.A)("ASSET")),i.d("design:paramtypes",[o.D,o.l,o.M,n.a,h.a,Number,String])],t)}(r.a)},914:function(e,t,s){"use strict";s.d(t,"a",function(){return c});var i=s(1),o=s(0),a=s(65),n=s(373),r=s(85),l=s(35),c=function(){function e(e,t){this.tagService=e,this.router=t}return e.prototype.resolve=function(e){var t=this;return this.tagService.getTags().map(function(e){return e.status===r.a.API_SUCCESS&&e.data?e.data:[]}).catch(function(e){return console.error("TagsResolveService:","An Error Occurred trying to fetch all Tags"),t.router.navigate(["/security/error"]),l.Observable.of(!1)})},e=i.b([Object(o.B)(),i.d("design:paramtypes",[n.a,a.c])],e)}()},916:function(e,t,s){"use strict";var i=s(1),o=s(0),a=s(46),n=s(288),r=s(38),l=s(912),c=s(906),d=s(28),u=s(67),p=s(372),h=s(55),m=s(908),f=s(911),g=s(918),v=s(921),S=function(){function e(e,t,s,i,o,a,n){this.activeDialog=e,this.dialogService=t,this.assetService=s,this.prompt=i,this.assetExplorerService=o,this.notifierService=a,this.preferenceService=n,this.isHighField=v.a.isHighField,jQuery('[data-toggle="popover"]').popover(),this.userDateFormat=this.preferenceService.getUserDateFormatForMomentJS(),this.userTimeZone=this.preferenceService.getUserTimeZone()}return e.prototype.handleKeyboardEvent=function(e){e&&e.code===d.p.ESCAPE&&this.cancelCloseDialog()},e.prototype.ngOnInit=function(){jQuery('[data-toggle="popover"]').popover()},e.prototype.cancelCloseDialog=function(){this.activeDialog.dismiss()},e.prototype.showAssetDetailView=function(e,t){this.dialogService.replace(O,[{provide:"ID",useValue:t},{provide:"ASSET",useValue:e}],d.e.LG)},e.prototype.showDependencyView=function(e,t){var s=this;this.assetService.getDependencies(e,t).subscribe(function(e){s.dialogService.extra(g.a,[{provide:"ASSET_DEP_MODEL",useValue:e}]).then(function(e){return console.log(e)}).catch(function(e){return console.log(e)})},function(e){return console.log(e)})},e.prototype.onDeleteAsset=function(){var e=this;this.prompt.open("Confirmation Required","You are about to delete the selected asset for which there is no undo. Are you sure? Click OK to delete otherwise press Cancel","OK","Cancel").then(function(t){t&&e.assetExplorerService.deleteAssets([e.mainAsset.toString()]).subscribe(function(t){t&&(e.notifierService.broadcast({name:"reloadCurrentAssetList"}),e.activeDialog.dismiss())},function(e){return console.log(e)})}).catch(function(e){return console.log(e)})},e.prototype.getGraphUrl=function(){return"/tdstm/assetEntity/architectureViewer?assetId="+this.mainAsset+"&level=2"},i.b([Object(o.z)("keydown",["$event"]),i.d("design:type",Function),i.d("design:paramtypes",[KeyboardEvent]),i.d("design:returntype",void 0)],e.prototype,"handleKeyboardEvent",null),e}(),y=s(54);var b=s(923),T=s(919),E=s(924),A=s(925),C=s(920),k=s(376);var w=s(382),I=s(373),D=s(85);s.d(t,"a",function(){return O});var O=function(e){function t(t,s,i,o,a,n,r){var l=e.call(this,t,s,i)||this;return l.http=o,l.tagService=a,l.modelId=n,l.asset=r,l}return i.c(t,e),t.prototype.ngAfterViewInit=function(){var e=this;this.prepareMetadata().then(function(t){e.http.get("../ws/asset/showTemplate/"+e.modelId).subscribe(function(s){var a=s.text(),n=[w.AssetExplorerModule];switch(e.asset){case"APPLICATION":e.registerAndCreate(function(e,t,s){return function(a){function n(e,i,o,n,r,l,c){var d=a.call(this,e,i,o,n,r,l,c)||this;return d.mainAsset=t,d.assetTags=s.assetTags,d}return i.c(n,a),n.prototype.showAssetEditView=function(){var e=[{provide:"ID",useValue:this.mainAsset},{provide:"ASSET",useValue:d.f.APPLICATION}];return this.dialogService.replace(l.a,e,d.e.LG)},n.prototype.onCloneAsset=function(){var e=this,t={assetType:d.f.APPLICATION,assetId:this.mainAsset};this.dialogService.extra(f.a,[{provide:m.a,useValue:t}],!1,!1).then(function(t){if(t.clonedAsset&&t.showEditView){var s=[{provide:"ID",useValue:t.assetId},{provide:"ASSET",useValue:d.f.APPLICATION}];e.dialogService.replace(l.a,s,d.e.XLG)}else!t.clonedAsset&&t.showView&&e.showAssetDetailView(d.f.APPLICATION,t.assetId)}).catch(function(e){return console.log("error",e)})},n=i.b([Object(o.n)({selector:"tds-application-show",template:e}),i.d("design:paramtypes",[r.a,r.b,c.a,u.b,p.a,h.a,y.c])],n)}(S)}(a,e.modelId,t),e.view,n);break;case"DATABASE":e.registerAndCreate(function(e,t,s){return function(a){function n(e,i,o,n,r,l,c){var d=a.call(this,e,i,o,n,r,l,c)||this;return d.mainAsset=t,d.assetTags=s.assetTags,d}return i.c(n,a),n.prototype.showAssetEditView=function(){this.dialogService.replace(l.a,[{provide:"ID",useValue:this.mainAsset},{provide:"ASSET",useValue:d.f.DATABASE}],d.e.LG)},n.prototype.onCloneAsset=function(){var e=this,t={assetType:d.f.DATABASE,assetId:this.mainAsset};this.dialogService.extra(f.a,[{provide:m.a,useValue:t}],!1,!1).then(function(t){if(t.clonedAsset&&t.showEditView){var s=[{provide:"ID",useValue:t.assetId},{provide:"ASSET",useValue:d.f.DATABASE}];e.dialogService.replace(l.a,s,d.e.XLG)}else!t.clonedAsset&&t.showView&&e.showAssetDetailView(d.f.DATABASE,t.assetId)}).catch(function(e){return console.log("error",e)})},n=i.b([Object(o.n)({selector:"tds-database-show",template:e}),i.d("design:paramtypes",[r.a,r.b,c.a,u.b,p.a,h.a,y.c])],n)}(S)}(a,e.modelId,t),e.view,n);break;case"DEVICE":e.registerAndCreate(function(e,t,s){return function(a){function n(e,i,o,n,r,l,c,d,u){var p=a.call(this,e,i,o,l,c,d,u)||this;return p.modelService=n,p.manufacturerService=r,p.mainAsset=t,p.assetTags=s.assetTags,p.manufacturerName=null,p}return i.c(n,a),n.prototype.getManufacturer=function(e){return null===this.manufacturerName&&(this.manufacturerName=e),this.manufacturerName},n.prototype.showModel=function(e){var t=this;this.modelService.getModelAsJSON(e).subscribe(function(e){t.dialogService.extra(E.a,[r.b,{provide:b.a,useValue:e}],!1,!1).then(function(e){console.log(e)}).catch(function(e){return console.log(e)})})},n.prototype.showManufacturer=function(e){var t=this;this.manufacturerService.getDeviceManufacturer(e).subscribe(function(e){t.dialogService.extra(A.a,[r.b,{provide:T.a,useValue:e}],!1,!1).then(function(e){e&&(t.manufacturerName=e.name)}).catch(function(e){return console.log(e)})})},n.prototype.showAssetEditView=function(){this.dialogService.replace(l.a,[{provide:"ID",useValue:this.mainAsset},{provide:"ASSET",useValue:d.f.DEVICE}],d.e.LG)},n.prototype.onCloneAsset=function(){var e=this,t={assetType:d.f.DEVICE,assetId:this.mainAsset};this.dialogService.extra(f.a,[{provide:m.a,useValue:t}],!1,!1).then(function(t){if(t.clonedAsset&&t.showEditView){var s=[{provide:"ID",useValue:t.assetId},{provide:"ASSET",useValue:d.f.DEVICE}];e.dialogService.replace(l.a,s,d.e.XLG)}else!t.clonedAsset&&t.showView&&e.showAssetDetailView(d.f.DEVICE,t.assetId)}).catch(function(e){return console.log("error",e)})},n=i.b([Object(o.n)({selector:"tds-device-show",template:e}),i.d("design:paramtypes",[r.a,r.b,c.a,C.a,k.a,u.b,p.a,h.a,y.c])],n)}(S)}(a,e.modelId,t),e.view,n);break;case"STORAGE":e.registerAndCreate(function(e,t,s){return function(a){function n(e,i,o,n,r,l,c){var d=a.call(this,e,i,o,n,r,l,c)||this;return d.mainAsset=t,d.assetTags=s.assetTags,d}return i.c(n,a),n.prototype.showAssetEditView=function(){var e=[{provide:"ID",useValue:this.mainAsset},{provide:"ASSET",useValue:d.f.STORAGE}];return this.dialogService.replace(l.a,e,d.e.LG)},n.prototype.onCloneAsset=function(){var e=this,t={assetType:d.f.STORAGE,assetId:this.mainAsset};this.dialogService.extra(f.a,[{provide:m.a,useValue:t}],!1,!1).then(function(t){if(t.clonedAsset&&t.showEditView){var s=[{provide:"ID",useValue:t.assetId},{provide:"ASSET",useValue:d.f.STORAGE}];e.dialogService.replace(l.a,s,d.e.XLG)}else!t.clonedAsset&&t.showView&&e.showAssetDetailView(d.f.STORAGE,t.assetId)}).catch(function(e){return console.log("error",e)})},n=i.b([Object(o.n)({selector:"tds-storage-show",template:e}),i.d("design:paramtypes",[r.a,r.b,c.a,u.b,p.a,h.a,y.c])],n)}(S)}(a,e.modelId,t),e.view,n)}})})},t.prototype.prepareMetadata=function(){var e=this,t={};return new Promise(function(s,i){e.tagService.getAssetTags(e.modelId).subscribe(function(i){i.status===D.a.API_SUCCESS?t.assetTags=i.data:(t.assetTags=[],e.handleError(i.errors?i.errors[0]:"Error on tags by asset id call")),s(t)},function(i){s(t),e.handleError(i)})})},t.prototype.handleError=function(e){console.log(e)},i.b([Object(o.lb)("view",{read:o.nb}),i.d("design:type",o.nb)],t.prototype,"view",void 0),t=i.b([Object(o.n)({selector:"tds-asset-all-show",template:"<div #view></div>"}),i.e(5,Object(o.A)("ID")),i.e(6,Object(o.A)("ASSET")),i.d("design:paramtypes",[o.D,o.l,o.M,a.a,I.a,Number,String])],t)}(n.a)},918:function(e,t,s){"use strict";s.d(t,"a",function(){return r});var i=s(1),o=s(0),a=s(38),n=s(906),r=function(e){function t(t,s){var i=e.call(this,"#assetDependency")||this;return i.assetDependency=t,i.assetService=s,i.dependencyA=t.assetA&&t.assetA.dependency||null,i.dependencyB=t.assetB&&t.assetB.dependency||null,i.dependencyA=i.getDependencyWithDates(i.dependencyA,t.assetA),i.dependencyB=i.getDependencyWithDates(i.dependencyB,t.assetB),i}return i.c(t,e),t.prototype.getDependencyWithDates=function(e,t){if(!t||!e)return e;var s=t.dateCreated,i=t.lastUpdated;return Object.assign({},e,{dateCreated:s,lastUpdated:i})},t.prototype.cancelCloseDialog=function(){this.dismiss()},t=i.b([Object(o.n)({selector:"asset-dependency",templateUrl:"../tds/web-app/app-js/modules/assetExplorer/components/asset-dependency/asset-dependency.component.html",styles:["\n        table {\n            margin-top: 10px;\n        }\n\n        .modal-body th {\n            background: white !important;\n        }\n\n        .modal-body {\n            padding-left: 10px;\n            padding-right: 10px;\n        }\n\n        .modal-body table {\n            border-spacing: inherit !important;\n        }\n\n        .modal-body table tr th,\n        .modal-body table tr td {\n            border-top: 0px !important;\n        }\n\n        td.lbl-asset-dependency-direction,\n        form.dependency-edit-fields td.legend-fields {\n            font-weight: bold;\n            color: green;\n            font: 12px helvetica, arial, sans-serif !important;\n        }\n\n        form.dependency-edit-fields table {\n            border: 0px;\n        }\n\n        form.dependency-edit-fields div.form-group {\n            height: 24px;\n            font: 12px helvetica, arial, sans-serif !important;\n        }\n\n        form.dependency-edit-fields label.control-label {\n            text-align: left;\n            font-weight: inherit;\n        }\n\n        form.dependency-edit-fields label.control-label-title {\n            font-weight: bold;\n        }\n\n        .btn-default {\n            background-color: #f4f4f4;\n            color: #444;\n            border-color: #ddd;\n        }\n\n        .delete-property {\n            text-decoration: line-through;\n        }\n\n        .half-size {\n            width: 60%;\n        }\n\n        .separator-table {\n            border-top: 2px solid #f4f4f4 !important;\n            margin-top: 10px !important;\n        }\n\n        .modal-body select,\n        .modal-body input.form-control {\n            width: 150px;\n        }"]}),i.e(0,Object(o.A)("ASSET_DEP_MODEL")),i.d("design:paramtypes",[Object,n.a])],t)}(a.c)},919:function(e,t,s){"use strict";s.d(t,"a",function(){return i});var i=function(){return function(){}}()},920:function(e,t,s){"use strict";s.d(t,"a",function(){return r});var i=s(1),o=s(0),a=s(46),n=s(77),r=(s(148),s(147),function(){function e(e,t){this.http=e,this.permissionService=t,this.modelUrl="/tdstm/model"}return e.prototype.getModelAsJSON=function(e){var t=this.modelUrl+"/retrieveModelAsJSON?id="+e;return this.http.post(t,"").map(function(e){return e.json()}).catch(function(e){return e.json()})},e=i.b([Object(o.B)(),i.d("design:paramtypes",[a.a,n.a])],e)}())},921:function(e,t,s){"use strict";s.d(t,"a",function(){return i});var i=function(){function e(){}return e.isHighField=function(e,t){return-1!=="YG".indexOf(e.toUpperCase())&&!1===Boolean(t)},e}()},922:function(e,t,s){"use strict";s.d(t,"a",function(){return o});var i=s(1),o=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.showRackFields=!0,t.showRackSourceInput="none",t.showRackTargetInput="none",t.rackSourceOptions=[],t.rackTargetOptions=[],t.showBladeFields=!0,t.showBladeSourceInput="none",t.showBladeTargetInput="none",t.bladeSourceOptions=[],t.bladeTargetOptions=[],t.SET_TO_NULL="0",t.CREATE_NEW="-1",t.defaultRoom={id:null,value:"Please Select"},t.searchAssetTypes=function(e){return e.query="manufacturerId="+(t.model.asset.manufacturerSelectValue.id?t.model.asset.manufacturerSelectValue.id:""),t.assetExplorerService.getAssetTypesForComboBox(e)},t.searchManufacturers=function(e){return e.query="assetType="+(t.model.asset.assetTypeSelectValue.id?t.model.asset.assetTypeSelectValue.id:""),t.assetExplorerService.getManufacturersForComboBox(e)},t.searchModels=function(e){return e.query="manufacturerId="+(t.model.asset.manufacturerSelectValue.id?t.model.asset.manufacturerSelectValue.id:"")+"\n\t\t\t&assetType="+(t.model.asset.assetTypeSelectValue.id?t.model.asset.assetTypeSelectValue.id:""),t.assetExplorerService.getModelsForComboBox(e)},t}return i.c(t,e),t.prototype.prepareModelRequestToSave=function(e){e.asset.manufacturerId=null,this.model.asset.manufacturerSelectValue.id>0&&(e.asset.manufacturerId=this.model.asset.manufacturerSelectValue.id.toString()),e.asset.currentAssetType=null,this.model.asset.assetTypeSelectValue.id&&(e.asset.currentAssetType=this.model.asset.assetTypeSelectValue.id.toString()),e.asset.modelId=null,this.model.asset.modelSelectValue.id>0&&(e.asset.modelId=this.model.asset.modelSelectValue.id.toString()),e.asset.roomSourceId=this.SET_TO_NULL,this.model.asset.roomSource&&this.model.asset.roomSource.id>0&&(e.asset.roomSourceId=this.model.asset.roomSource.id.toString()),e.asset.roomSource=this.model.asset.newRoomSource,this.model.asset.newRoomSource&&(e.asset.roomSourceId=this.CREATE_NEW),delete e.asset.newRoomSource,e.asset.roomTargetId=this.SET_TO_NULL,this.model.asset.roomTarget&&this.model.asset.roomTarget.id>0&&(e.asset.roomTargetId=this.model.asset.roomTarget.id.toString()),e.asset.roomTarget=this.model.asset.newRoomTarget,this.model.asset.newRoomTarget&&(e.asset.roomTargetId=this.CREATE_NEW),delete e.asset.newRoomTarget,e.asset.rackSourceId=this.SET_TO_NULL,this.model.asset.rackSource&&this.model.asset.rackSource.id>0&&(e.asset.rackSourceId=this.model.asset.rackSource.id.toString()),e.asset.rackSource=this.model.asset.newRackSource,this.model.asset.newRackSource&&(e.asset.rackSourceId=this.CREATE_NEW),delete e.asset.newRackSource,e.asset.rackTargetId=this.SET_TO_NULL,this.model.asset.rackTarget&&this.model.asset.rackTarget.id>0&&(e.asset.rackTargetId=this.model.asset.rackTarget.id.toString()),e.asset.rackTarget=this.model.asset.newRackTarget,this.model.asset.newRackTarget&&(e.asset.rackTargetId=this.CREATE_NEW),delete e.asset.newRackTarget,this.model.asset.sourceChassis&&this.model.asset.sourceChassis.id>0?e.asset.sourceChassis=this.model.asset.sourceChassis.id.toString():e.asset.sourceChassis=this.SET_TO_NULL,this.model.asset.targetChassis&&this.model.asset.targetChassis.id>0?e.asset.targetChassis=this.model.asset.targetChassis.id.toString():e.asset.targetChassis=this.SET_TO_NULL,e.asset.scale=e.asset.scale&&e.asset.scale.value?e.asset.scale.value:e.asset.scale},t.prototype.toggleAssetTypeFields=function(){switch(this.model.asset.assetTypeSelectValue.id){case"Blade":this.showHideRackFields(!1),this.showHideBladeFields(!0);break;case"VM":this.showHideRackFields(!1),this.showHideBladeFields(!1);break;default:this.showHideRackFields(!0),this.showHideBladeFields(!1)}},t.prototype.showHideRackFields=function(e){this.showRackFields=e,e?this.populateRackSelect():(this.showRackSourceInput="none",this.showRackTargetInput="none")},t.prototype.populateRackSelect=function(){var e=this,t=this.model.asset.roomSource?this.model.asset.roomSource.id:null;t&&t>0?(this.showRackSourceInput="select",this.assetExplorerService.getRacksForRoom(t,"S").subscribe(function(t){e.rackSourceOptions=t.data})):this.showRackSourceInput=t&&-1===t?"new":"none";var s=this.model.asset.roomTarget?this.model.asset.roomTarget.id:null;s&&s>0?(this.showRackTargetInput="select",this.assetExplorerService.getRacksForRoom(s,"T").subscribe(function(t){e.rackTargetOptions=t.data})):this.showRackTargetInput=s&&-1===s?"new":"none"},t.prototype.showHideBladeFields=function(e){this.showBladeFields=e,e?this.populateBladeSelect():(this.showBladeSourceInput="none",this.showBladeTargetInput="none")},t.prototype.populateBladeSelect=function(){var e=this,t=this.model.asset.roomSource?this.model.asset.roomSource.id:null;t&&t>0?(this.showBladeSourceInput="select",this.assetExplorerService.getChassisForRoom(t).subscribe(function(t){e.bladeSourceOptions=t.data})):this.showBladeSourceInput="none";var s=this.model.asset.roomTarget?this.model.asset.roomTarget.id:null;s&&s>0?(this.showBladeTargetInput="select",this.assetExplorerService.getChassisForRoom(s).subscribe(function(t){e.bladeTargetOptions=t.data})):this.showBladeTargetInput="none"},t.prototype.onAssetTypeValueChange=function(e){e||(e={id:null}),this.model.asset.assetTypeSelectValue=e,this.model.asset.modelSelectValue={id:null},this.toggleAssetTypeFields()},t.prototype.onManufacturerValueChange=function(e){e||(e={id:null}),this.model.asset.manufacturerSelectValue=e,this.model.asset.modelSelectValue={id:null}},t.prototype.onModelValueChange=function(e){this.model.asset.assetTypeSelectValue.id=e.assetType,this.model.asset.manufacturerSelectValue.id=e.manufacturerId,this.model.asset.modelSelectValue.id=e.id,this.model.asset.modelSelectValue.text=e.text,this.toggleAssetTypeFields()},t.prototype.onRoomSourceValueChange=function(e){this.toggleAssetTypeFields()},t.prototype.onRoomTargetValueChange=function(e){this.toggleAssetTypeFields()},t}(s(907).a)},923:function(e,t,s){"use strict";s.d(t,"a",function(){return i});var i=function(){return function(){}}()},924:function(e,t,s){"use strict";s.d(t,"a",function(){return d});var i=s(1),o=s(0),a=s(38),n=s(923),r=s(372),l=s(84),c=s(77),d=function(e){function t(t,s,i,o){var a=e.call(this,"#model-device-show-component")||this;return a.dialogService=t,a.deviceModel=s,a.assetExplorerService=i,a.permissionService=o,a}return i.c(t,e),t.prototype.cancelCloseDialog=function(){this.dismiss()},t.prototype.onEscKeyPressed=function(){this.cancelCloseDialog()},t.prototype.onUpdateComment=function(){console.log("Updating component")},t.prototype.canEditModel=function(){return this.permissionService.hasPermission(l.a.ModelEdit)},t.prototype.onEditModel=function(){this.canEditModel()&&(document.getElementById("editModelForm").submit(),this.close())},t=i.b([Object(o.n)({selector:"model-device-show",templateUrl:"../tds/web-app/app-js/modules/assetExplorer/components/device/model-device/components/model-device-show/model-device-show.component.html"}),i.d("design:paramtypes",[a.b,n.a,r.a,c.a])],t)}(a.c)},925:function(e,t,s){"use strict";s.d(t,"a",function(){return d});var i=s(1),o=s(0),a=s(38),n=s(919),r=s(926),l=s(77),c=s(84),d=function(e){function t(t,s,i){var o=e.call(this,"#device-manufacturer-component")||this;return o.dialogService=t,o.deviceManufacturer=s,o.permissionService=i,o}return i.c(t,e),t.prototype.cancelCloseDialog=function(){this.dismiss()},t.prototype.onEscKeyPressed=function(){this.cancelCloseDialog()},t.prototype.canEditManufacturer=function(){return this.permissionService.hasPermission(c.a.ManufacturerEdit)},t.prototype.onEditManufacturer=function(){var e=this;this.canEditManufacturer()&&this.dialogService.extra(r.a,[{provide:n.a,useValue:this.deviceManufacturer}],!1,!1).then(function(t){e.close(t)}).catch(function(e){return console.log(e)})},t=i.b([Object(o.n)({selector:"device-manufacturer",templateUrl:"../tds/web-app/app-js/modules/assetExplorer/components/device/manufacturer/components/manufacturer-show/manufacturer-show.component.html"}),i.d("design:paramtypes",[a.b,n.a,l.a])],t)}(a.c)},926:function(e,t,s){"use strict";s.d(t,"a",function(){return c});var i=s(1),o=s(0),a=s(38),n=s(67),r=s(919),l=s(376),c=function(e){function t(t,s,i){var o=e.call(this,"#device-manufacturer-edit-component")||this;return o.deviceManufacturer=t,o.manufacturerService=s,o.prompt=i,o.isEditing=!1,o.hasAkaValidationErrors=!1,o}return i.c(t,e),t.prototype.cancelCloseDialog=function(){this.close(null)},t.prototype.onEscKeyPressed=function(){this.close(null)},t.prototype.onUpdateManufacturer=function(){var e=this;this.isEditing=!1,this.manufacturerService.updateManufacturer(this.deviceManufacturer,!1).subscribe(function(t){e.close(e.deviceManufacturer)},function(e){alert(e.message||e)})},t.prototype.onAkaChange=function(e){this.deviceManufacturer.akaChanges&&(this.isEditing=!0),this.deviceManufacturer.akaChanges=e},t.prototype.onChange=function(e){this.isEditing=!0},t.prototype.onDeleteManufacturer=function(){var e=this;this.prompt.open("Confirmation Required","Are you sure?","Ok","Cancel").then(function(t){t?e.manufacturerService.updateManufacturer(e.deviceManufacturer,!0).subscribe(function(t){e.deviceManufacturer.name="",e.close(e.deviceManufacturer)},function(e){alert(e.message||e)}):console.log("canceling...")})},t.prototype.onValidationErrors=function(e){this.hasAkaValidationErrors=e},t=i.b([Object(o.n)({selector:"device-manufacturer-edit",templateUrl:"../tds/web-app/app-js/modules/assetExplorer/components/device/manufacturer/components/manufacturer-edit/manufacturer-edit.component.html"}),i.d("design:paramtypes",[r.a,l.a,n.b])],t)}(a.c)}}]);