(window.webpackJsonp=window.webpackJsonp||[]).push([[6],{1131:function(e,t,r){"use strict";r.r(t);var i=r(1),o=r(0),a=r(10),n=r(15),s=r(200),d=r(1114),c=r(1129),l=r(1115),p=r(65),u=r(269),h=r(270),g=r(38),f=r(77),m=r(67),S=r(54),v=r(271),T=r(373),E=r(380),y=function(){return function(e){this.columns=[{label:"Name",property:"name",type:"text",width:170,locked:!1},{label:"Description",property:"description",type:"text",width:380,locked:!1},{label:"Color",property:"color",type:"text",width:100,locked:!1},{label:"Assets",property:"assets",type:"number",width:120,locked:!1,cellStyle:{"text-align":"center"}},{label:"Date Created",property:"dateCreated",type:"date",format:e,width:160,locked:!1},{label:"Last Modified",property:"lastModified",type:"date",format:e,width:160,locked:!1}]}}(),w=r(85),b=r(28),A=r(69),C=function(){function e(e,t,r,i,o){this.tagModel=e,this.tagService=t,this.promptService=r,this.activeDialog=i,this.translatePipe=o,this.tagList=[],this.MERGE_CONFIRMATION="ASSET_TAGS.TAG_LIST.MERGE_CONFIRMATION",this.onLoad()}return e.prototype.onLoad=function(){var e=this;this.tagService.getTags().subscribe(function(t){if(t.status===w.a.API_SUCCESS){var r=new E.a;r.name="Select...",e.mergeToTag=r,e.tagList.push(r),(i=e.tagList).push.apply(i,t.data.filter(function(t){return t.id!==e.tagModel.id}))}else e.handleError(t.errors?t.errors[0]:"an error ocurred while loading the tag list.");var i},function(t){return e.handleError(t)})},e.prototype.onMerge=function(){var e=this;this.promptService.open(this.translatePipe.transform(b.y),this.translatePipe.transform(this.MERGE_CONFIRMATION),this.translatePipe.transform(b.w),this.translatePipe.transform(b.v)).then(function(t){t&&e.tagService.mergeTags(e.tagModel.id,e.mergeToTag.id).subscribe(function(t){t.status===w.a.API_SUCCESS?e.activeDialog.close(!0):e.handleError(t.errors?t.errors[0]:"error ocurred while merging tags.")},function(t){return e.handleError(t)})},function(e){return console.log("confirm rejected",e)})},e.prototype.keyDownHandler=function(e){e&&e.code===b.p.ESCAPE&&this.cancelCloseDialog()},e.prototype.cancelCloseDialog=function(){this.activeDialog.close(!1)},e.prototype.handleError=function(e){console.log(e)},e=i.b([Object(o.n)({selector:"tag-merge-dialog",templateUrl:"../tds/web-app/app-js/modules/assetTags/components/tag-merge/tag-merge-dialog.component.html",host:{"(keydown)":"keyDownHandler($event)"},providers:[A.a]}),i.d("design:paramtypes",[E.a,T.a,m.b,g.a,A.a])],e)}(),I=r(84),M=function(){function e(e,t,r,i,o,a){var n=this;this.tagService=e,this.dialogService=t,this.permissionService=r,this.promptService=i,this.translatePipe=o,this.duplicateName=!1,this.REMOVE_CONFIRMATION="ASSET_TAGS.TAG_LIST.REMOVE_CONFIRMATION",a.getUserDatePreferenceAsKendoFormat().subscribe(function(e){n.dateFormat=e,n.gridColumns=new y("{0:"+e+"}"),n.onLoad()})}return e.prototype.onLoad=function(){var e=this;this.colorList=this.tagService.getTagColorList(),this.tagService.getTags().subscribe(function(t){t.status===w.a.API_SUCCESS?e.gridSettings=new v.a(t.data,[{dir:"asc",field:"name"}],{mode:"single",checkboxOnly:!1},{useColumn:"id"}):e.handleError(t.errors?t.errors[0]:"an error ocurred while loading the tag list.")},function(t){return e.handleError(t)})},e.prototype.onMerge=function(e){var t=this;this.dialogService.open(C,[{provide:E.a,useValue:e}],b.e.MD).then(function(e){e&&t.reloadTagList()}).catch(function(e){console.log("Dismissed Dialog")})},e.prototype.removeHandler=function(e){var t=this,r=e.dataItem;this.promptService.open(this.translatePipe.transform(b.y),this.translatePipe.transform(this.REMOVE_CONFIRMATION),this.translatePipe.transform(b.w),this.translatePipe.transform(b.v)).then(function(e){e&&t.tagService.deleteTag(r.id).subscribe(function(e){e.status===w.a.API_SUCCESS?t.reloadTagList():t.handleError(e.errors?e.errors[0]:"an error ocurred while deleting the tag.")},function(e){return t.handleError(e)})},function(e){return console.log("confirm rejected",e)})},e.prototype.addHandler=function(e){var t=e.sender;this.closeEditor(t),t.addRow(new E.a)},e.prototype.editHandler=function(e){var t=e.sender,r=e.rowIndex,i=e.dataItem;this.closeEditor(t),this.editedRowIndex=r,this.editedTag=Object.assign({},i),t.editRow(r)},e.prototype.saveHandler=function(e){var t=e.sender,r=e.rowIndex,i=e.dataItem;e.isNew?this.createTag(i,t,r):this.updateTag(i,t,r)},e.prototype.cancelHandler=function(e){var t=e.sender,r=e.rowIndex;this.closeEditor(t,r)},e.prototype.closeEditor=function(e,t){var r=this;if(void 0===t&&(t=this.editedRowIndex),e.closeRow(t),this.editedTag){var i=this.gridSettings.resultSet.find(function(e){return e.id===r.editedTag.id});Object.assign(i,this.editedTag)}this.editedRowIndex=void 0,this.editedTag=void 0},e.prototype.createTag=function(e,t,r){var i=this;this.tagService.createTag(e).subscribe(function(e){e.status===w.a.API_SUCCESS?(i.finishSave(t,r),i.reloadTagList()):i.handleError(e.errors?e.errors[0]:"an error ocurred while creating the tag")},function(e){return i.handleError(e)})},e.prototype.updateTag=function(e,t,r){var i=this;this.tagService.updateTag(e).subscribe(function(e){e.status===w.a.API_SUCCESS?(i.finishSave(t,r),i.reloadTagList()):i.handleError(e.errors?e.errors[0]:"an error ocurred while updating the tag")},function(e){return i.handleError(e)})},e.prototype.finishSave=function(e,t){e.closeRow(t),this.editedRowIndex=void 0,this.editedTag=void 0},e.prototype.reloadTagList=function(){var e=this;this.tagService.getTags().subscribe(function(t){t.status===w.a.API_SUCCESS?e.gridSettings.reloadData(t.data):e.handleError(t.errors?t.errors[0]:"an error ocurred while loading the tag list.")},function(t){return e.handleError(t)})},e.prototype.handleError=function(e){console.log(e)},e.prototype.validateUniqueName=function(e){this.duplicateName=!1;var t=this.gridSettings.resultSet.find(function(t){return t.name.toLowerCase()===e.name.trim().toLocaleLowerCase()});t&&(this.duplicateName=!e.id||e.id!==t.id)},e.prototype.canCreate=function(){return this.permissionService.hasPermission(I.a.TagCreate)},e.prototype.canEdit=function(){return this.permissionService.hasPermission(I.a.TagEdit)},e.prototype.canDelete=function(){return this.permissionService.hasPermission(I.a.TagDelete)},e.prototype.canMerge=function(){return this.permissionService.hasPermission(I.a.TagMerge)},e=i.b([Object(o.n)({selector:"tag-list",templateUrl:"../tds/web-app/app-js/modules/assetTags/components/tag-list/tag-list.component.html",providers:[A.a]}),i.d("design:paramtypes",[T.a,g.b,f.a,m.b,A.a,S.c])],e)}(),L=function(){function e(){}return e.TAG_LIST={url:"list"},e}(),P=[{path:"",pathMatch:"full",redirectTo:L.TAG_LIST.url},{path:L.TAG_LIST.url,data:{page:{title:"ASSET_TAGS.MANAGE_TAGS",instruction:"",menu:["GLOBAL.PROJECTS","ASSET_TAGS.MANAGE_TAGS"],topMenu:{parent:"menu-parent-projects",child:"menu-parent-project-tags"}},requiresAuth:!0,requiresPermissions:[I.a.TagView]},component:M,canActivate:[h.a,u.a]}],O=function(){function e(){}return e=i.b([Object(o.J)({exports:[p.d],imports:[p.d.forChild(P)]})],e)}();r.d(t,"AssetTagsModule",function(){return _});var _=function(){function e(){}return e=i.b([Object(o.J)({imports:[a.b,s.a,n.c,d.a,c.a,l.a,O],declarations:[M,C],providers:[u.a,T.a],exports:[M],entryComponents:[C]})],e)}()}}]);