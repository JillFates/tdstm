(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{1124:function(t,e,i){"use strict";i.r(e);var n=i(1),o=i(0),a=i(10),r=i(15),s=i(200),c=i(65),p=i(269),l=i(35),d=i(63),u=i(46),h=i(903),f=i(910),v=i(909),A=i(28),y=i(24),m=i(121),g=i(36),S=(i(148),i(147),i(327)),M=function(){function t(t){this.http=t,this.dataDefaultUrl="../ws",this.dataApiActionUrl="../ws/apiAction",this.dataIngestionUrl="../ws/dataingestion",this.dataScriptUrl="../ws/dataScript",this.credentialUrl="../ws/credential",this.fileSystemUrl="../ws/fileSystem"}return t.prototype.getDataScripts=function(){return this.http.get(this.dataIngestionUrl+"/datascript/list").map(function(t){var e=t.json(),i=e&&"success"===e.status&&e.data;return i.forEach(function(t){t.mode="Import"===t.mode?h.d.IMPORT:h.d.EXPORT,t.dateCreated=t.dateCreated?new Date(t.dateCreated):"",t.lastUpdated=t.lastUpdated?new Date(t.lastUpdated):""}),i}).catch(function(t){return t.json()})},t.prototype.getProviders=function(){return this.http.get(this.dataIngestionUrl+"/provider/list").map(function(t){var e=t.json(),i=e&&"success"===e.status&&e.data;return i.forEach(function(t){t.dateCreated=t.dateCreated?new Date(t.dateCreated):"",t.lastUpdated=t.lastUpdated?new Date(t.lastUpdated):""}),i}).catch(function(t){return t.json()})},t.prototype.getAPIActions=function(){var t=this;return this.http.get(this.dataDefaultUrl+"/apiAction").map(function(e){var i=e.json(),n=i&&"success"===i.status&&i.data;return n.forEach(function(e){t.transformApiActionModel(e)}),n}).catch(function(t){return t.json()})},t.prototype.getAPIAction=function(t){var e=this;return this.http.get(this.dataDefaultUrl+"/apiAction/"+t).map(function(t){var i=t.json(),n=i&&"success"===i.status&&i.data;return e.transformApiActionModel(n),n}).catch(function(t){return t.json()})},t.prototype.transformApiActionModel=function(t){t.dictionary=t.apiCatalog,t.agentMethod={id:t.connectorMethod},t.dateCreated=t.dateCreated?new Date(t.dateCreated):"",t.lastUpdated=t.lastUpdated?new Date(t.lastUpdated):"",t.producesData=1===t.producesData,t.polling={frequency:{value:t.pollingInterval,interval:A.n.SECONDS},lapsedAfter:{value:y.a.convertInterval({value:t.pollingLapsedAfter,interval:A.n.SECONDS},A.n.MINUTES),interval:A.n.MINUTES},stalledAfter:{value:y.a.convertInterval({value:t.pollingStalledAfter,interval:A.n.SECONDS},A.n.MINUTES),interval:A.n.MINUTES}},t.defaultDataScript=t.defaultDataScript?t.defaultDataScript:{id:0,name:""},t.reactionScripts&&null!==t.reactionScripts&&"null"!==t.reactionScripts?f.b.createReactions(t,t.reactionScripts):f.b.createBasicReactions(t)},t.prototype.getAPIActionEnums=function(){return this.http.get(this.dataApiActionUrl+"/enums").map(function(t){return t.json()}).catch(function(t){return t.json()})},t.prototype.getCredentials=function(){var t=this;return this.http.get(""+this.credentialUrl).map(function(e){var i=e.json(),n=i&&"success"===i.status&&i.data;return n.forEach(function(e){t.processCredentialModel(e)}),n}).catch(function(t){return t.json()})},t.prototype.processCredentialModel=function(t){t.dateCreated=t.dateCreated?new Date(t.dateCreated):"",t.environment=v.e[t.environment],t.authMethod=v.a[t.authenticationMethod],t.status=v.b[t.status]},t.prototype.getParameters=function(t){return new l.Observable(function(e){if(t.methodParams&&null!==t.methodParams&&""!==t.methodParams){var i=JSON.parse(t.methodParams);i.forEach(function(t){t.property&&t.property.field&&(t.property=t.property.field),"ASSET"===t.context&&(t.context=A.f.COMMON),delete t.sourceFieldList,delete t.currentFieldList}),e.next(i)}e.complete()})},t.prototype.getActionMethodById=function(t){return this.http.get(this.dataApiActionUrl+"/connector/"+t).map(function(t){var e=t.json(),i=new Array;for(var n in e)e.hasOwnProperty(n)&&i.push({id:e[n].apiMethod,name:e[n].name,description:e[n].description,endpointUrl:e[n].endpointUrl,docUrl:e[n].docUrl,producesData:1===e[n].producesData,polling:{frequency:{value:e[n].pollingInterval?e[n].pollingInterval:0,interval:A.n.SECONDS},lapsedAfter:{value:y.a.convertInterval({value:e[n].pollingLapsedAfter?e[n].pollingLapsedAfter:0,interval:A.n.SECONDS},A.n.MINUTES),interval:A.n.MINUTES},stalledAfter:{value:y.a.convertInterval({value:e[n].pollingStalledAfter?e[n].pollingStalledAfter:0,interval:A.n.SECONDS},A.n.MINUTES),interval:A.n.MINUTES}},methodParams:e[n].params,script:e[n].script,httpMethod:e[n].httpMethod});return e=i}).catch(function(t){return t.json()})},t.prototype.saveAPIAction=function(t,e){var i={name:t.name,description:t.description,provider:{id:t.provider.id},apiCatalog:{id:t.dictionary.id},connectorMethod:t.agentMethod.id,httpMethod:t.httpMethod,endpointUrl:t.endpointUrl,docUrl:t.docUrl,producesData:t.producesData?1:0,isPolling:t.isPolling?1:0,pollingInterval:y.a.convertInterval(t.polling.frequency,A.n.SECONDS),pollingLapsedAfter:y.a.convertInterval(t.polling.lapsedAfter,A.n.SECONDS),pollingStalledAfter:y.a.convertInterval(t.polling.stalledAfter,A.n.SECONDS)},n={STATUS:t.eventReactions[0].value,SUCCESS:t.eventReactions[1].value,DEFAULT:t.eventReactions[2].value,ERROR:t.eventReactions[3].value,FAILED:t.eventReactions[4].value,LAPSED:t.eventReactions[5].value,STALLED:t.eventReactions[6].value,PRE:t.eventReactions[7].value,FINAL:t.eventReactions[8].value};if(i.reactionScripts=JSON.stringify(n),i.defaultDataScript={id:1===i.producesData&&0!==t.defaultDataScript.id?t.defaultDataScript.id:null},e&&e.length>0){var o=g.a(e);o.forEach(function(t){t.fieldName&&t.fieldName.field&&(t.fieldName=t.fieldName.field),t.context&&t.context.assetClass&&(t.context=t.context.assetClass),t.context===A.f.COMMON&&(t.context="ASSET"),delete t.sourceFieldList,delete t.currentFieldList}),i.methodParams=JSON.stringify(o)}return t.credential&&t.credential.id&&0!==t.credential.id&&(i.credential={id:t.credential.id}),t.id?(i.version=t.version,this.http.put(this.dataDefaultUrl+"/apiAction/"+t.id,JSON.stringify(i)).map(function(t){var e=t.json();return e&&"success"===e.status&&e.data}).catch(function(t){return t.json()})):this.http.post(this.dataDefaultUrl+"/apiAction",JSON.stringify(i)).map(function(t){var e=t.json();return e&&"success"===e.status&&e.data}).catch(function(t){return t.json()})},t.prototype.validateCode=function(t){return this.http.post(this.dataApiActionUrl+"/validateSyntax",JSON.stringify({scripts:t})).map(function(t){var e=t.json();return e&&"success"===e.status&&e.data}).catch(function(t){return t.json()})},t.prototype.validateAuthentication=function(t){return this.http.post(this.credentialUrl+"/test/"+t,null).map(function(t){var e=t.json();return e&&"success"===e.status&&e.data}).catch(function(t){return t.json()})},t.prototype.validateExpressionCheck=function(t){var e={expression:t};return this.http.post(this.credentialUrl+"/checkValidExprSyntax",JSON.stringify(e)).map(function(t){var e=t.json(),i=e&&"success"===e.status&&e.data,n="";return i.errors&&i.errors.forEach(function(t){n+=t+"\n"}),{valid:i.valid,error:n}}).catch(function(t){return t.json()})},t.prototype.deleteAPIAction=function(t){return this.http.delete(this.dataDefaultUrl+"/apiAction/"+t).map(function(t){var e=t.json();return e&&"success"===e.status&&e.data}).catch(function(t){return t.json()})},t.prototype.checkSyntax=function(t,e){var i={script:t,filename:e};return this.http.post(this.dataScriptUrl+"/checkSyntax",JSON.stringify(i)).map(function(t){return t.json()}).catch(function(t){return t.json()})},t.prototype.uploadFile=function(t){var e=new d.a({}),i=new d.d({headers:e});return this.http.post(this.fileSystemUrl+"/uploadFile",t,i).map(function(t){var e=t.json().data;return new m.g({status:200,body:{data:e}})}).catch(function(t){return t.json()})},t.prototype.filterColumn=function(t,e){var i=e.filter||{logic:"and",filters:[]},n=Object(S.e)(i).filter(function(e){return e.field===t.property})[0];if(t.filter||(t.filter=""),"text"===t.type&&(n?(n=i.filters.find(function(e){return e.field===t.property})).value=t.filter:i.filters.push({field:t.property,operator:"contains",value:t.filter,ignoreCase:!0})),"date"===t.type){var o=y.a.getInitEndFromDate(t.filter),a=o.init,r=o.end;n&&(e.filter.filters=this.getFiltersExcluding(t.property,e)),i.filters.push({field:t.property,operator:"gte",value:a}),i.filters.push({field:t.property,operator:"lte",value:r})}return"boolean"===t.type&&(n?t.filter===S.d?this.clearFilter(t,e):(n=i.filters.find(function(e){return e.field===t.property})).value="True"===t.filter:i.filters.push({field:t.property,operator:"eq",value:"True"===t.filter})),i},t.prototype.clearFilter=function(t,e){t.filter="",e.filter.filters=this.getFiltersExcluding(t.property,e)},t.prototype.getFiltersExcluding=function(t,e){return(e.filter&&e.filter.filters||[]).filter(function(e){return e.field!==t})},t=n.b([Object(o.B)(),n.d("design:paramtypes",[u.a])],t)}(),C=function(){function t(t,e){this.apiActionService=t,this.router=e}return t.prototype.resolve=function(t){var e=this;return this.apiActionService.getAPIActions().map(function(t){return t}).catch(function(t){return console.error("APIActionResolveService:","An Error Occurred trying to fetch the API Action List"),e.router.navigate(["/security/error"]),l.Observable.of(!1)})},t=n.b([Object(o.B)(),n.d("design:paramtypes",[M,c.c])],t)}(),D=i(270),E=i(42),b=i(38),L=i(77),I=i(84),T=i(67),w=i(374),P=i(287),R=i(189),O=i(95),U=function(){function t(t,e,i,n,o,a,r){this.originalModel=t,this.modalType=e,this.promptService=i,this.activeDialog=n,this.prompt=o,this.apiActionService=a,this.customDomainService=r,this.providerList=new Array,this.dictionaryList=new Array,this.agentMethodList=new Array,this.httpMethodList=new Array,this.agentCredentialList=new Array,this.providerCredentialList=new Array,this.datascriptList=new Array,this.providerDatascriptList=new Array,this.apiActionParameterColumnModel=new f.c,this.editModeFromView=!1,this.dataScriptMode=f.b,this.actionTypes=S.a,this.intervals=A.o,this.eventBeforeCallText=f.d,this.interval=A.n,this.selectedInterval={value:0,interval:""},this.selectedLapsed={value:0,interval:""},this.selectedStalled={value:0,interval:""},this.COLUMN_MIN_WIDTH=S.c,this.assetClassesForParameters=[{assetClass:"COMMON",value:"Asset"},{assetClass:"APPLICATION",value:"Application"},{assetClass:"DATABASE",value:"Database"},{assetClass:"DEVICE",value:"Device"},{assetClass:"STORAGE",value:"Storage"},{assetClass:"TASK",value:"Task"},{assetClass:"USER_DEF",value:"User Defined"}],this.currentTab=0,this.initFormLoad=!0,this.codeMirror={mode:{name:"groovy"},rows:10,cols:4},this.validInfoForm=!1,this.validParametersForm=!0,this.invalidScriptSyntax=!1,this.checkActionModel=O.a,this.lastSelectedDictionaryModel={id:0,name:"Select..."},this.lastSelectedAgentMethodModel={id:"0",name:"Select..."},this.savedApiAction=!1,this.defaultDictionaryModel={name:"",id:0}}return t.prototype.ngOnInit=function(){this.apiActionModel=g.a(this.originalModel),this.apiActionModel.dictionary||(this.apiActionModel.dictionary=this.defaultDictionaryModel),this.selectedInterval=g.a(this.originalModel.polling.frequency),this.selectedLapsed=g.a(this.originalModel.polling.lapsedAfter),this.selectedStalled=g.a(this.originalModel.polling.stalledAfter),this.dataSignature=JSON.stringify(this.apiActionModel),this.dataParameterListSignature="",this.parameterList=[],this.getProviders(),this.getAgents(),this.getCommonFieldSpecs(),this.getModalTitle(),this.prepareFormListener()},t.prototype.getModalTitle=function(){this.modalTitle=this.modalType===S.a.CREATE?"Create API Action":this.modalType===S.a.EDIT?"API Action Edit":"API Action Detail"},t.prototype.prepareFormListener=function(){var t=this;setTimeout(function(){t.apiActionForm.valueChanges.subscribe(function(e){t.verifyIsValidForm()}),t.verifyIsValidForm()},100)},t.prototype.getProviders=function(){var t=this;this.apiActionService.getProviders().subscribe(function(e){var i;t.modalType===S.a.CREATE&&(t.providerList.push({id:0,name:"Select..."}),t.apiActionModel.provider=t.providerList[0],t.modifySignatureByProperty("provider")),(i=t.providerList).push.apply(i,e),t.getCredentials()},function(t){return console.log(t)})},t.prototype.getAgents=function(){var t=this;this.apiActionService.getAPIActionEnums().subscribe(function(e){var i,n;t.modalType===S.a.CREATE&&(t.dictionaryList.push({id:0,name:"Select..."}),t.apiActionModel.dictionary=t.dictionaryList[0],t.modifySignatureByProperty("dictionary")),(i=t.dictionaryList).push.apply(i,e.data.agentNames),t.apiActionModel.agentMethod&&t.apiActionModel.agentMethod.id?t.onDictionaryValueChange(t.apiActionModel.dictionary):(t.agentMethodList.push({id:"0",name:"Select..."}),t.apiActionModel.agentMethod=t.agentMethodList[0],t.modifySignatureByProperty("agentMethod")),t.httpMethodList.push("Select..."),(n=t.httpMethodList).push.apply(n,e.data.httpMethod),t.apiActionModel.httpMethod||(t.apiActionModel.httpMethod=t.httpMethodList[0])},function(t){return console.log(t)})},t.prototype.getCredentials=function(){var t=this;this.apiActionService.getCredentials().subscribe(function(e){var i;t.modalType!==S.a.CREATE&&t.apiActionModel.credential||(t.agentCredentialList.push({id:0,name:"Select..."}),t.apiActionModel.credential=t.agentCredentialList[0],t.modifySignatureByProperty("credential")),(i=t.agentCredentialList).push.apply(i,e),t.getDataScripts()},function(t){return console.log(t)})},t.prototype.getDataScripts=function(){var t=this;this.apiActionService.getDataScripts().subscribe(function(e){var i;e=e.sort(function(t,e){return R.a.compareByProperty(t,e,"name")}),t.modalType===S.a.CREATE&&(t.datascriptList.push({id:0,name:"Select..."}),t.apiActionModel.defaultDataScript=t.datascriptList[0],t.modifySignatureByProperty("defaultDataScript")),(i=t.datascriptList).push.apply(i,e),t.apiActionModel.provider&&0!==t.apiActionModel.provider.id&&t.onProviderValueChange(t.apiActionModel.provider,!0)},function(t){return console.log(t)})},t.prototype.getParameters=function(){var t=this;this.apiActionService.getParameters(this.apiActionModel).subscribe(function(e){t.parameterList=e,t.parameterList.forEach(function(e){t.onContextValueChange(e)}),setTimeout(function(){t.dataParameterListSignature=JSON.stringify(t.parameterList)},200)},function(t){return console.log(t)})},t.prototype.getCommonFieldSpecs=function(){var t=this;this.customDomainService.getCommonFieldSpecsWithShared().subscribe(function(e){t.commonFieldSpecs=e,t.modalType!==S.a.CREATE&&t.getParameters()},function(t){return console.log(t)})},t.prototype.onSaveApiAction=function(){var t=this;this.apiActionService.saveAPIAction(this.apiActionModel,this.parameterList).subscribe(function(e){e&&(t.savedApiAction=!0,t.modalType=t.actionTypes.VIEW,t.getModalTitle(),t.apiActionModel.id=e.id,t.apiActionModel.version=e.version,t.dataSignature=JSON.stringify(t.apiActionModel),t.dataParameterListSignature=JSON.stringify(t.parameterList))},function(t){return console.log(t)})},t.prototype.isDirty=function(){return this.dataSignature!==JSON.stringify(this.apiActionModel)},t.prototype.isParameterListDirty=function(){if(""!==this.dataParameterListSignature&&this.parameterList.length>0)return this.dataParameterListSignature!==JSON.stringify(this.parameterList)},t.prototype.cancelCloseDialog=function(){var t=this;this.isDirty()||this.isParameterListDirty()?this.promptService.open("Confirmation Required","You have changes that have not been saved. Do you want to continue and lose those changes?","Confirm","Cancel").then(function(e){e?t.activeDialog.close(t.savedApiAction?t.apiActionModel:null):t.focusForm()}).catch(function(t){return console.log(t)}):this.activeDialog.close(this.savedApiAction?this.apiActionModel:null)},t.prototype.handleKeyboardEvent=function(t){t&&t.code===A.p.ESCAPE&&this.cancelCloseDialog()},t.prototype.changeToEditApiAction=function(){this.editModeFromView=!0,this.modalType=this.actionTypes.EDIT,this.getModalTitle(),this.verifyIsValidForm(),this.focusForm()},t.prototype.onDeleteApiAction=function(){var t=this;this.prompt.open("Confirmation Required","Do you want to proceed?","Yes","No").then(function(e){e&&t.apiActionService.deleteAPIAction(t.apiActionModel.id).subscribe(function(e){t.activeDialog.dismiss(e)},function(t){return console.log(t)})})},t.prototype.isCurrentTab=function(t){return this.currentTab===t},t.prototype.setCurrentTab=function(t){var e=this;this.editModeFromView=!1,0===this.currentTab&&this.verifyIsValidForm(),0===t&&this.prepareFormListener(),2===t&&this.codeMirrorComponents.changes.subscribe(function(t){t.forEach(function(t){e.codeMirrorComponent=t,e.codeMirrorComponent.setDisabled(e.modalType===S.a.VIEW)})}),this.currentTab=t},t.prototype.verifyIsValidForm=function(){if(this.apiActionForm){if(this.validInfoForm=this.apiActionForm.valid&&"0"!==this.apiActionModel.agentMethod.id&&0!==this.apiActionModel.dictionary.id&&0!==this.apiActionModel.provider.id&&"Select..."!==this.apiActionModel.httpMethod,!this.validInfoForm&&!this.initFormLoad)for(var t in this.apiActionForm.controls)this.apiActionForm.controls[t]&&this.apiActionForm.controls[t].markAsTouched();this.initFormLoad=!1}this.editModeFromView&&(this.validInfoForm=this.editModeFromView),this.apiActionParametersForm&&(this.validParametersForm=this.apiActionParametersForm.valid)},t.prototype.onDictionaryValueChange=function(t){var e=this;t=t||this.defaultDictionaryModel,this.apiActionModel.dictionary=t,this.lastSelectedDictionaryModel&&0!==this.lastSelectedDictionaryModel.id?this.prompt.open("Confirmation Required","Changing the Dictionary or Method will overwrite many of the settings of the Action. Are you certain that you want to proceed?","Yes","No").then(function(i){e.loadDictionaryModel(t,i)}):this.loadDictionaryModel(t,!0)},t.prototype.loadDictionaryModel=function(t,e){var i=this;if(e)0!==t.id?this.apiActionService.getActionMethodById(t.id).subscribe(function(t){i.agentMethodList=new Array,i.agentMethodList.push({id:"0",name:"Select..."}),i.apiActionModel.agentMethod&&(i.apiActionModel.agentMethod=t.find(function(t){return t.id===i.apiActionModel.agentMethod.id})),i.apiActionModel.agentMethod||(i.apiActionModel.agentMethod=i.agentMethodList[0]),i.modifySignatureByProperty("agentMethod"),i.agentMethodList=t},function(t){return console.log(t)}):(this.agentMethodList=new Array,this.agentMethodList.push({id:"0",name:"Select..."}),this.apiActionModel.agentMethod=this.agentMethodList[0]);else if(this.lastSelectedDictionaryModel){var n=this.dictionaryList.find(function(t){return t.id===i.lastSelectedDictionaryModel.id});this.apiActionModel.dictionary=n?g.a(this.lastSelectedDictionaryModel):g.a(this.dictionaryList[0])}},t.prototype.onMethodValueChange=function(t){var e=this;this.lastSelectedAgentMethodModel&&"0"!==this.lastSelectedAgentMethodModel.id?this.prompt.open("Confirmation Required","Changing the Dictionary or Method will overwrite many of the settings of the Action. Are you certain that you want to proceed?","Yes","No").then(function(t){e.loadAgentMethodModel(t)}):this.loadAgentMethodModel(!0)},t.prototype.loadAgentMethodModel=function(t){var e=this;if(t)this.apiActionModel.endpointUrl=this.apiActionModel.agentMethod.endpointUrl,this.apiActionModel.docUrl=this.apiActionModel.agentMethod.docUrl,this.apiActionModel.isPolling=this.apiActionModel.agentMethod.isPolling,this.apiActionModel.polling=this.apiActionModel.agentMethod.polling,this.apiActionModel.producesData=this.apiActionModel.agentMethod.producesData,this.lastSelectedAgentMethodModel=g.a(this.apiActionModel.agentMethod),this.guardParams(),this.parameterList=this.apiActionModel.agentMethod.methodParams,this.parameterList.forEach(function(t){e.onContextValueChange(t)}),this.verifyIsValidForm(),this.populateReactionScripts(),this.populateHttpMethod();else if(this.lastSelectedAgentMethodModel){var i=this.agentMethodList.find(function(t){return t.id===e.lastSelectedAgentMethodModel.id});this.apiActionModel.agentMethod=i?g.a(this.lastSelectedAgentMethodModel):g.a(this.agentMethodList[0])}},t.prototype.populateReactionScripts=function(){var t=this.apiActionModel.agentMethod.script;f.b.createBasicReactions(this.apiActionModel);var e=function(e){if(t[e]){var n=i.apiActionModel.eventReactions.find(function(t){return t.type===e});n&&(n.value=t[e],n.open=!0,n.selected=!0)}},i=this;for(var n in t)e(n)},t.prototype.populateHttpMethod=function(){var t=this.apiActionModel.agentMethod.httpMethod;this.httpMethodList.find(function(e){return e===t})&&(this.apiActionModel.httpMethod=t)},t.prototype.guardParams=function(){var t=this;return this.apiActionModel.agentMethod.methodParams.forEach(function(e,i){e.context&&e.context.name&&(e.context=e.context.name),e.context&&"null"!==e.context&&null!==e.context||t.apiActionModel.agentMethod.methodParams.splice(i,1),e.param&&("null"!==e.param&&null!==e.param||(e.param=""),e.paramName=e.param,delete e.param),e.property&&("null"!==e.property&&null!==e.property||(e.property=""),e.fieldName=e.property,delete e.property)}),this.apiActionModel.agentMethod.methodParams},t.prototype.onIntervalChange=function(t,e){var i=y.a.convertInterval(e,t.interval);e.interval=t.interval,e.value=i},t.prototype.onProviderValueChange=function(t,e){var i=this;this.providerCredentialList=new Array,this.providerCredentialList.push({id:0,name:"Select..."}),this.providerCredentialList=this.providerCredentialList.concat(this.agentCredentialList.filter(function(e){return e.provider&&e.provider.id===t.id})),this.providerDatascriptList=new Array,this.providerDatascriptList.push({id:0,name:"Select..."}),this.providerDatascriptList=this.providerDatascriptList.concat(this.datascriptList.filter(function(e){return e.provider&&e.provider.id===t.id})),e?(this.apiActionModel.defaultDataScript=this.providerDatascriptList.find(function(t){return t.id===i.apiActionModel.defaultDataScript.id}),this.modifySignatureByProperty("defaultDataScript"),this.apiActionModel.credential=this.providerCredentialList.find(function(t){return t.id===i.apiActionModel.credential.id}),this.modifySignatureByProperty("credential")):(this.apiActionModel.defaultDataScript=this.providerDatascriptList[0],this.apiActionModel.credential=this.providerCredentialList[0])},t.prototype.onOpenDictionary=function(){this.apiActionModel.dictionary&&0!==this.apiActionModel.dictionary.id&&(this.lastSelectedDictionaryModel=g.a(this.apiActionModel.dictionary))},t.prototype.onOpenAgentMethod=function(){this.apiActionModel.agentMethod&&"0"!==this.apiActionModel.agentMethod.id&&(this.lastSelectedAgentMethodModel=g.a(this.apiActionModel.agentMethod)),setTimeout(function(){jQuery("kendo-popup").css("width","auto")},100)},t.prototype.showsEventLabel=function(){var t=[f.e.SUCCESS,f.e.DEFAULT,f.e.ERROR,f.e.LAPSED,f.e.STALLED];return void 0!==this.apiActionModel.eventReactions.find(function(e){return void 0!==t.find(function(t){return e.type===t})&&e.selected})},t.prototype.showsCustomizeLabel=function(){var t=[f.e.PRE,f.e.FINAL];return void 0!==this.apiActionModel.eventReactions.find(function(e){return void 0!==t.find(function(t){return e.type===t})&&e.selected})},t.prototype.openCloseCodeMirror=function(t){t.open=!t.open},t.prototype.onAddParameter=function(){this.parameterList.push({paramName:"",desc:"",type:"string",context:"",fieldName:"",currentFieldList:[],value:"",readonly:!1,required:!1,encoded:!1}),this.verifyIsValidForm()},t.prototype.onContextValueChange=function(t){if(t&&t.context){var e=t.context.assetClass?t.context.assetClass:t.context,i=this.commonFieldSpecs.find(function(t){return t.domain===e});if(i){t.currentFieldList=i.fields,t.sourceFieldList=i.fields;var n=t.currentFieldList.find(function(e){return e.field===t.fieldName});n&&(t.fieldName=n)}this.verifyIsValidForm()}},t.prototype.filterChange=function(t,e){e.currentFieldList=e.sourceFieldList.filter(function(e){return-1!==e.label.toLowerCase().indexOf(t.toLowerCase())})},t.prototype.onDeleteParameter=function(t,e){var i=this.parameterList.indexOf(e);i>=0&&(this.parameterList.splice(i,1),this.verifyIsValidForm())},t.prototype.validateAllSyntax=function(t){var e=this;return new l.Observable(function(i){var n=[];t?""!==t.value&&n.push({code:t.type,script:t.value}):e.apiActionModel.eventReactions.forEach(function(t){t.state=e.checkActionModel.UNKNOWN,t.error="",""!==t.value&&n.push({code:t.type,script:t.value})}),e.apiActionService.validateCode(n).subscribe(function(t){e.invalidScriptSyntax=!1,t.forEach(function(t){var i=e.apiActionModel.eventReactions.find(function(e){return e.type===t.code});if(t.validSyntax)i.state=e.checkActionModel.VALID;else{var n="";t.errors.forEach(function(t){n+=t.message+"\n"}),i.error=n,i.state=e.checkActionModel.INVALID,e.invalidScriptSyntax=!0}}),i.next()},function(t){return console.log(t)})})},t.prototype.verifyCode=function(t){this.validateAllSyntax(t).subscribe()},t.prototype.onCheckAllSyntax=function(){this.validateAllSyntax().subscribe()},t.prototype.modifySignatureByProperty=function(t){this.dataSignature=P.a.modifySignatureByProperty(this.dataSignature,t,this.apiActionModel[t])},t.prototype.isViewMode=function(){return this.modalType===this.actionTypes.VIEW},t.prototype.getAssetClassValue=function(t){var e=this.assetClassesForParameters.find(function(e){return e.assetClass===t||e.assetClass===t.assetClass});return e&&e.value?e.value:t},t.prototype.getOnInputKey=function(t){t.key===A.p.ENTER&&(t.preventDefault(),t.stopPropagation())},t.prototype.focusForm=function(){this.apiActionContainer.nativeElement.focus()},t.prototype.isCheckSyntaxSectionDisabled=function(t){var e=this.apiActionModel.eventReactions[t];return""===e.value||e.state===O.a.VALID},t.prototype.onEventReactionSelect=function(t){t.type===f.e.PRE&&(t.selected&&""===t.value?t.value=this.eventBeforeCallText:t.value="")},n.b([Object(o.lb)("apiActionForm"),n.d("design:type",r.g)],t.prototype,"apiActionForm",void 0),n.b([Object(o.lb)("apiActionParametersForm"),n.d("design:type",r.g)],t.prototype,"apiActionParametersForm",void 0),n.b([Object(o.lb)("apiActionReactionForm"),n.d("design:type",r.g)],t.prototype,"apiActionReactionForm",void 0),n.b([Object(o.mb)("codeMirror"),n.d("design:type",o.V)],t.prototype,"codeMirrorComponents",void 0),n.b([Object(o.lb)("apiActionContainer"),n.d("design:type",o.u)],t.prototype,"apiActionContainer",void 0),n.b([Object(o.z)("keydown",["$event"]),n.d("design:type",Function),n.d("design:paramtypes",[KeyboardEvent]),n.d("design:returntype",void 0)],t.prototype,"handleKeyboardEvent",null),t=n.b([Object(o.n)({selector:"api-action-view-edit",templateUrl:"../tds/web-app/app-js/modules/apiAction/components/view-edit/api-action-view-edit.component.html",styles:["\n        .has-error, .has-error:focus {\n            border: 1px #f00 solid;\n        }\n\t\t.invalid-form {\n\t\t\tcolor: red;\n\t\t\tfont-weight: bold;\n\t\t}\n\t\t.script-error {\n\t\t\tmargin-bottom: 18px;\n\t\t}\n\t\tlabel.url-label {\n            width: 146px;\n\t\t}\n        .url-input {\n\t        width: 82%;\n        }\n\t"]}),n.d("design:paramtypes",[f.b,Number,T.b,b.a,T.b,M,w.a])],t)}(),F=i(54),N=function(){function t(t,e,i,n,o,a){this.route=t,this.dialogService=e,this.permissionService=i,this.apiActionService=n,this.prompt=o,this.preferenceService=a,this.state={sort:[{dir:"asc",field:"name"}],filter:{filters:[],logic:"and"}},this.skip=0,this.pageSize=A.l,this.defaultPageOptions=A.m,this.apiActionColumnModel=null,this.COLUMN_MIN_WIDTH=S.c,this.actionType=S.a,this.selectedRows=[],this.booleanFilterData=S.b,this.defaultBooleanFilterData=S.d,this.interval=A.n,this.openLastItemId=0,this.dateFormat="",this.state.take=this.pageSize,this.state.skip=this.skip,this.resultSet=this.route.snapshot.data.apiActions,this.gridData=Object(E.e)(this.resultSet,this.state)}return t.prototype.ngOnInit=function(){var t=this;this.preferenceService.getUserDatePreferenceAsKendoFormat().subscribe(function(e){t.dateFormat=e,t.apiActionColumnModel=new f.a("{0:"+e+"}")})},t.prototype.filterChange=function(t){this.state.filter=t,this.gridData=Object(E.e)(this.resultSet,this.state)},t.prototype.sortChange=function(t){this.state.sort=t,this.gridData=Object(E.e)(this.resultSet,this.state)},t.prototype.onFilter=function(t){var e=this.apiActionService.filterColumn(t,this.state);this.filterChange(e)},t.prototype.clearValue=function(t){this.apiActionService.clearFilter(t,this.state),this.filterChange(this.state.filter)},t.prototype.onCreate=function(){var t=new f.b;this.openAPIActionDialogViewEdit(t,S.a.CREATE)},t.prototype.onEdit=function(t){var e=this,i=t;this.apiActionService.getAPIAction(i.id).subscribe(function(t){e.openAPIActionDialogViewEdit(t,S.a.EDIT,i)},function(t){return console.log(t)})},t.prototype.onDelete=function(t){var e=this;this.prompt.open("Confirmation Required","Do you want to proceed?","Yes","No").then(function(i){i&&e.apiActionService.deleteAPIAction(t.id).subscribe(function(t){e.reloadData()},function(t){return console.log(t)})})},t.prototype.cellClick=function(t){var e=this;if(t.columnIndex>0){var i=t.dataItem;this.selectRow(i.id),this.apiActionService.getAPIAction(i.id).subscribe(function(t){e.openAPIActionDialogViewEdit(t,S.a.VIEW,i)},function(t){return console.log(t)})}},t.prototype.reloadData=function(){var t=this;this.apiActionService.getAPIActions().subscribe(function(e){t.resultSet=e,t.gridData=Object(E.e)(t.resultSet,t.state),0!==t.openLastItemId&&setTimeout(function(){t.selectRow(t.openLastItemId);var e=t.gridData.data.find(function(e){return e.id===t.openLastItemId});t.openLastItemId=0,t.openAPIActionDialogViewEdit(e,S.a.VIEW,e)},700)},function(t){return console.log(t)})},t.prototype.reloadItem=function(t){this.apiActionService.getAPIAction(t.id).subscribe(function(e){Object.assign(t,e)},function(t){return console.log(t)})},t.prototype.openAPIActionDialogViewEdit=function(t,e,i){var n=this;this.dialogService.open(U,[{provide:f.b,useValue:t},{provide:Number,useValue:e}],A.e.XLG,!1).then(function(t){t&&(e===S.a.CREATE?n.reloadData():n.reloadItem(i))}).catch(function(t){n.reloadData(),console.log("Dismissed Dialog")})},t.prototype.selectRow=function(t){this.selectedRows=[],this.selectedRows.push(t)},t.prototype.isCreateAvailable=function(){return this.permissionService.hasPermission(I.a.ActionCreate)},t.prototype.isEditAvailable=function(){return this.permissionService.hasPermission(I.a.ActionEdit)},t.prototype.isDeleteAvailable=function(){return this.permissionService.hasPermission(I.a.ActionDelete)},t.prototype.onClickTemplate=function(t){t.target&&t.target.parentNode&&t.target.parentNode.click()},t.prototype.pageChange=function(t){this.skip=t.skip,this.state.skip=this.skip,this.state.take=t.take||this.state.take,this.pageSize=this.state.take,this.gridData=Object(E.e)(this.resultSet,this.state)},t=n.b([Object(o.n)({selector:"api-action-list",templateUrl:"../tds/web-app/app-js/modules/apiAction/components/list/api-action-list.component.html",styles:["\n\t\t#btnCreate { margin-left: 16px; }\n\t\t.action-header { width:100%; text-align:center; }\n\t"]}),n.d("design:paramtypes",[c.a,b.b,L.a,M,T.b,F.c])],t)}(),x=function(){function t(){}return t.API_ACTION_LIST={url:"list"},t}(),j=[{path:"",pathMatch:"full",redirectTo:x.API_ACTION_LIST.url},{path:x.API_ACTION_LIST.url,data:{page:{title:"API_ACTION.API_ACTIONS",instruction:"",menu:["GLOBAL.PROJECT","API_ACTION.API_ACTIONS"]},requiresAuth:!0},component:N,resolve:{apiActions:C},canActivate:[D.a,p.a]}],V=function(){function t(){}return t=n.b([Object(o.J)({exports:[c.d],imports:[c.d.forChild(j)]})],t)}(),k=i(1129),B=i(1114),J=i(1111),_=i(1116),q=i(1115),W=function(){function t(){this.show=!1}return t.prototype.onToggle=function(){this.show=!this.show},t=n.b([Object(o.n)({selector:"popup-polling",templateUrl:"../tds/web-app/app-js/modules/apiAction/popups/popup-polling.component.html",styles:["\n\t\tdiv { width: 320px; padding: 10px; }\n    "]})],t)}(),H=function(){function t(){this.show=!1}return t.prototype.onToggle=function(){this.show=!this.show},t=n.b([Object(o.n)({selector:"popup-provides-data",templateUrl:"../tds/web-app/app-js/modules/apiAction/popups/popup-provides-data.component.html",styles:["\n\t\tdiv { width: 320px; padding: 10px; }\n    "]})],t)}();i.d(e,"APIActionModule",function(){return K});var K=function(){function t(){}return t=n.b([Object(o.J)({imports:[a.b,s.a,r.c,k.a,B.a,J.a,_.a,q.a,V],declarations:[N,U,W,H],providers:[p.a,C,M,w.a],exports:[],entryComponents:[U]})],t)}()},903:function(t,e,i){"use strict";i.d(e,"b",function(){return a}),i.d(e,"c",function(){return r}),i.d(e,"e",function(){return s}),i.d(e,"a",function(){return n}),i.d(e,"d",function(){return o}),i.d(e,"f",function(){return c});var n,o,a=360,r=function(){return function(t){this.columns=[{label:"Action",property:"action",type:"action",width:108,locked:!0},{label:"Name",property:"name",type:"text",locked:!0},{label:"Provider",property:"provider.name",type:"text",width:220},{label:"Description",property:"description",type:"text"},{label:"Mode",property:"modeFormat",type:"text",width:200},{label:"Date Create",property:"dateCreated",type:"date",format:t,width:170},{label:"Last Modified",property:"lastUpdated",type:"date",format:t,width:170}]}}(),s=function(){return function(){}}();!function(t){t[t.VIEW=0]="VIEW",t[t.CREATE=1]="CREATE",t[t.EDIT=2]="EDIT"}(n||(n={})),function(t){t[t.IMPORT=0]="IMPORT",t[t.EXPORT=1]="EXPORT"}(o||(o={}));var c=function(){return function(t,e){this.gridHeight=23,this.columns=t,this.data=e}}()},909:function(t,e,i){"use strict";i.d(e,"c",function(){return c}),i.d(e,"d",function(){return p}),i.d(e,"f",function(){return n}),i.d(e,"a",function(){return o}),i.d(e,"e",function(){return a}),i.d(e,"b",function(){return s});var n,o,a,r,s,c=function(){return function(t){this.columns=[{label:"Action",property:"action",type:"action",width:108,locked:!0},{label:"Name",property:"name",type:"text",locked:!0},{label:"Description",property:"description",type:"text"},{label:"Provider",property:"provider.name",type:"text",width:200},{label:"Environment",property:"environment",type:"text",width:200},{label:"Status",property:"status",type:"text",width:100},{label:"Auth Method",property:"authMethod",type:"text",width:200},{label:"Created",property:"dateCreated",type:"date",format:t,width:170}]}}(),p=function(){return function(){this.name="",this.description="",this.provider={id:null,name:""},this.environment="",this.status="",this.authMethod="",this.username="",this.password="",this.authenticationUrl="",this.renewTokenUrl="",this.terminateUrl="",this.httpMethod="",this.sessionName="",this.validationExpression=""}}();!function(t){t.BASIC_AUTH="BASIC_AUTH",t.FORM_VARS="FORM_VARS"}(n||(n={})),function(t){t.BASIC_AUTH="Basic Auth",t.COOKIE="Cookie Session",t.HEADER="Header Session",t.JWT="JSON Web Tokens"}(o||(o={})),function(t){t.DEVELOPMENT="Development",t.OTHER="Other",t.PRODUCTION="Production",t.SANDBOX="Sandbox"}(a||(a={})),function(t){t.POST="POST",t.GET="GET",t.PUT="PUT"}(r||(r={})),function(t){t.ACTIVE="Active",t.INACTIVE="Inactive"}(s||(s={}))},910:function(t,e,i){"use strict";var n=i(28),o=i(95),a=(function(){}(),function(){}(),function(){return function(){this.name="",this.description="",this.isPolling=!1,this.producesData=!1,this.endpointUrl="",this.polling={frequency:{value:0,interval:n.n.SECONDS},lapsedAfter:{value:0,interval:n.n.MINUTES},stalledAfter:{value:0,interval:n.n.MINUTES}},this.methodParams=[]}}());i.d(e,"a",function(){return s}),i.d(e,"c",function(){return c}),i.d(e,"d",function(){return p}),i.d(e,"b",function(){return l}),i.d(e,"e",function(){return r});var r,s=function(){return function(t){this.columns=[{label:"Action",property:"action",type:"action",width:106,locked:!0},{label:"Name",property:"name",type:"text",width:150,locked:!0},{label:"Provider",property:"provider.name",type:"text",width:180},{label:"Description",property:"description",type:"text",width:300},{label:"Method",property:"agentMethod.name",type:"text",width:125},{label:"Data",property:"producesData",type:"boolean",width:90},{label:"Default DataScript",property:"defaultDataScript.name",type:"text",width:180},{label:"Created",property:"dateCreated",type:"date",format:t,width:160},{label:"Last Updated",property:"lastUpdated",type:"date",format:t,width:160}]}}(),c=function(){return function(){this.columns=[{label:"Action",property:"action",type:"action",width:64,locked:!0},{label:"custom",property:"required",type:"boolean",width:42},{label:"custom",property:"readonly",type:"boolean",width:42},{label:"Name",property:"paramName",type:"text",width:198},{label:"Context",property:"context.value",type:"text",width:140},{label:"Value",property:"value",type:"text",width:218},{label:"custom",property:"encoded",type:"boolean",width:42},{label:"Description",property:"desc",type:"text",width:268}]}}(),p="// Setting Content Type, default 'application/json'\n// request.config.setProperty('Content-Type', 'text/csv')\n\n// Setting content type Accepted, default 'application/json'\n// request.config.setProperty('Accept', 'application/xml;q=0.9')",l=function(){function t(){this.name="",this.description="",this.provider={id:null,name:""},this.dictionary={id:null,name:""},this.agentMethod=new a,this.defaultDataScript={id:null,name:""},this.isPolling=!1,this.producesData=!1,this.endpointUrl="",this.docUrl="",this.polling={frequency:{value:0,interval:n.n.SECONDS},lapsedAfter:{value:0,interval:n.n.MINUTES},stalledAfter:{value:0,interval:n.n.MINUTES}},t.createBasicReactions(this)}return t.createBasicReactions=function(t){t.eventReactions=[],t.eventReactions.push(new d(r.STATUS,!0,"// Check the HTTP response code for a 200 OK \n if (response.status == SC.OK) { \n \t return SUCCESS \n } else { \n \t return ERROR \n}")),t.eventReactions.push(new d(r.SUCCESS,!0,"// Update the task status that the task completed\n task.done()")),t.eventReactions.push(new d(r.DEFAULT,!0,"// Put the task on hold and add a comment with the cause of the error\n task.error( response.error )")),t.eventReactions.push(new d(r.ERROR,!1,"")),t.eventReactions.push(new d(r.FAILED,!1,"")),t.eventReactions.push(new d(r.LAPSED,!1,"")),t.eventReactions.push(new d(r.STALLED,!1,"")),t.eventReactions.push(new d(r.PRE,!1,"")),t.eventReactions.push(new d(r.FINAL,!1,""))},t.createReactions=function(t,e){var i=JSON.parse(e);t.eventReactions=[],t.eventReactions.push(new d(r.STATUS,!!i.STATUS,i.STATUS?i.STATUS:"")),t.eventReactions.push(new d(r.SUCCESS,!!i.SUCCESS,i.SUCCESS?i.SUCCESS:"")),t.eventReactions.push(new d(r.DEFAULT,!!i.DEFAULT,i.DEFAULT?i.DEFAULT:"")),t.eventReactions.push(new d(r.ERROR,!!i.ERROR,i.ERROR?i.ERROR:"")),t.eventReactions.push(new d(r.FAILED,!!i.FAILED,i.FAILED?i.FAILED:"")),t.eventReactions.push(new d(r.LAPSED,!!i.LAPSED,i.LAPSED?i.LAPSED:"")),t.eventReactions.push(new d(r.STALLED,!!i.STALLED,i.STALLED?i.STALLED:"")),t.eventReactions.push(new d(r.PRE,!!i.PRE,i.PRE?i.PRE:"")),t.eventReactions.push(new d(r.FINAL,!!i.FINAL,i.FINAL?i.FINAL:""))},t}(),d=function(){return function(t,e,i){this.type=t,this.selected=e,this.value=i,this.open=!0,this.state=o.a.UNKNOWN,this.error=""}}();!function(t){t.STATUS="STATUS",t.SUCCESS="SUCCESS",t.DEFAULT="DEFAULT",t.ERROR="ERROR",t.FAILED="FAILED",t.LAPSED="LAPSED",t.STALLED="STALLED",t.PRE="PRE",t.FINAL="FINAL"}(r||(r={}))}}]);