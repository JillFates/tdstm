<!-- Main content -->
<div class="content body tds-kendo-grid api-action-list-component">
	<form clrForm clrLayout="horizontal" class="">
		<div class="clr-row">
            <div class="clr-col-12">
				<tds-button-custom
						icon="repeat"
						[displayLabel]="false"
						[flat]="true"
						(click)="reloadData()"
						class="flat pull-right"
						tooltip="Refresh">
				</tds-button-custom>
				<tds-button-create
						[title]="createActionText"
						class="button-create-action pull-right"
                        [displayLabel]="false"
						[id]="'btnCreate'"
						(click)="onCreate()"
						*ngIf="isCreateAvailable()">
				</tds-button-create>
			</div>
		</div>
	</form>
	<div class="box-body box-with-empty-header" [ngClass]="{'is-filtering': isFiltering}">
			<kendo-grid
					[data]="gridData"
					[filter]="state.filter"
					[filterable]="true"
					(filterChange)="filterChange($event)"
					[sort]="state.sort"
					[skip]="skip"
					[sortable]="{mode:'single', allowUnsort: false}"
					[pageSize]="pageSize"
					[resizable]="true"
					(sortChange)="sortChange($event)"
					[pageable]="{pageSizes: GRID_DEFAULT_PAGINATION_OPTIONS, info: true}"
					(pageChange)="pageChange($event)"
					(cellClick)="cellClick($event)"
					[selectable]="true">
				<!-- Action -->
				<kendo-grid-command-column  [width]="65" [minResizableWidth]="65" [class]="{'k-custom-command-column': true}">
					<ng-template kendoGridHeaderTemplate>
						<tds-button [flat]="true" (click)="toggleFiltering()">
							<clr-icon shape="filter" class="grid-filter-button is-solid">
								<span *ngIf="filterCounter(); let counter" class="badge badge-warning">{{counter}}</span>
							</clr-icon>
						</tds-button>
						<!--
						<div class="text-center">
							<label class="action-header"> {{ 'GLOBAL.ACTION' | translate }} </label>
						</div>
						-->
					</ng-template>

					<!--
					<ng-template kendoGridCellTemplate
								 let-dataItem
								 let-rowIndex="rowIndex">
						<div class="tds-action-button-set">
							<tds-button-edit *ngIf="isEditAvailable()" (click)="onEdit(dataItem)"></tds-button-edit>
							<tds-button-delete *ngIf="isDeleteAvailable()" (click)="onDelete(dataItem)"></tds-button-delete>
						</div>
					</ng-template>
					-->
					<ng-template kendoGridCellTemplate let-dataItem let-rowIndex="rowIndex">
						<div class="action-button btn-group btn-link">
							<clr-dropdown>
								<tds-button icon="ellipsis-vertical" clrDropdownTrigger class="contextual-menu"></tds-button>
								<clr-dropdown-menu *clrIfOpen>
									<a clrDropdownItem [disabled]="!isEditAvailable()" (click)="onEdit(dataItem)">{{'API_ACTION.EDIT_ACTION' | translate}}</a>
									<a clrDropdownItem [disabled]="!isDeleteAvailable()" (click)="onDelete(dataItem)">{{'API_ACTION.DELETE_ACTION' | translate}}</a>
								</clr-dropdown-menu>
							</clr-dropdown>
						</div>
					</ng-template>

				</kendo-grid-command-column>


				<!-- Configured View Columns (*ngFor) -->
				<kendo-grid-column
						*ngFor="let column of gridColumns"
						field="{{column.property}}"
						format="{{column.format}}"
						[width]="commonShrunkColumns.includes(column.label) ? commonShrunkColumnWidth : !column.width ? COLUMN_MIN_WIDTH : column.width">
					<ng-template kendoGridHeaderTemplate>
						<div class="sortable-column" (click)="onClickTemplate($event)">
							<label> {{column.label}}</label>
						</div>
					</ng-template>

					<ng-template kendoGridCellTemplate let-dataItem *ngIf="column.label === 'Type'">
						{{dataItem['actionType'].id ? dataItem['actionType'].id : dataItem['actionType']}}
					</ng-template>
					<ng-template kendoGridCellTemplate *ngIf="column.type === 'boolean'" let-dataItem>
						<input type="checkbox" [(ngModel)]="dataItem[column.property]" style="margin-left: 35%;" disabled/>
					</ng-template>

					<!--	Filters-->
					<ng-template kendoGridFilterCellTemplate let-filter>

						<div class="filter-input" *ngIf="isFiltering && column.property && column.type !== 'action'">
							<div *ngIf="column.type === 'text' || column.type === 'date' || column.type === 'boolean'; then inputFilterTemplate"></div>
							<ng-template #inputFilterTemplate>
								<tds-filter-input
										name="{{column.property}}"
										[value]="column.filter || ''"
										[columnType]="column.type"
										placeholder="{{'GLOBAL.FILTER' | translate}}"
										(filter)="onFilter($event, column)">
								</tds-filter-input>
							</ng-template>

							<!--
							<div *ngIf="column.type === 'date'">
								<kendo-datepicker [format]="dateFormat" [(ngModel)]="column.filter" (valueChange)="onFilter(column)" [style.width.%]="100"></kendo-datepicker>
								<span *ngIf="column.filter" (click)="clearValue(column)" style="right:15%;cursor:pointer;color:#656565;pointer-events:all" class="fa fa-times form-control-feedback" aria-hidden="true"></span>
							</div>
							<div *ngIf="column.type === 'text'">
								<input type="text" (keyup)="onFilter(column)" class="form-control" name="{{column.property}}" [(ngModel)]="column.filter" placeholder="Filter {{column.label}}" value="">
								<span *ngIf="column.filter" (click)="clearValue(column)" style="cursor:pointer;color:#656565;pointer-events:all" class="fa fa-times form-control-feedback" aria-hidden="true"></span>
							</div>
							<div *ngIf="column.type === 'boolean'">
								<kendo-dropdownlist [data]="booleanFilterData" [(ngModel)]="column.filter" (valueChange)="onFilter(column)" [style.width.%]="100"></kendo-dropdownlist>
								<span *ngIf="column.filter" (click)="clearValue(column)" style="cursor:pointer;color:#656565;pointer-events:all; margin-right: 10px; line-height: 30px;" class="fa fa-times form-control-feedback" aria-hidden="true"></span>
							</div>
							-->
						</div>

					</ng-template>
				</kendo-grid-column>

				<ng-template kendoPagerTemplate let-total="total" let-totalPages="totalPages" let-currentPage="currentPage">
					<div class="clr-col-4"></div>
					<div class="clr-col-8">
						<tds-grid-pager
								[total]="total"
								[totalPages]="totalPages"
								[currentPage]="currentPage"
								[pageSize]="pageSize"
								[pageSizes]="GRID_DEFAULT_PAGINATION_OPTIONS"
								(pageChange)="pageChange($event)">
						</tds-grid-pager>
					</div>
				</ng-template>

			</kendo-grid>
		</div>
</div>
