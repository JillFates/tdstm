<!-- Main content -->
<div class="api-action-list-component">
	<section>
		<form clrForm clrLayout="horizontal" class="">
			<div class="clr-row">
				<div class="clr-col-12">
                    <div class="pull-right">
						<tds-button-sync [displayLabel]="false"
										 (click)="reloadData()"
										 class="flat pull-right">
						</tds-button-sync>
						<tds-button-add
								iconClass="is-solid"
								[title]="createActionText"
								class="button-create-action pull-right"
								[displayLabel]="false"
								[id]="'btnCreate'"
								(click)="onCreate()"
								*ngIf="isCreateAvailable()">
						</tds-button-add>
					</div>
				</div>
			</div>
		</form>
        <div>
			<div class="box-body box-with-empty-header" [ngClass]="{'is-filtering': isFiltering}">
				<kendo-grid
						[data]="gridData"
						[filter]="state.filter"
						[filterable]="true"
						(filterChange)="filterChange($event)"
						[sort]="state.sort"
						[skip]="skip"
						[sortable]="{mode:'single', allowUnsort: false}"
						[pageSize]="pageSize"
						[resizable]="true"
						(sortChange)="sortChange($event)"
						[pageable]="{pageSizes: GRID_DEFAULT_PAGINATION_OPTIONS, info: true}"
						(pageChange)="pageChange($event)"
						class="page-height row-actions-2-children"
						[selectable]="true">

					<!-- Action -->
					<kendo-grid-command-column  [width]="65" [minResizableWidth]="65" [class]="{'k-custom-command-column': true}">
						<ng-template kendoGridHeaderTemplate>
							<tds-button [flat]="true" (click)="toggleFiltering()">
								<clr-icon shape="filter" class="grid-filter-button is-solid">
									<span *ngIf="filterCounter(); let counter" class="badge badge-warning">{{counter}}</span>
								</clr-icon>
							</tds-button>
						</ng-template>

						<ng-template kendoGridCellTemplate let-dataItem let-rowIndex="rowIndex">
							<div class="action-button btn-link">
								<clr-dropdown>
									<tds-button icon="ellipsis-vertical" clrDropdownTrigger></tds-button>
									<clr-dropdown-menu *clrIfOpen clrPosition="bottom-left">
										<a clrDropdownItem [disabled]="!isEditAvailable()" (click)="onEdit(dataItem)">{{'API_ACTION.EDIT_ACTION' | translate}}</a>
										<a clrDropdownItem [disabled]="!isDeleteAvailable()" (click)="onDelete(dataItem)">{{'API_ACTION.DELETE_ACTION' | translate}}</a>
									</clr-dropdown-menu>
								</clr-dropdown>
							</div>
						</ng-template>

					</kendo-grid-command-column>

					<!-- Configured View Columns (*ngFor) -->
					<kendo-grid-column
							*ngFor="let column of gridColumns"
							field="{{column.property}}"
							format="{{column.format}}"
							[width]="commonShrunkColumns.includes(column.label) ? commonShrunkColumnWidth : !column.width ? COLUMN_MIN_WIDTH : column.width">
						<ng-template kendoGridHeaderTemplate>
							<div class="sortable-column">
								<label>{{column.label}}</label>
							</div>
						</ng-template>

						<ng-template kendoGridCellTemplate let-dataItem *ngIf="column.label === 'Type'">
							{{dataItem['actionType'].id ? dataItem['actionType'].id : dataItem['actionType']}}
						</ng-template>

						<ng-template kendoGridCellTemplate *ngIf="column.type === 'boolean'" let-dataItem>
							<input clrCheckbox type="checkbox" [(ngModel)]="dataItem[column.property]" style="margin-left: 35%;" disabled/>
						</ng-template>

						<ng-template kendoGridCellTemplate *ngIf="column.isActionable" let-dataItem>
								<span class="is-grid-link" (click)="cellClick(dataItem)">
									{{dataItem[column.property]}}
								</span>
						</ng-template>

						<!--	Filters-->
						<ng-template kendoGridFilterCellTemplate let-filter>
							<div class="filter-input" *ngIf="isFiltering && column.property && column.type !== 'action'">
								<div *ngIf="column.type === 'text' || column.type === 'date' || column.type === 'boolean'; then inputFilterTemplate"></div>
								<ng-template #inputFilterTemplate>
									<tds-filter-input
											name="{{column.property}}"
											[value]="column.filter || ''"
											[columnType]="column.type"
											placeholder="{{'GLOBAL.FILTER' | translate}}"
											(filter)="onFilter($event, column)">
									</tds-filter-input>
								</ng-template>
							</div>

						</ng-template>
					</kendo-grid-column>

					<ng-template kendoPagerTemplate let-total="total" let-totalPages="totalPages" let-currentPage="currentPage">
						<div class="clr-col-4"></div>
						<div class="clr-col-8">
							<tds-grid-pager
									[total]="total"
									[totalPages]="totalPages"
									[currentPage]="currentPage"
									[pageSize]="pageSize"
									[pageSizes]="GRID_DEFAULT_PAGINATION_OPTIONS"
									(pageChange)="pageChange($event)">
							</tds-grid-pager>
						</div>
					</ng-template>

				</kendo-grid>
			</div>
		</div>
	</section>
</div>
