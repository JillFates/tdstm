<div tds-autofocus tds-handle-escape>
	<div
	class="tds-modal-content has-side-nav data-script-view-edit-component"
	#dataScriptContainer
>
	<div class="modal-header">
		<button
			(click)="cancelCloseDialog()"
			type="button"
			class="close"
			aria-label="Close"
		>
			<clr-icon aria-hidden="true" shape="close"></clr-icon>
		</button>
		<div class="modal-title-container">
			<div class="modal-title">
				{{ modalTitle }}
			</div>
		</div>
	</div>
	<div class="modal-body">
		<form
			name="dataScriptForm"
			role="form"
			data-toggle="validator"
			#dataScriptForm="ngForm"
			class="form-horizontal left-alignment"
		>
			<div class="box-body">
				<div class="row">
					<div class="col-md-12">
						<div class="form-group">
							<label
								for="dataScriptProvider"
								class="col-sm-3 control-label"
								>Provider:
								<span
									class="is-required"
									*ngIf="modalType !== actionTypes.VIEW"
									>*</span
								>
							</label>
							<div
								class="col-sm-8" *ngIf="modalType !== actionTypes.VIEW">
								<kendo-dropdownlist *ngIf="providerList && providerList.length > 0"
													#dataScriptProvider
													id="dataScriptProvider"
													name="dataScriptProvider"
													class="form-control"
													[data]="providerList"
													[textField]="'name'"
													[valueField]="'id'"
													[defaultItem]="dataScriptModel.provider"
													[(ngModel)]="dataScriptModel.provider"
													required
													[ngClass]="{'has-error': dataScriptForm.touched && dataScriptModel.provider &&
											!dataScriptModel.provider.id
									}"
								>
								</kendo-dropdownlist>
							</div>
							<div
								class="col-sm-8"
								*ngIf="modalType === actionTypes.VIEW"
							>
								<label class="control-label label-detail">{{
									dataScriptModel.provider.name
								}}</label>
							</div>
						</div>
						<div class="form-group">
							<label
								for="dataScriptName"
								class="col-sm-3 control-label"
								>Name:
								<span
									class="is-required"
									*ngIf="modalType !== actionTypes.VIEW"
									>*</span
								>
							</label>
							<div
								class="col-sm-8"
								*ngIf="modalType !== actionTypes.VIEW"
							>
								<input
									clrInput
									type="text"
									(keyup)="onValidateUniqueness()"
									id="dataScriptName"
									name="dataScriptName"
									class="form-control"
									[(ngModel)]="dataScriptModel.name"
									required
									[ngClass]="{
										'has-error':
											!dataScriptForm.form.valid &&
											dataScriptForm.touched &&
											dataScriptModel.name.length <= 0
									}"
								/>
								<span
									*ngIf="!isUnique"
									style="color: red; font-weight: bold;"
									>{{
										'DATA_INGESTION.DATA_SCRIPT' | translate
									}}
									name must be unique</span
								>
							</div>
							<div
								class="col-sm-8"
								*ngIf="modalType === actionTypes.VIEW"
							>
								<label class="control-label label-detail">{{
									dataScriptModel.name
								}}</label>
							</div>
						</div>

					</div>
				</div>
				<div>
					<div class="form-group">
						<label
							for="dataScriptDescription"
							class="col-sm-3 control-label"
							>Description:</label
						>
						<div
							class="col-sm-8"
							*ngIf="modalType === actionTypes.VIEW"
						>
							<label class="control-label label-detail">{{
								dataScriptModel.description
							}}</label>
						</div>
						<div
							class="col-sm-8"
							*ngIf="modalType !== actionTypes.VIEW"
						>
							<textarea
								clrTextarea
								id="dataScriptDescription"
								name="dataScriptDescription"
								class="form-control"
								[(ngModel)]="dataScriptModel.description"
							></textarea>
						</div>
					</div>
				</div>
				<div>
					<div class="form-group">
						<div class="col-sm-offset-3 col-sm-8">
							<span class="checkbox">
								<clr-checkbox-wrapper>
									<input
										clrCheckbox
										type="checkbox"
										name="isAutoProcess"
										id="isAutoProcess"
										[disabled]="modalType === actionTypes.VIEW"
										[(ngModel)]="dataScriptModel.isAutoProcess"/>
									<label>Used to automatically transform, import and post data into TM</label>
								</clr-checkbox-wrapper>
							</span>
							<span class="checkbox">
								<clr-checkbox-wrapper>
									<input
										clrCheckbox
										type="checkbox"
										name="useWithAssetActions"
										id="useWithAssetActions"
										[disabled]="modalType === actionTypes.VIEW"
										[(ngModel)]="dataScriptModel.useWithAssetActions"/>
									<label>Use with asset actions</label>
								</clr-checkbox-wrapper>
							</span>
						</div>
					</div>
				</div>
			</div>
		</form>
	</div>
	<div class="modal-sidenav btn-link">
		<tds-button-edit
			*ngIf="modalType === actionTypes.EDIT"
			(click)="changeToEditDataScript()"
			[disabled]="!isUpdateAvailable()"
			class="selected-button"
		>
		</tds-button-edit>
		<tds-button-save
			*ngIf="
				modalType === actionTypes.EDIT ||
				modalType === actionTypes.CREATE
			"
			(click)="onSaveDataScript()"
			[disabled]="
				!dataScriptForm.form.valid ||
				!isUnique ||
				(dataScriptModel.provider && !dataScriptModel.provider.id) ||
				!isDirty()
			"
			[tooltip]="'Save'"
		>
		</tds-button-save>
		<tds-button-edit
			*ngIf="modalType === actionTypes.VIEW"
			(click)="changeToEditDataScript()"
			[disabled]="!isUpdateAvailable()"
			title="Edit Info"
		>
		</tds-button-edit>
		<tds-button-custom
			*ngIf="modalType === actionTypes.VIEW"
			[icon]="'file-code-o'"
			(click)="onDataScriptDesigner()"
			[tooltip]="
				'DATA_INGESTION.DATASCRIPT.DESIGNER.ETL_SCRIPT_EDIT_BUTTON'
					| translate
			"
		>
		</tds-button-custom>

		<tds-button-delete
			*ngIf="modalType !== actionTypes.CREATE"
			(click)="onDeleteDataScript()"
			[disabled]="!isDeleteAvailable()"
		>
		</tds-button-delete>

		<tds-button-close
			*ngIf="
				modalType === actionTypes.VIEW ||
				modalType === actionTypes.CREATE
			"
			(click)="cancelCloseDialog()"
		>
		</tds-button-close>

		<tds-button-cancel
			*ngIf="modalType === actionTypes.EDIT"
			(click)="cancelEditDialog()"
		>
		</tds-button-cancel>
	</div>
</div>
</div>
