<!-- Main content -->
<div class="content body tds-kendo-grid asset-comment-list-component">
	<section>
		<div *ngIf="assetCommentColumnModel">
			<kendo-grid
				[data]="gridData"
				[filter]="state.filter"
				[filterable]="true"
				(filterChange)="filterChange($event)"
				[sort]="state.sort"
				[skip]="skip"
				[sortable]="{ mode: 'single' }"
				[pageSize]="pageSize"
				[resizable]="true"
				(sortChange)="sortChange($event)"
				[pageable]="{
					pageSizes: defaultPageOptions,
					pageSize: pageSize,
					info: true
				}"
				(pageChange)="pageChange($event)"
				(cellClick)="cellClick($event)"
				[selectable]="true"
				[ngClass]="{ 'hide-filter': !showFilters }"
				class="page-height row-actions-1-children"
			>
				<ng-template kendoGridToolbarTemplate [position]="'top'">
					<tds-grid-header-action-buttons
							(refresh)="reloadData()"
							[actionButtons]="headerActionButtons"
							(clearFilters)="onClearFilters()"
							[disableClearFilters]="disableClearFilters">
					</tds-grid-header-action-buttons>
				</ng-template>

				<!-- Show Filters / Actions column -->
				<kendo-grid-column
					[width]="60"
					[class]="{ 'k-custom-command-column': true }"
					[minResizableWidth]="60"
				>
					<ng-template
						kendoGridHeaderTemplate
						let-column
						let-columnIndex="columnIndex"
					>
						<tds-button [flat]="true" (click)="toggleFilter()">
							<clr-icon
								shape="filter"
								class="grid-filter-button is-solid"
							>
								<span
									*ngIf="hasFilterApplied()"
									class="badge badge-warning"
								>
									{{ filterCount() }}
								</span>
							</clr-icon>
						</tds-button>
					</ng-template>

					<ng-template
						kendoGridCellTemplate
						let-dataItem
						let-rowIndex="rowIndex"
					>
						<div class="action-button btn-group btn-link">
							<clr-dropdown>
								<tds-button
									icon="ellipsis-vertical"
									clrDropdownTrigger
								></tds-button>

								<clr-dropdown-menu
									*clrIfOpen
									clrPosition="bottom-left"
								>
									<a
										clrDropdownItem
										(click)="onEdit(dataItem)"
										[disabled]="!isCommentEditAvailable()"
									>
										Edit
									</a>
									<!-- <a
											clrDropdownItem
											(click)="onDelete(dataItem)"
											[disabled]="!isDeleteAvailable()"
										>
											Delete
										</a> -->
								</clr-dropdown-menu>
							</clr-dropdown>
						</div>
					</ng-template>
				</kendo-grid-column>

				<kendo-grid-column
					*ngFor="let column of gridColumns"
					field="{{ column.property }}"
					format="{{ column.format }}"
					minResizableWidth="{{
						column.type === 'action' ? column.width : 5
					}}"
					class="{{ column.class }}"
					[width]="
						commonShrunkColumns.includes(column.label)
							? commonShrunkColumnWidth
							: !column.width
							? COLUMN_MIN_WIDTH
							: column.width
					"
				>
					<ng-template kendoGridHeaderTemplate>
						<div
							class="sortable-column"
							(click)="onClickTemplate($event)"
						>
							<label> {{ column.label }}</label>
						</div>
                    </ng-template>

					<ng-template kendoGridFilterCellTemplate let-filter>
						<div
							class="has-feedback"
							*ngIf="column.property && column.type !== 'action'"
							style="margin-bottom:0px;"
                        >
							<div *ngIf="column.type === 'date'">
								<kendo-datepicker
									[format]="dateFormat"
									[(ngModel)]="column.filter"
									(valueChange)="onFilter(column)"
									[style.width.%]="100"
								></kendo-datepicker>
								<span
									*ngIf="column.filter"
									(click)="clearValue(column)"
									style="right:15%;cursor:pointer;color:#656565;pointer-events:all"
									class="fa fa-times form-control-feedback"
									aria-hidden="true"
								></span>
							</div>
							<div
								*ngIf="column.type === 'text'"
								class="filter-input"
							>
								<input
									clrInput
									type="text"
									(keyup)="onFilter(column)"
									name="{{ column.property }}"
									[(ngModel)]="column.filter"
									placeholder="Filter {{ column.label }}"
									value=""
								/>
								<tds-button
									*ngIf="column.filter"
									(click)="clearValue(column)"
									[title]="'Clear Filter'"
									icon="times-circle"
									[small]="true"
									[flat]="true"
								>
								</tds-button>
							</div>
						</div>
					</ng-template>
				</kendo-grid-column>

				<!-- PAGER COMPONENT -->
				<ng-template
					kendoPagerTemplate
					let-total="total"
					let-totalPages="totalPages"
					let-currentPage="currentPage"
				>
					<div class="clr-col-12">
						<tds-grid-pager
							[total]="total"
							[totalPages]="totalPages"
							[currentPage]="currentPage"
							[pageSizes]="defaultPageOptions"
							(pageChange)="pageChange($event)"
						>
						</tds-grid-pager>
					</div>
				</ng-template>
			</kendo-grid>
		</div>
	</section>
</div>
