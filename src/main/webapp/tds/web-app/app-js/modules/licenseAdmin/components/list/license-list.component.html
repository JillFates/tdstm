<!-- Main content -->
<div class="content body tds-kendo-grid license-admin-list-component">
	<section>
		<div *ngIf="licenseColumnModel">
			<div class="box-body box-with-empty-header">
				<kendo-grid
					[data]="gridData"
					[filter]="state.filter"
					[filterable]="true"
					(filterChange)="filterChange($event)"
					[sort]="state.sort"
					[skip]="skip"
					[sortable]="{ mode: 'single' }"
					[pageSize]="pageSize"
					[resizable]="true"
					(sortChange)="sortChange($event)"
					[pageable]="{
						pageSizes: defaultPageOptions,
						pageSize: pageSize,
						info: true
					}"
					(pageChange)="pageChange($event)"
					(cellClick)="cellClick($event)"
					[selectable]="true"
					[ngClass]="{ 'hide-filter': !showFilters }"
					class="page-height row-actions-2-children"
				>
					<ng-template kendoGridToolbarTemplate [position]="'top'">
						<div class="clr-row">
							<div class="clr-col-12 pull-right">
								<tds-grid-header-action-buttons
									(refresh)="reloadData()"
									[actionButtons]="headerActionButtons">
								</tds-grid-header-action-buttons>
							</div>
						</div>
					</ng-template>

					<!-- Show Filters / Actions column -->
					<kendo-grid-column
						[field]="'_showFilters'"
						[headerClass]="'text-center'"
						[sortable]="false"
						[class]="{ 'k-custom-command-column': true }"
						[width]="60"
						[minResizableWidth]="60">
						<!-- Toggle Filters button -->
						<ng-template kendoGridHeaderTemplate>
							<tds-grid-show-hide-filters-button [filterCount]="filterCount()"
																								 (toggleFilters)="toggleFilter()">
							</tds-grid-show-hide-filters-button>
						</ng-template>
						<!-- Clear all Filters button -->
						<ng-template kendoGridFilterCellTemplate let-filter>
							<tds-grid-clear-all-filters-button [show]="filterCount()"
																								 (clearFilters)="clearAllFilters()">
							</tds-grid-clear-all-filters-button>
						</ng-template>

						<ng-template
							kendoGridCellTemplate
							let-dataItem
							let-rowIndex="rowIndex"
						>
							<div class="action-button btn-link">
								<clr-dropdown>
									<tds-button
										icon="ellipsis-vertical"
										clrDropdownTrigger
									></tds-button>
									<clr-dropdown-menu
										*clrIfOpen
										clrPosition="bottom-left"
									>
										<a
											clrDropdownItem
											(click)="
												openLicenseViewEdit(dataItem)
											"
										>
											Edit
										</a>
										<a
											clrDropdownItem
											(click)="onDelete(dataItem)"
										>
											Delete
										</a>
									</clr-dropdown-menu>
								</clr-dropdown>
							</div>
						</ng-template>
					</kendo-grid-column>

					<kendo-grid-column
						*ngFor="let column of gridColumns"
						field="{{ column.property }}"
						format="{{ column.format }}"
						[locked]="column.locked"
						[width]="
							!column.width ? COLUMN_MIN_WIDTH : column.width
						">
						<ng-template kendoGridHeaderTemplate>
							<div class="sortable-column"
									 (click)="onClickTemplate($event)">
								<label>
									{{ column.label }}
								</label>
							</div>
						</ng-template>

						<!-- Filter Inputs -->
						<ng-template kendoGridFilterCellTemplate let-filter>
							<div class="filter-input">
								<tds-grid-filter-input
									[name]="column.property"
									[value]="column.filter || ''"
									[filterType]="column.filterType"
									[dropdownData]="column.dropdownData || []"
									[dateFormat]="dateFormat"
									[placeholder]="'GLOBAL.FILTER' | translate"
									(filter)="onFilter(column, $event)">
								</tds-grid-filter-input>
							</div>
						</ng-template>

						<ng-template
							kendoGridCellTemplate
							*ngIf="column.property === 'type'"
							let-dataItem
						>
							<span
								*ngIf="
									dataItem.type === licenseType.MULTI_PROJECT
								"
							>{{ 'LICENSE.GLOBAL' | translate }}</span
							>
							<span
								*ngIf="
									dataItem.type === licenseType.SINGLE_PROJECT
								"
							>{{ 'LICENSE.SINGLE' | translate }}</span
							>
						</ng-template>

						<ng-template
							kendoGridCellTemplate
							*ngIf="column.property === 'status'"
							let-dataItem
						>
							<span
								*ngIf="
									dataItem.status === licenseStatus.PENDING
								"
							>{{ 'GLOBAL.PENDING' | translate }}</span
							>
							<span
								*ngIf="dataItem.status === licenseStatus.ACTIVE"
							>{{ 'GLOBAL.ACTIVE' | translate }}</span
							>
						</ng-template>

						<ng-template
							kendoGridCellTemplate
							*ngIf="column.property === 'environment'"
							let-dataItem
						>
							<span
								*ngIf="
									dataItem.environment ===
									licenseEnvironment.ENGINEERING
								"
							>{{ 'LICENSE.ENGINEERING' | translate }}</span
							>
							<span
								*ngIf="
									dataItem.environment ===
									licenseEnvironment.TRAINING
								"
							>{{ 'LICENSE.TRAINING' | translate }}</span
							>
							<span
								*ngIf="
									dataItem.environment ===
									licenseEnvironment.DEMO
								"
							>{{ 'LICENSE.DEMO' | translate }}</span
							>
							<span
								*ngIf="
									dataItem.environment ===
									licenseEnvironment.PRODUCTION
								"
							>{{ 'LICENSE.PRODUCTION' | translate }}</span
							>
							<span *ngIf="dataItem.status === licenseStatus.CORRUPT">{{ 'GLOBAL.CORRUPT' | translate }}</span>
						</ng-template>
					</kendo-grid-column>
					<!-- PAGER COMPONENT -->
					<ng-template
						kendoPagerTemplate
						let-total="total"
						let-totalPages="totalPages"
						let-currentPage="currentPage"
					>
						<div class="clr-col-12">
							<tds-grid-pager
								[total]="total"
								[totalPages]="totalPages"
								[currentPage]="currentPage"
								[pageSizes]="defaultPageOptions"
								(pageChange)="pageChange($event)"
							>
							</tds-grid-pager>
						</div>
					</ng-template>
				</kendo-grid>
			</div>
		</div>
	</section>
</div>
